var Ge=Object.defineProperty;var Ze=(s,e,t)=>e in s?Ge(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var l=(s,e,t)=>(Ze(s,typeof e!="symbol"?e+"":e,t),t);const Ye=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const v of c.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&i(v)}).observe(document,{childList:!0,subtree:!0});function t(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerpolicy&&(c.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?c.credentials="include":n.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(n){if(n.ep)return;n.ep=!0;const c=t(n);fetch(n.href,c)}};Ye();Element.prototype.createDiv=function(s){const e=document.createElement("div");return e.id=s,this.appendChild(e),e};Element.prototype.createDivFirst=function(s){const e=document.createElement("div");return s!=null&&(e.id=s),this.insertAdjacentElement("afterbegin",e),e};class J{constructor(e,t){l(this,"_id");l(this,"_tags",[]);l(this,"_valRef");l(this,"_valIO",!1);l(this,"_val");l(this,"_valLast");l(this,"_tron",!1);l(this,"_view",!1);l(this,"_height",0);l(this,"div");l(this,"data");l(this,"onChange");l(this,"onRender");switch(t=e.nodeType!=null?"div":t,t){case"object":case"obj":this.id=e;break;case"div":this.div=e,this.div.tna=this,this.id=e.id;break;case"id":default:this.div=document.getElementById(e),this.div!=null?this.div.tna=this:console.error(`tna construct no element for ${e}`),this.id=this.div==null?e:this.div.id;break}this.bRenderEnd=this.renderEnd.bind(this)}fuse(){return this.div==null?console.warn(`${this.id} fuse no div`):(this.div.classList.add("_tna"),this)}shy(e=!0){return this.div.classList.toggle("shy",e),this}prime(e=!0){if(this.div!=null)return this.div.classList.toggle("prime",e),this}touchPrime(){return this.div.ontouchstart=()=>{},this}show(){return this.render(!0),this}hide(){return this.render(!1),this}view(e=!0,t=!1){return this.render(e,t),this}viewStaged(e){return this.view(e,!0)}render(e=this._view,t=!1){this._view=e,this.div.classList.toggle("show",e),t?this.div.addEventListener("transitionend",this.bRenderEnd):this.callRender()}draw(){}renderEnd(){this.div.removeEventListener("transitionend",this.bRenderEnd),this.div.style.transition="",this.callRender()}callRender(){this.onRender!=null?this.onRender(this):this._view&&(this.onShow!=null?this.onShow(this):this.onHide!=null&&this.onHide(this))}display(e=!0){return console.log(`${this.id} display b:%o`,e),this.div.style.display=e?"":"none",this}getDiv(e,t){const i=this.div.querySelector(`#${e}`);if(i==null){console.warn(`${this.id} getDiv FAIL for "${e}"`);return}const n=t==null?this.div.id:t;return i.id=`${e}_${n}`,i}setProp(e,t){this.div.style.setProperty(e,t)}getProp(e){return getComputedStyle(this.div).getPropertyValue(e)}getPropVal(e){return parseFloat(this.getProp(e))}getDataAttr(e,t,i){const n=this.div.dataset[e],c=`--${e.camelKabob()}`,v=this.getProp(c);let g,_="";switch(t){case"pixel":_="px";case"integer":g=parseInt(n);break;case"percent":_="%";case"number":case"float":g=parseFloat(n);break;case"s":g=parseFloat(n)*1e3;break;case"string":return n==null?v.length>0?v:i:(g=n,g);default:g=parseFloat(n),n.indexOf("%")>0&&(_="%"),n.indexOf("px")>0&&(_="px");break}return isNaN(g)&&(g=parseInt(v),v.indexOf("%")>0&&(_="%"),v.indexOf("px")>0&&(_="px")),isNaN(g)&&g!=null&&(g=i),this.div.style.setProperty(c,g+_),g}parent(e,t){for(;!(e.id.indexOf(t)!=-1||e.parentElement==null);)e=e.parentElement;return e}async delay(e=1){return new Promise(t=>{setTimeout(()=>{t()},e)})}set(e){return this.data=e,e!=this._valLast&&(this.draw(),this.onChange!=null&&this.onChange(this,e),this._valLast=e),this}enable(e=!0){return this._enable=e,this}tag(...e){for(const t of e)this._tags.push(t);return this}hasTag(...e){let t=!1;for(const i of e)t=t||this._tags.find(n=>n==i);return t}latchClass(e){return this.div.querySelectorAll("._"+e).forEach(i=>i.classList.add(e)),this}set id(e){this._id=e}get id(){return this._id}valRef(e){return this._valRef=e,this}valIO(){return this._valIO=!0,this}set value(e){if(this._valIO&&this._valRef!=null&&this._valRef[0].val!=null){let t=this._valRef.findIndex(i=>i.val==e);t==-1&&(t=0,console.warn(`${this.id} set value(${e}) FAIL not in valRef, using _val:0`)),e=t}this._val=e}get value(){let e=this._val;return this._valIO&&this._valRef!=null&&this._valRef[0].val!=null&&(e=this._valRef[e].val),e}set height(e){this._height=e}get height(){return this._height}tron(e=!0){return this._tron=e,this}clamp(e,t,i){return Math.min(Math.max(e,t),i)}easeLinear(e,t,i,n){return i*e/n+t}easeInQuad(e,t,i,n){return i*(e/=n)*e+t}easeOutQuad(e,t,i,n){return-i*(e/=n)*(e-2)+t}easeInOutQuad(e,t,i,n){return(e/=n/2)<1?i/2*e*e+t:-i/2*(--e*(e-2)-1)+t}easeInSine(e,t,i,n){return-i*Math.cos(e/n*(Math.PI/2))+i+t}easeOutSine(e,t,i,n){return i*Math.sin(e/n*(Math.PI/2))+t}easeInOutSine(e,t,i,n){return-i/2*(Math.cos(Math.PI*e/n)-1)+t}easeInCubic(e,t,i,n){return i*(e/=n)*e*e+t}easeOutCubic(e,t,i,n){return i*((e=e/n-1)*e*e+1)+t}easeInOutCubic(e,t,i,n){return(e/=n/2)<1?i/2*e*e*e+t:i/2*((e-=2)*e*e+2)+t}easeOutElastic(e,t,i,n){let c,v=0,g=i;return e==0?t:(e/=n)==1?t+i:(v||(v=n*.3),g<Math.abs(i)?c=v/4:c=v/(2*Math.PI)*Math.asin(i/g),g*Math.pow(2,-10*e)*Math.sin((e*n-c)*(2*Math.PI)/v)+i+t)}}class fe extends J{constructor(t){super(t);l(this,"_enable",!1);l(this,"_dynamic",!1);l(this,"_val",!1);l(this,"onChange");this.div.classList.add("tna_Accord"),this.div.dataset.dynamic!=null&&this.dynamic(),this.div.dataset.open!=null&&this.open(),this.div.dataset.prime!=null&&this.prime(),this._spill=this.div.dataset.spill!=null,this.bSpill=this.spill.bind(this)}prime(){return this.div.classList.add("prime"),this}resize(){const t=this.div.classList.contains("prime");this.div.classList.remove("prime"),this.div.classList.add("open"),this.div.style.setProperty("--accord-h","");const i=this.div.offsetHeight;this.div.style.setProperty("--accord-h",i+"px"),this.div.classList.toggle("open",this._val),this.div.classList.toggle("prime",t)}toggle(t){return this._val=t==null?!this._val:t,this._val?this.open():this.close(),this}open(){return this._val=!0,this.div.classList.add("open"),this._spill&&this.div.addEventListener("transitionend",this.bSpill),this.onChange!=null&&this.onChange(this),this}close(){return this._val=!1,this.div.classList.remove("open","spill"),this.onChange!=null&&this.onChange(this),this}spill(){return console.log(`${this.id} spill`),this.div.classList.add("spill"),this.div.removeEventListener("transitionend",this.bSpill),this}dynamic(t=!0){return t&&!this._dynamic?window.addEventListener("resize",this.resize.bind(this)):window.removeEventListener("resize",this.resize.bind(this)),this.resize(),this._dynamic=t,this}}const qe=`<div id="region" class="region">
    <div id="bg" class="bg"></div>
    <div id="label" class="label"></div>
  </div>`;class Je extends J{constructor(t){super(t);l(this,"_label");this._label=this.div.innerHTML,this.div.innerText="",this.div.insertAdjacentHTML("beforeend",qe),this.div.classList.add("tna_RetroT"),this.dRegion=this.getDiv("region"),this.dLabel=this.getDiv("label"),this.dBg=this.getDiv("bg"),this.dLabel.innerText=this._label}}const Bt={};function Ke(){ti(),ei(),ue()}async function Qe(){for(const[s,e]of Object.entries(Bt))e.prime()}function ti(){document.querySelectorAll("._tna_Accord").forEach((e,t)=>{e.id.length==0&&(e.id=`accord_${t}`);const i=e.id.length!=0?e.id:t;Bt[i]=new fe(e.id)})}function ei(){document.querySelectorAll("._hr").forEach((e,t)=>{e.id.length==0&&(e.id=`hr_${t}`);const i=e.id.length!=0?e.id:t;Bt[i]=new J(e.id).fuse(),e.classList.add("hr_wrap");const n=document.createElement("hr");e.insertAdjacentElement("afterbegin",n)})}function ue(){let s;s=document.querySelectorAll(".tna_RetroT"),s.forEach((e,t)=>{e.id.length==0&&(e.id=`retro_text_${t}`),new Je(e.id)})}var ii={init:Ke,prime:Qe,items:Bt,retro:ue};const pe=["ping","call","ux","info","push","save","sync"],ge=["call_prime","call_console","call_tune","call_warn","call_restart","call_admin","call_photo","call_gps_log"],si=["none","default","notify","toggle_on","toggle_off","alarm","close_encounter","charge_fanfare","bonanza","guantanamera","rhythm_dancer"],ni=["OK",'"index.html" served from FS'],ve=["null","sys_splash","sys_boot","sys_ap","sys_ota","sys_restart","sys_fail","reset_user","reset_admin","net_setup","net_menu","net_fail","set_bright","set_sound","tap_menu","tap_test","tap_notify","clock_static","clock_hide","clock_switch","clock_service","clock_tz","clock_dst","clock_24h","clock_pps","alarm_menu","alarm_set","alarm_notify","alarm_snooze","diag_info","diag_serial","diag_console","diag_net","diag_net_mac","diag_gps","diag_led","photo"],me=["idle","init","begin","splash","prime","ready","run","update","wait","confirm","notify","commit","end","exit","cancel","expire","fail"],_e=["info_rc","info_user","info_mfg","info_reg","info_hardware","info_firmware","info_install","info_uptime","info_net","info_rssi","info_display","info_status","info_tap","info_ntp","info_gps","info_gps_log"],ye=["admin_sign","admin_fpo","ota_version","ota_version_fs","ota_time","ota_time_fs","ota_fpo","mfg_product","mfg_version","mfg_date","mfg_serial","mfg_logic","mfg_display","mfg_color","mfg_note","mfg_fpo","reg_date","reg_name_1","reg_name_2","reg_user","reg_gift","reg_gp_1","reg_gp_2","reg_fpo","sys_output","sys_console","sys_fpo","def_name","def_device","def_ssid","def_pass","def_alert","def_net_fpo","def_bright","def_sound","def_av_fpo","def_tap_act","def_tap","def_tilt","def_tap_fpo","def_ntp_serve","def_ntp_int","def_ntp_fpo","def_nts_fpo","def_gps_alert","def_gps_log_i","def_gps_log_x","def_gps_fpo","def_tz","def_dst","def_24h","def_pps","def_clock_fpo","def_alarm_ind"],ai=100,we=["ux_boot","ux_index","ux_fpo","user_consent","user_fpo","net_name","net_device","net_ssid","net_pass","net_alert","net_fpo","ui_bright","ui_sound","ui_fpo","tap","tap_mode","tap_tilt","tap_alert","tap_fpo","ntp_server","ntp_interval","ntp_fpo","nts_fpo","gps_alert","gps_log_int","gps_log_ratio","gps_fpo","clock_static","clock_disp","clock_service","clock_tz","clock_dst","clock_24h","clock_pps","clock_fpo","alarm_tap","alarm_fpo","daily","daily_ind","daily_tone","daily_vol","daily_d","daily_h","daily_m","daily_snooze"],oi={display:0,piezo:1,xpio:2,gps:3},ri={display:1,piezo:2,xpio:4,gps:8},di=["CLOCK_HHMM","CLOCK_DATE","CLOCK_MMSS"],li=["NTP","GPS","pps","none"],hi={action:pe,call:ge,ux:ve,info:_e,admin:ye,pref:we,stage:me};var A={master:hi,hwOffset:oi,hwMask:ri,actionID:pe,callID:ge,tuneID:si,warnID:ni,uxID:ve,stageID:me,infoID:_e,prefBase:ai,prefID:we,adminID:ye,clockID:di,serviceID:li};const ht={},ct={};let q=!1;var u={...A,getPrefID:pi,controls:ht,linkControl:ci,getControlByID:fi,getControlByIndex:ui,dialogs:ct,linkDialog:vi,printDialogs:_i,getDialogByIndex:mi,tron:gi};function ci(s){const e=A.master[s.linkType];if(e==null){q&&console.log(`linkControl FAIL id:${s.id}, bad type:${s.linkType}`);return}const t=e.indexOf(s.id),i=s.linkType=="pref"?A.prefBase:0;return t<0?(q&&console.log(`linkControl FAIL not found id:${s.id}`),!1):(s.linkID=t+i,ht[s.id]={obj:s},!0)}function fi(s){if(ht.hasOwnProperty(s))return ht[s].obj;q&&console.log(`map.getControlByID FAIL no table entry for ${s}`)}function ui(s,e){let t=0;switch(s){case"action":t=A.actionID[e];break;case"call":t=A.callID[e];break;case"ux":t=A.uxID[e];break;case"info":t=A.infoID[e];break;case"pref":t=A.prefID[e-A.prefBase];break;case"admin":t=A.adminID[e];break}if(t==0){q&&console.log(`map.getControlByIndex FAIL not registered ${typeID}: ${e}`);return}if(ht.hasOwnProperty(t))return ht[t].obj;q&&console.log(`map.getControlByIndex FAIL no object ${typeID}:${e}`)}function pi(s){let e=A.prefID.indexOf(s);if(e!=-1)return e+A.prefBase;console.warn(`getPrefID FAIL ${s} not found`)}function gi(s=!0){q=s}function vi(s){const e=A.uxID.indexOf(s.id);switch(e){case-1:return q&&console.log(`map.linkDialog FAIL id:${s.id}`),!1;default:s.linkID=e,ct[s.id]={obj:s};break}return!0}function mi(s){const e=A.uxID[s];if(e==null){q&&console.log(`map.getDialogByIndex FAIL ux not registered for ${s}`);return}if(ct.hasOwnProperty(e))return ct[e].obj;q&&console.log(`map.getDialogByIndex FAIL no object for :${e}`)}function _i(){console.warn("printDialogs");for(const s in ct)console.log(`  ${ct[s].obj.id}`)}var yi={};(function(s){(function(){var e={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function t(g){return n(v(g),arguments)}function i(g,_){return t.apply(null,[g].concat(_||[]))}function n(g,_){var b=1,E=g.length,p,k="",L,T,m,w,f,h,o,a;for(L=0;L<E;L++)if(typeof g[L]=="string")k+=g[L];else if(typeof g[L]=="object"){if(m=g[L],m.keys)for(p=_[b],T=0;T<m.keys.length;T++){if(p==null)throw new Error(t('[sprintf] Cannot access property "%s" of undefined value "%s"',m.keys[T],m.keys[T-1]));p=p[m.keys[T]]}else m.param_no?p=_[m.param_no]:p=_[b++];if(e.not_type.test(m.type)&&e.not_primitive.test(m.type)&&p instanceof Function&&(p=p()),e.numeric_arg.test(m.type)&&typeof p!="number"&&isNaN(p))throw new TypeError(t("[sprintf] expecting number but found %T",p));switch(e.number.test(m.type)&&(o=p>=0),m.type){case"b":p=parseInt(p,10).toString(2);break;case"c":p=String.fromCharCode(parseInt(p,10));break;case"d":case"i":p=parseInt(p,10);break;case"j":p=JSON.stringify(p,null,m.width?parseInt(m.width):0);break;case"e":p=m.precision?parseFloat(p).toExponential(m.precision):parseFloat(p).toExponential();break;case"f":p=m.precision?parseFloat(p).toFixed(m.precision):parseFloat(p);break;case"g":p=m.precision?String(Number(p.toPrecision(m.precision))):parseFloat(p);break;case"o":p=(parseInt(p,10)>>>0).toString(8);break;case"s":p=String(p),p=m.precision?p.substring(0,m.precision):p;break;case"t":p=String(!!p),p=m.precision?p.substring(0,m.precision):p;break;case"T":p=Object.prototype.toString.call(p).slice(8,-1).toLowerCase(),p=m.precision?p.substring(0,m.precision):p;break;case"u":p=parseInt(p,10)>>>0;break;case"v":p=p.valueOf(),p=m.precision?p.substring(0,m.precision):p;break;case"x":p=(parseInt(p,10)>>>0).toString(16);break;case"X":p=(parseInt(p,10)>>>0).toString(16).toUpperCase();break}e.json.test(m.type)?k+=p:(e.number.test(m.type)&&(!o||m.sign)?(a=o?"+":"-",p=p.toString().replace(e.sign,"")):a="",f=m.pad_char?m.pad_char==="0"?"0":m.pad_char.charAt(1):" ",h=m.width-(a+p).length,w=m.width&&h>0?f.repeat(h):"",k+=m.align?a+p+w:f==="0"?a+w+p:w+a+p)}return k}var c=Object.create(null);function v(g){if(c[g])return c[g];for(var _=g,b,E=[],p=0;_;){if((b=e.text.exec(_))!==null)E.push(b[0]);else if((b=e.modulo.exec(_))!==null)E.push("%");else if((b=e.placeholder.exec(_))!==null){if(b[2]){p|=1;var k=[],L=b[2],T=[];if((T=e.key.exec(L))!==null)for(k.push(T[1]);(L=L.substring(T[0].length))!=="";)if((T=e.key_access.exec(L))!==null)k.push(T[1]);else if((T=e.index_access.exec(L))!==null)k.push(T[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");b[2]=k}else p|=2;if(p===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");E.push({placeholder:b[0],param_no:b[1],keys:b[2],sign:b[3],pad_char:b[4],align:b[5],width:b[6],precision:b[7],type:b[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");_=_.substring(b[0].length)}return c[g]=E}s.sprintf=t,s.vsprintf=i,typeof window!="undefined"&&(window.sprintf=t,window.vsprintf=i)})()})(yi);function wi(s){return new Promise(e=>{setTimeout(()=>{e()},s)})}String.prototype.camelKabob=function(){let s="";return this.split("").map(e=>{s+=e.toUpperCase()==e?`-${e.toLowerCase()}`:e}),s};String.prototype.kabobCamel=function(){return this.replace(/-./g,s=>s[1].toUpperCase())};function bi(s,e,t){if(e.value==null){console.warn(`initStorage FAIL name:${s} target:${e}`);return}const i=localStorage.getItem(s);if(i!=null)return e.value=parseFloat(i),console.log(`initStorage ${s}:${e.value} data:${parseFloat(i)}`),e.value;if(t==null)localStorage.setItem(s,Number(e.value)),console.warn(`initStorage none:${s}, target:${e.value}`),e.onDefault!=null&&e.onDefault();else return localStorage.setItem(s,Number(t)),console.warn(`initStorage none:${s}, default:${t}`),e.value=t,t}function xi(s){const e=s.split(".");let t="";for(let i in e)t+=i!=1?e[i]:Number("0x"+e[1]),i<e.length-1&&(t+=".");return t}var B={delay:wi,initStorage:bi,versionString:xi};class dt extends J{constructor(t,i){super(t,i);l(this,"_enable",!1);l(this,"autoEnable",!0);l(this,"primed",!1);l(this,"synced");l(this,"linked");l(this,"linkType");l(this,"linkID");l(this,"valPush");l(this,"valSave");l(this,"lastTime");this._val=0}link(t){t!=null&&(this.linkType=t,this.linked=u.linkControl(this))}sync(t){const i=t.v;this.value=i,this.valPush=this.valSave=i,this.set(t),this.synced||(this.autoEnable&&this._enable!=null&&this.enable(),this.synced=!0)}push(){if(this.linked==!1)return;const t=this.value;t!=this.valPush&&(this.valPush=t,this.send("push",t))}save(){if(this.linked==!1)return;const t=this.value;t!=this.valSave&&(this.valSave=this.valPush=t,this.send("save",t))}send(t,i){const n={a:u.actionID.indexOf(t),t:[]};n.t.push({i:this.linkID,v:i|0}),this.linked!=null&&x.transmit(n,`${this.id} >>`)}}const Li=`<div id="region" class="region">
    <div id="wrap" class="wrap"></div>
    <div id="label"></div>
  </div>`;class Ht extends dt{constructor(t,i){super(t);l(this,"_enable",!0);l(this,"_highlight",!1);l(this,"_static",!1);l(this,"_target");l(this,"_index");l(this,"_x0",0);l(this,"_y0",0);l(this,"_x1",100);l(this,"_y1",100);l(this,"_x",0);l(this,"_y",0);l(this,"_scaleX",1);l(this,"_scaleY",1);l(this,"list",[]);l(this,"onExecute");this.link(i),this.target(this.div),this.div.insertAdjacentHTML("beforeend",Li),this.div.classList.add("tna_Icon"),this.dRegion=this.getDiv("region"),this.dWrap=this.getDiv("wrap"),this.dLabel=this.getDiv("label"),isNaN(this.getPropVal("--icon-w"))&&this.setProp("--icon-w",this.getProp("--icon-h")),this._val=0,this.label=this.getDataAttr("label","string","")}set add(t){const i=`
      <svg class="svg" viewBox="${this._x0} ${this._y0} ${this._x1} ${this._y1}">
        <g><circle cx="0" cy="0" r="50" /></g>
      </svg>`;this.dWrap.insertAdjacentHTML("beforeend",i);const n=this.dWrap.lastChild,c=n.lastElementChild;c.innerHTML=t,this.list.push(n),this.update()}set addCenter(t){this.add=t,this.list.slice(-1)[0].lastElementChild.firstElementChild.setAttribute("transform","translate(-50 -50)")}symbol(t){return window["sym_"+t]==null?console.warn(`${this.id} addSymbol FAIL: ${t}`):this.add=`<use href="#sym_${t}"/>`,this}enable(t=!0){return t==this._enable?this:(this._enable=t,this.render(),this)}render(t=this._view,i){super.render(t,i),this.div.classList.toggle("interact",t&&this._enable&&!this._static),this.div.classList.toggle("disable",!this._enable&&this._view)}set index(t){if(t=Number(t),isNaN(t))return console.warn(`${this.id} set index NaN`);if(t==this._index)return;this._index!=null&&this.list[this._index].classList.remove("show"),this.list[t].classList.add("show"),this._index=t}get index(){return this._index}def(){return this.index=0,this}toggle(t){return this._val=t==null?!this._val:t,this.draw(t),this}cycle(){let t=this._index+1;return t=t>=this.list.length?0:t,this.index=t,this.draw(),this}clear(){this.list.forEach(t=>t.remove()),this.list=[]}update(){const t=`translate(${this._x} ${this._y}) scale(${this._scaleX} ${this._scaleY})`;for(let i in this.list)this.list[i].firstElementChild.setAttribute("transform",t)}execute(){this.onExecute!=null&&this.onExecute(this),this.onChange!=null&&this.onChange(this)}set(t){typeof t!="object"&&(this.value=t),t!=this.lastVal&&(this.index=this.value),super.set(t)}svgRef(t){return t>this.list.length-1?console.warn(`${this.id} svgRef FAIL, bad index`):this.list[t]}gRef(t){return t>this.list.length-1?console.warn(`${this.id} gRef FAIL, bad index`):this.list[t].firstElementChild}viewBox(t,i,n,c){return this._x0=t,this._y0=i,this._x1=n,this._y1=c,this}translate(t,i){return this._x=t,this._y=i,this.update(),this}center(){return this.translate(50,50),this}scaleXY(t,i){return this._scaleX=t,this._scaleY=i,this.update(),this}scale(t){return this._scaleX=this._scaleY=t,this.update(),this}scaleCenter(t){return this._scaleX=this._scaleY=t,this._x=50,this._y=50,this.update(),this}sizeXY(t,i){return this.div.style.setProperty("--icon-h",i+"px"),this.div.style.setProperty("--icon-w",t+"px"),this}size(t){return this.div.style.setProperty("--icon-x",t),this}highlight(t){if(t==-1&&(t=!this._enable),!!this._enable)return this._highlight=t,this.div.classList.toggle("highlight",t),this}static(t=!0){return this._static=t,this.div.classList.toggle("interact",!t),this}set label(t){const i=t.length>0;this.dLabel.innerText=i?t:"",this.dLabel.classList.toggle("label",i)}target(t){return this._target=typeof t=="string"?window[t]:t,this._target.onclick=this.execute.bind(this),t!=this.div&&(this.div.style.pointerEvents="none"),this}enabled(){return this._enable}}class wt extends Ht{constructor(t,i){super(t);l(this,"_class");l(this,"_anim");l(this,"_count",0);l(this,"_duration",0);l(this,"_delay",0);l(this,"onAnimEnd");this.link(i)}async act(t=!0){const i=this._class!=null?"act_"+this._class:"act";if(this.div.classList.contains(i)&&(this.div.classList.remove(i),await this.delay()),this.div.classList.toggle(i,t),t){const n="tna_Icon_"+(this._anim!=null?"act_"+this._anim:"act");this.div.onanimationend=c=>{`${this.id}`,c.animationName==n&&this.div.classList.remove(i),this.div.onanimationend=void 0,this.onAnimEnd!=null&&this.onAnimEnd(this)}}else this.div.onanimationend=void 0;return this}choreo(t,i){return this._anim=t,this._class=t+(i==null?"":"_"+i),this}timing(t,i=this._dur,n=0){this._count=t=Number(t),this._dur=i=Number(i),this._delay=n=Number(n);const c="--icon-act_"+this._anim;return this.setProp(c+"-n",t==0?"infinite":t),this.setProp(c+"-t",i+"ms"),this.setProp(c+"-d",n+"ms"),this}property(t,i){this.dWrap.style.setProperty("--icon-act-"+t,i)}}const ft=[];let ut;function Di(s,e){const t=window[s];if(t==null)return console.log(`panel.add() FAIL, cannot find ${s}`);t.dataset.index=ft.length,ft.push({id:s,title:e,panel:t})}function ki(){if(ut!=null)return ft[ut].panel}function Ii(){return ut}function Ti(){return ut!=null?ft[ut].id:void 0}function be(s,e=!1){s<0||(ut=s,ft.forEach((t,i)=>{const n=t.panel,c=s==i;e||(n.classList.toggle("show",c),n.children[0].classList.toggle("show",c)),c&&n._tna_begin!=null&&n._tna_begin()}))}function Ei(s,e=!1){const t=ft.findIndex(i=>i.id==s);return t!=null&&be(t,e),t}function Si(s){return new URLSearchParams(s).get("panel")}var Tt={add:Di,current:ki,currentID:Ti,currentIndex:Ii,index:be,setByID:Ei,inject:Si};class jt extends J{constructor(t,i){super(t,"div");l(this,"_static",!1);l(this,"_index");l(this,"_label");l(this,"_html");l(this,"_target");l(this,"control");l(this,"bClick");if(i!=null){this.control=i,this.div.classList.add("menu_item"),this.dLabel=this.getDiv("label"),this.bClick=this.click.bind(this);let n=this.div.querySelector("._click");n==null&&(n=this.div),n._tna_target=this.div,this._target=n}else this.div.classList.add("menu_static"),this._target=this.div,this.static();this.enable()}click(t){let i=t.target._tna_target;i==null&&(i=this.parent(t.target,"_item")),this.execute(i),t.preventDefault(),t.stopImmediatePropagation()}async execute(t){this.control.click(this),this.div.classList.remove("hover"),this.div.classList.add("action"),await this.delay(360),this.control.view(!1),await this.delay(300),this.div.classList.remove("action"),this.control.execute(this)}enable(t=!0){return this.enabled=t,this.control!=null&&this.div.classList.toggle("hover",t&&this.control._hover),this.div.classList.toggle("enable",t),this._target.onclick=t&&!this._static?this.bClick:null,this._target.style.pointerEvents=t&&!this._static?"":"none",this}highlight(t=!0){return this.div.classList.toggle("highlight",t),this.enable(!t),this}set label(t){this.dLabel.innerText=this._label=t}get label(){return this._label}set html(t){this.dLabel.innerHTML=this._html=t}static(t=!0){return this._static=t,this._target.onclick=this.enabled&&!this._static?this.bClick:null,this._target.style.pointerEvents=t?"none":"",this}}const Pi=`<div id="region" class="region">
    <div id="bg" class="bg"></div>
    <div id="panel" class="panel"></div>
  </div>`,$i=`<div>
    <div id="label" class="label"></div>
  </div>`;class Ai extends J{constructor(t,i=Pi){super(t);l(this,"_enable",!1);l(this,"_index");l(this,"_highlight",!1);l(this,"_hover",!0);l(this,"_static_high",!0);l(this,"_wipe",!1);l(this,"_tm_open");l(this,"_tm_close");l(this,"_block_tm_open");l(this,"_block_tm_close");l(this,"_block_opacity");l(this,"_itemT");l(this,"_staticT");l(this,"_itemN",0);l(this,"_staticN",0);l(this,"pool",[]);l(this,"list",[]);l(this,"last");l(this,"onBegin");l(this,"onEndPrime");l(this,"onEnd");l(this,"onPrime");l(this,"onExecute");l(this,"onResize");this._itemT=$i,this.div.insertAdjacentHTML("afterbegin",i),this.div.classList.add("tna_Menu"),this.dRegion=this.getDiv("region"),this.dBg=this.getDiv("bg"),this.dPanel=this.getDiv("panel"),this.getDiv("banner"),this.blocked=this.div.dataset.block!=null,this.blocked&&(this.dBlock=document.createElement("div"),this.dBlock.id="block",this.div.insertAdjacentElement("afterbegin",this.dBlock),this.getDiv("block"),this.dBlock.classList.add("block"),this.dBlock.onmousedown=this.dBlock.ontouchstart=this.escape.bind(this)),this._highlight=this.div.dataset.highlight!=null,this.enable(this.div.dataset.enable!=null),this._block_opacity=this.getProp("--menu-block-a"),this.itemH=this.getDataAttr("menuIH","pixel",""),this.staticH=this.getDataAttr("menuStaticH","pixel",""),this.merge()}merge(){let t,i;const n=this.div.childElementCount-this.blocked;for(let c=1;c<n;c++)i=this.div.children[1+this.blocked],i.classList.contains("menu_item")?(t=this.add(),t.link=i.dataset.link,t.label=i.innerHTML,i.dataset.highlight!=null&&(this._index=t._index)):i.classList.contains("menu_static")&&(t=this.add("static")),t.view(!0),i.remove();this._index!=null&&this.index(this._index),n>1&&this.update()}add(t="item"){let i,n;switch(t){case"static":if(this._staticT!=null){const c=document.createElement("template");c.innerHTML=this._staticT,n=c.content.firstElementChild.cloneNode(!0)}else n=document.createElement("div");this.last=this.createStatic(n);break;default:if(this._itemT!=null){const c=document.createElement("template");c.innerHTML=this._itemT,n=c.content.firstElementChild.cloneNode(!0)}else n=document.createElement("div");this.last=this.createItem(n);break}return i=this.dPanel.appendChild(n),this.pool.push(i),this.last}createItem(t){const i=new jt(t,this),n=`${this.id}_item_${this._itemN}`;return t.id=i.id=n,i._index=this._itemN,i.link=this._itemN,i.height=this.itemH,this.list.push(t),this._itemN++,i}createStatic(t){const i=new jt(t).static(),n=`${this.id}_static_${this._itemN}`;return t.id=i.id=n,i.height=this.staticH,this._staticN++,i}index(t){this._index=t;for(let i in this.pool)this.pool[i].tna.highlight(!1);return t>=0&&this.list[t].tna.highlight(),this.setStatic(t),super.set(t),this}setStatic(t){if(!this._static_high)return;let i;if(this.pool.find((n,c)=>{const v=n==this.list[t];return v&&(i=c),v}),i!=null){const n=i-1,c=i+1;n>=0&&this.pool[n].tna.highlight(),c<this.pool.length-1&&this.pool[c].tna.highlight()}}update(){let t=0;return this.pool.forEach((i,n)=>{t+=i.tna.height*i.tna._view}),this.height=t,t}clear(){this.list.forEach(t=>{t.tna=void 0,t.remove()}),this.list=[],this.pool=[],this._itemN=this._staticN=0,this.update()}click(t){this.last=t,this._wipe&&this.index(-1),this.setStatic(t._index),this.onPrime!=null&&this.onPrime(t,t.link)}execute(t){this._highlight&&(t.enable(!1),this.index(t._index)),this.onExecute!=null&&this.onExecute(this,t.link)&&this.end()}async escape(t){t!=null&&(t.stopImmediatePropagation(),t.preventDefault()),this.view(!1),this.transBlock(this._block_tm_close),this.onEnd!=null&&this.onEnd(this)}begin(){this.transRegion(this._tm_open,"ease-out"),this.transBlock(this._block_tm_open,"ease"),this.onBegin!=null&&this.onBegin(this,!0)}endPrime(){this.transRegion(this._tm_close,"ease-in"),this.onEndPrime!=null&&this.onEndPrime(this)}end(){this.transBlock(),this.onEnd!=null&&this.onEnd(this)}render(t=this._view){super.render(t),this.div.classList.toggle("open",t),t?this.begin():this.endPrime()}find(t){return this.list.find(n=>n.tna.label==t)}wipe(t=!0){return this._wipe=t,this}hover(t=!0){return this._hover=t,this}set height(t){this._height=t,this.div.style.setProperty("--menu-h",t+"px"),this.onResize!=null&&this.onResize(this)}get height(){return this._height}get count(){return Object.keys(this.list).length}get next(){if(this.last._index<this.count)return this.list[this.last._index+1]}get previous(){if(this.last._index>0)return this.list[this.last._index-1]}set template(t){this._itemT=t}set templateStatic(t){this._staticT=t}staticHigh(t=!0){return this._static_high=t,this}timing(t,i){return this._tm_open=t,this._tm_close=i,this}timingBlock(t,i){return this._block_tm_open=t,this._block_tm_close=i,this}transRegion(t=0,i=""){const n=t+"ms";return this.dRegion.style.transitionDuration=n,this.dRegion.style.transitionTimingFunction=i,this}transBlock(t=0,i=""){const n=t+"ms",c=this._view?this._block_opacity:0;return this.dBlock.style.transitionDuration=n,this.dBlock.style.transitionTimingFunction=i,this.dBlock.style.opacity=c,this.dBlock.style.visibility="visible",t==0?this.transBlockEnd():this.dBlock.ontransitionend=this.transBlockEnd.bind(this),this}transBlockEnd(){this._view||(this.dBlock.style.visibility="hidden"),this.dBlock.ontransitionend=void 0}}var Ci={control:Ai,item:jt};const Mi=`<g stroke-width="6.7">
    <polygon
      points="89.5 72.8 50 95.6 10.5 72.8 10.5 27.2 50 4.4 89.5 27.2 89.5 72.8"
    />
    <polyline id="badge_N" points="28.4 62 28.4 38 71.6 62 71.6 38" />
  </g>`,Ri=`<div id="region" class="region">
    <div id="bg" class="bg"></div>
    <div id="banner" class="banner">
      <div class="banner_wrap">
        <div>C</div><div>u</div><div>b</div><div>e</div>
        <div>C</div><div>o</div><div>r</div><div>e</div></div></div>
    <div id="panel" class="panel"></div>
    </div>
  </div>`;const Et={},Ut=[];let I,M,pt,zt,xe=!1,Lt=!1;function Oi(){if(Et.badge=M=new wt("badge").show(),M.div.classList.add("connect"),M.add=Mi,M.value=!1,M.def(),M.ext_onExecute=e=>{e.choreo("3D_flip").timing(1,250).act(),I.view(!I._view),I._view||I.escape()},De(!D.prop.modeExt),Et.dot=pt=new Ht("badge_dot"),pt.add='<circle cx="50" cy="50" r="50" />',pt.static().prime().def(),pt.onRender=e=>pt.div.classList.toggle("orbit",e._view),window.menu!=null){Et.menu=I=new Ci.control("menu",Ri).wipe(),zt=I._index,I.timing(250,250).timingBlock(500,250),I.onExecute=(t,i)=>{t.last.index==0;const n=Le(i);return n&&(zt=t._index),s(),n},I.onBegin=I.onEnd=t=>{M.highlight(t._view);const i=t._view?"blur(3px)":"",n=t._view?t._block_tm_open:t._block_tm_close;oe(n,"ease",i),Lt=!1},ae("Admin");const e=ae("R/Con","rc");e.html='R<span style="padding-left: 2px; font-size: 130%; position: relative; top: 1.5px;">/</span>Con'}const s=async()=>{Lt=!0,await B.delay(2e3),Lt&&(M.highlight(!1),I.index(zt),I.transBlock(),oe(),Lt=!1)}}function ae(s,e){const t=I.find(s);if(t==null){let i=I.add("static").enable();return Ut.push(i),i=I.add().enable(),Ut.push(i),i.label=s,i.link=`/${e!=null?e:s.toLowerCase()}/`,xe=!0,i}else return t.tna}function oe(s=0,e="",t=""){const i=s+"ms",n=window.fit!=null?Tt.current():window.page;if(n==null)return console.warn("nav menuBG FAIL");n.style.filter=t,n.style.transitionProperty="filter",n.style.transitionDuration=`${i}`,n.style.transitionTimingFunction=e}function Le(s){console.log(`hyper -> "${s}"`);const e=Tt.currentIndex(),t=new URL(s,"http://x"),i=t.pathname==document.location.pathname;if(i){const n=Tt.inject(t.search);Tt.setByID(n)}else!D.prop.local&&s.length>1&&s.slice(-1)=="/"&&(s=s.slice(0,-1)),window.location=s,I.index(e);return i}function Fi(s){!xe||(Ut.forEach(e=>e.view(s)),I.update())}function De(s=!0){M.div.classList.toggle("static",!s),M.div.classList.toggle("dim",!s),M.onExecute=s?M.ext_onExecute:void 0,M.enable(s)}var it={tna:Et,init:Oi,enable:De,hyper:Le,access:Fi};class O extends dt{constructor(t,i=void 0,n="info"){super(t,i);l(this,"onChange");this.link(n)}}const X={cast:"border-radius: 9px; padding: 1px 7px 0; font-style: italic; font-weight: bold",test:"border: 0.25px solid gray; border-style: solid solid solid none; border-radius: 0 9px 9px 0; padding: 1px 7px 0 0; font-style: italic; font-weight: bold",gray:"border: 0.25px solid gray; background: gray; color: white;",black:"border: 0.25px solid black; background: black; color: white;",red:"border: 0.25px solid red; background: red; color: white;",gold:"border: 0.25px solid gray; background: gold; color: black;"},tt=["fail","cache","cache_end","tear","touch","normal","warn","error","alert","bold"],Xt={},st={},G={};let St,Pt,Gt=0;function Bi(){St=u.callID.indexOf("call_console"),Xt.rc=new O("call_console","object","call"),Xt.rc.onChange=(s,e)=>{switch(e.v){case 0:G.fail!=null?G.fail():V("fail","Access Not Authorized");break;case 1:e.n==1&&(Pt=0);const t=JSON.stringify(e);console.groupCollapsed("cache n:%o, count:%o",e.n,e.z.length),console.log(t),console.groupEnd(),e.z.length&&e.z.forEach(i=>{st.last_format=tt[i.f],st.last_msg=i.m,V(Gt?tt[i.f]:"tear",i.m),Gt++}),Pt+=e.z.length;break;case 2:console.warn("cache EOL chunks:%o count:%o",e.n,Pt),e.c!=null&&(st.capacity=e.c),e.f!=null&&(st.full=e.f),G.cache!=null&&G.cache();break;default:st.last_format=tt[e.v],st.last_msg=e.x,G.msg!=null&&G.msg(),V(tt[e.v],e.x);break}}}function Hi(){Gt=Pt=0}function V(s,e){if(G.output!=null)return G.output(s,e);switch(s){case"normal":console.log("%cRC",X.gray+X.cast,e);break;case"warn":const t="border: 0.25px black solid;";console.log("%cRC",t+X.gold+X.cast+t,e);break;case"error":console.log("%cRC%c %s",X.red+X.cast,"color: red",e);break;case"bold":console.log("%cRC%c %s",X.black+X.cast,"font-weight: bold",e);break}}function Ni(){D.prop.preflight||zi()}function zi(){const s=new CustomEvent("meh"),e="rc.test format:",t={a:u.actionID.indexOf("call"),t:[{i:St,v:tt.indexOf("normal"),x:e+"normal"},{i:St,v:tt.indexOf("warn"),x:e+"warn"},{i:St,v:tt.indexOf("error"),x:e+"error"}]};s.data=JSON.stringify(t),x.parse(s)}function Wi(s){V("normal",s)}function Vi(s){V("warn",s)}function ji(s){V("error",s)}function Ui(s){V("tear",s)}function Xi(s){V("alert",s)}function Gi(s){V("bold",s)}var et={formatID:tt,style:X,tna:Xt,prop:st,upon:G,init:Bi,prime:Ni,reset:Hi,log:Wi,warn:Vi,error:ji,tear:Ui,alert:Xi,bold:Gi};const Zi=1,Yi=2;class qi extends J{constructor(){super("tron","object");l(this,"_enable",!0);l(this,"state",!1);l(this,"STAGE",Object.freeze({BEGIN:1,END:0}));l(this,"holdTime");l(this,"delayTime");l(this,"showTimeout");l(this,"hideTimeout");l(this,"onWrite");this.setHold().setDelay()}assign(t){const i=window[t];return i==null?console.warn("tron assign FAIL: %o",t):(i.classList.add("tna_Tron"),this.div=i,this)}enable(t=!0){if(this.div!=null&&t!=this._enable)return this.div.classList.toggle("disable",!t),this._enable=t,this}async write(t,i=this.holdTime){this.div!=null&&(clearTimeout(this.hideTimeout),this.div.innerText=t,this.div.classList.add("show","prime"),this.state=!0,this.hideTimeout=setTimeout(this.writeEnd.bind(this),i*1e3),this.onPrime!=null&&this.onWrite(this,STAGE.BEGIN))}async writeEnd(){this.state=!1,this.hideTimeout=void 0,this.div.classList.remove("show"),this.div.ontransitionend=()=>{this.div.classList.remove("prime"),this.onPrime!=null&&this.onWrite(this,STAGE.END),this.div.ontransitionend=void 0}}writeDelay(t,i=this.holdTime,n=this.delayTime){this.div!=null&&(clearTimeout(this.showTimeout),this.state?(this.div.innerText=t,this.write(t,i)):this.showTimeout=setTimeout(this.write.bind(this),n*1e3,t,i))}cancel(){clearTimeout(this.showTimeout)}kill(){this.cancel(),this.writeEnd()}add(t){return t.onTron=i=>this.write(i),this}setHold(t=Zi){return this.holdTime=t,this}setDelay(t=Yi){return this.delayTime=t,this}}var nt=new qi;class Ji extends dt{constructor(){u.prefID.indexOf("ux_index")<0&&console.warn("tna_UX constructor FAIL, cannot find prefID");super("ux_index","object");l(this,"_lastIndex");l(this,"_lastDialog");l(this,"_nextDialog");l(this,"_currentDialog");this.link("pref")}set(t){const i=t.v;if(this._lastIndex!=i&&(this._nextDialog=u.getDialogByIndex(i),this._lastDialog=u.getDialogByIndex(this._lastIndex),this._nextDialog!=null)){this.tron&&this._lastDialog!=null&&`${this._lastDialog.id}`,this._lastDialog!=null&&this.last.exit(),this._nextDialog.begin(),this._lastIndex=this._val=i,this._currentDialog=this._nextDialog,super.set(t);return}}get last(){return this._lastDialog!=null?this._lastDialog:{id:"NULL"}}get lastID(){return this._lastDialog!=null?this._lastDialog.id:void 0}get next(){return this._nextDialog}get current(){return this._currentDialog}get currentID(){return this._currentDialog!=null?this._currentDialog.id:void 0}}const Ki='<div id="region" class="region"></div>',Qi=`
    <svg id="svg" viewBox="0 0 12 13.8" class="digit">
      <g id="a" class="seg">
        <polygon points="9.76 0 10.03 0.31 8.66 1.5 4.33 1.5 3.31 0.34 3.7 0 9.76 0"/>
      </g>
      <g id="b" class="seg">
        <polygon points="10.63 1 9.96 5.77 9.07 6.55 8.44 5.82 8.99 1.88 10.36 0.69 10.63 1"/>
      </g>
      <g id="c" class="seg">
        <polygon points="7.57 11.97 8.13 8.03 9.02 7.25 9.65 7.98 8.97 12.8 8.58 13.14 7.57 11.97"/>
      </g>
      <g id="d" class="seg">
        <polygon points="2.86 12.3 7.19 12.3 8.21 13.46 7.82 13.8 1.76 13.8 1.49 13.49 2.86 12.3"/>
      </g>
      <g id="e" class="seg">
        <polygon points="0.89 12.8 1.56 8.03 2.45 7.25 3.08 7.98 2.53 11.92 1.16 13.11 0.89 12.8"/>
      </g>
      <g id="f" class="seg">
        <polygon points="2.5 6.55 1.87 5.82 2.55 1 2.94 0.66 3.95 1.83 3.39 5.77 2.5 6.55"/>
      </g>
      <g id="g" class="seg">
        <polygon points="8.06 6.15 8.69 6.88 7.8 7.65 3.46 7.65 2.83 6.92 3.72 6.15 8.06 6.15"/>
      </g>
      <g id="dp" class="seg"><circle cx="10.77" cy="13.05" r="0.75" /></g>
    </svg>`,ts=`<svg id="svg" viewBox="0 0 12.47 13.8" class="colon">
    <g class="seg" transform="translate(0.2 0)">
      <circle cx="1.72" cy="3.45" r="0.75" />
      <circle cx="0.75" cy="10.35" r="0.75" />
    </g>
  </svg>`;var Wt={HTML:Ki,DIGIT:Qi,COLON:ts};class es extends dt{constructor(t){super(t);l(this,"_primeD",!1);l(this,"_primeN",0);l(this,"_bright",0);l(this,"digits",[]);l(this,"onPrime");this.fuse(),this.link("info"),this.div.insertAdjacentHTML("beforeend",Wt.HTML),this.div.classList.add("tna_Retro7"),this.dRegion=this.getDiv("region");for(let n=0;n<4;n++){this.dRegion.insertAdjacentHTML("beforeend",Wt.DIGIT);const c=this.dRegion.querySelector("#svg");c.id=`svg_${this.digits.length}_${this.id}`,c.style.setProperty("--retro-i",n),this.digits.push(c)}this.dRegion.insertAdjacentHTML("beforeend",Wt.COLON);const i=this.dRegion.querySelector("#svg");i.id=`colon_${this.id}`,this.divColon=i.children[0]}print(t){for(let i=0;i<4;i++)this.digitRaw(i,t[i])}digitRaw(t,i){let n=this.digits[t].children;for(let c=0;c<8;c++){const v=i>>c&1;n[c].classList.toggle("show",v)}}colon(t=2){this.divColon.classList.toggle("show",t==2)}clear(){this.print([0,0,0,0]),this.colon(!1),this.onChange!=null&&this.onChange(this,this._val)}async reset(){this._primeD=!1,this._primeN=0,this.view(!1),await this.delay(500),this.clear(),this.prime(!1)}async set(t){if(this._val=t.v,!this._primeD&&(this.onBegin!=null?this.onBegin(this):this.show(),this._primeN<2)){let i=0;for(let n=0;n<t.v.length;n++)i+=t.v[n];i>0&&this._primeN++,this._primeN=Math.min(this._primeN,2),this._primeN>1&&this.onPrime!=null&&this.onPrime(this)}this.print(t.v),this.colon(t.v[4]),this.onChange!=null&&this.onChange(this,t)}bright(t=0){return this._bright=t,this.div.classList.toggle("dim",t==0),this}}const ke="3.1.04",Ie={}.VITE_PREFLIGHT==="true",is={}.VITE_EXT_SERVE==="true";Ie||console.warn("core PREFLIGHT: %o",!1);const $={},R={preflight:Ie,modeExt:is,modeAP:!1,prime_local:!1},Z={},_t={},lt={},Q={};let Dt,Te,F,z,Mt,W,Zt=!1;function ss(){nt.assign("tron_output"),rs(),as(),$.title=F=new J("head_title"),F.div.classList.add("click"),F.div.onclick=()=>{let e=_t.title!=null?_t.title():!1;e=e==null?!1:e,e||console.log("core title click default")},F.fuse().shy(!(R.modeExt||!Mt)).view(),ns(),window.diag_client.innerText=B.versionString(ke);const s=String(document.location);R.local=s.includes("host:")||s.includes("local:"),Dt=new O("developFPO","object"),Dt.onDefault=()=>R.prime_local=!0,B.initStorage("develop",Dt),R.develop=Dt.value,$.ux=Te=new Ji().tron(),it.init()}function ns(){window.socket!=null&&(W=new Ht("socket").prime().show().enable(),W.symbol("x").symbol("o"),W.value=!0,W.index=1,W.onExecute=s=>{s.toggle(),s.index=s.value,x.monitor(s.value),s.value?x.init():x.kill()},$.socket_button=W)}function as(){R.modeExt||(Mt=window.info_display!=null,Mt&&($.retro=z=new es("info_display"),z.ext_no_prime=!0,z.ext_view=void 0,z.onBegin=s=>{},z.onRender=(s,e)=>{const t=e!=null?e:s._view;s.ext_view!=t&&(s.ext_view=t,s.div.classList.toggle("click",t),s._view&&s.shy(!1))},z.div.onclick=os))}function os(){let s=_t.retro!=null?_t.retro():!1;s=s==null?!1:s,s||(console.log("RD click default, ux:",Te.currentID),x.send("save","clock_disp",-1))}function rs(){if(window.rc_ind==null||R.user==0)return;const s=new O("info_rc","object");et.upon.msg=(e=et.prop.last_format)=>{const t=R.user!=null?R.user:0;$.rc_ind.view(e!=et.formatID.indexOf("touch")&&t)},s.onChange=(e,t)=>{et.upon.msg(t.v)},$.rc_ind=new wt("rc_ind").symbol("dot").def(),$.rc_ind.onExecute=async e=>{e.choreo("blink","hot").timing(3,150).act(),e.onAnimEnd=()=>it.hyper("/rc/")}}let re=!1;async function ee(){for(const[s,e]of Object.entries($))e.ext_no_prime==null&&e.prime();if(Mt)F.shy(!1);else return ee=!0;re||await B.delay(1250),F.view(!1),F.div.classList.add("slide"),window.head.classList.add("gradient"),$.retro.prime(),$.retro.shy(!1),await B.delay(250),$.retro.view(),F.shy(),F.div.classList.remove("slide"),re=!0,Se()}function Ee(){Zt=!1,it.tna.badge.div.classList.add("connect","prime"),it.tna.dot.viewStaged(!1),W!=null&&(W.index=1),Z.open!=null&&Z.open()}async function Yt(){Zt||(Zt=!0,it.tna.badge.div.classList.add("prime"),it.tna.badge.div.classList.remove("connect"),it.tna.dot.view(!0),window.head.classList.remove("gradient"),await B.delay(250),z!=null&&z.reset(),W!=null&&W.def(),Z.close!=null&&Z.close(),F.shy(!1),await B.delay(250),F.view())}function ds(){x.onOpen(Ee),x.onClose(Yt),new O("info_install","object").onChange=(t,i)=>{t.ext_prime==null&&(lt.display=(i.v&u.hwMask.display)>>u.hwOffset.display,lt.piezo=(i.v&u.hwMask.piezo)>>u.hwOffset.piezo,lt.xpio=(i.v&u.hwMask.xpio)>>u.hwOffset.xpio,lt.gps=(i.v&u.hwMask.gps)>>u.hwOffset.gps,i.z,Q.display=(i.z&u.hwMask.display)>>u.hwOffset.display,Q.piezo=(i.z&u.hwMask.piezo)>>u.hwOffset.piezo,Q.xpio=(i.z&u.hwMask.xpio)>>u.hwOffset.xpio,Q.gps=(i.z&u.hwMask.gps)>>u.hwOffset.gps,Object.keys(Q).forEach(function(n,c){Q[n]||document.querySelectorAll("._"+n).forEach(g=>g.style.display="none")}))},new O("call_prime","object","call").onChange=t=>{ee(),t.ext_prime==null&&(Z.prime!=null&&Z.prime(lt,Q),t.ext_prime=!0)},$.user=new O("info_user","object"),$.user.onChange=t=>{R.user=t.data.v,it.access(R.user),Z.user!=null&&Z.user(t.data)};let s=new O("call_restart","object","call");s.onChange=async t=>{et.bold("system ESP restart"),Yt(),await t.delay(1e3),x.send("ping")};let e=new O("call_warn","object","call");if(e.onChange=(t,i)=>{let n=parseInt(i.v);n=n<u.warnID.length?n:-1;let c;n>=0&&(c=u.warnID[n]),c!=null&&console.error(`system warning ${c}`)},z!=null&&u.getControlByID("ui_bright")==null){const t=new O("ui_bright","object","pref");t.onChange=(i,n)=>z.bright(n.v),$[t.id]=t}}function Se(s=R.user){let e=document.querySelectorAll("._admin");e.forEach(t=>t.style.display=s?"":"none"),e=document.querySelectorAll("._admin_alt"),e.forEach(t=>t.style.display=s?"none":"inherit")}var D={tna:$,prop:R,upon:Z,click:_t,version:ke,install:lt,activate:Q,init:ss,prime:ee,open:Ee,close:Yt,patch:ds,admin:Se};let Rt=!1,rt=!1,Pe=!1,at,$e,qt,Jt;const ls=`ws://${window.location.hostname}/ws`;let Y,yt=!1;function ie(){Rt||(Rt=!0,Y=new WebSocket(ls),Y.onopen=cs,Y.onclose=fs,Y.onmessage=$e,rt=!1,at=clearTimeout(at))}function hs(s){s!=yt&&(console.log(`socket monitor b:${s} state:${rt}`),yt=s,s&&(!rt&&at==null?ie():at=clearTimeout(at)))}function Ae(){return rt=(Y!=null?Y.readyState:de.closed)==de.connected,rt}function cs(){console.warn("socket open"),rt=!0,qt!=null&&qt()}function fs(){console.error(`socket close, squelch:${Pe} check:${yt}`),Rt=!1,rt=!1,Jt!=null&&Jt(),yt&&(clearInterval(at),at=setTimeout(ie,1e3))}function us(){console.warn("socket kill"),Y&&Y.close(),Pe=!0,Rt=!1}function Ce(s){$e=s}function ps(s){qt=s}function gs(s){Jt=s}const de=Object.freeze({connecting:0,connected:1,closing:2,closed:3});let j=!1;var x={onOpen:ps,onClose:gs,onParse:Ce,check:yt,init:ie,ready:Ae,monitor:hs,kill:us,parse:Nt,sendUX:bs,sendTune:xs,sendObject:Me,send:Re,fakeMessage:Ds,fakeObject:Ls,transmit:bt,fill:ks,tron:vs};Ce(Nt);function vs(s=!0){j=s}function ms(s){let e;for(let t in s)e=u.getControlByIndex("info",s[t].i),e!=null?(s.length>1&&(j?console.log(`<< info #${t} %o ${s[t].v}`,e.id):e.id!="info_display"&&j&&console.log(`<< info %o ${s[t].v}`,e.id)),e.set(s[t])):j&&console.log(`parseInfo #${t} no object id %o`,u.infoID[s[t].i])}function _s(s){for(let e in s){const t=s[e].i,i=u.getControlByIndex(t<u.prefBase?"admin":"pref",t);i!=null?(j&&(s.length>1?console.log(`<< pref #${e} ${i.id} ${s[e].v}`):console.log(`<< pref ${i.id} ${s[e].v}`)),i.sync(s[e])):j&&console.log(`parseSync #${e} no object id %o`,t)}}function ys(s){for(let e in s){const t=u.getControlByIndex("call",s[e].i);t!=null&&t.set(s[e])}}function ws(s){for(let e in s){const t=s[e],i=u.getControlByIndex("ux",t.i);if(i!=null){if(t.s<0)return console.warn("parseUX FAIL bad stage value %o",u.stageID[t.v]);i.parse(t)}else j&&console.log("parsUX no object %o",u.infoID[t.i])}}function Nt(s){let e=JSON.parse(s.data),t=u.actionID[e.a],i=e.t;switch(t){case"call":ys(i);break;case"ux":ws(i);break;case"info":ms(i);break;case"sync":_s(i);break}}function bs(s,e,t){const i="ux",n=u.uxID.indexOf(s);if(n<0)return console.warn("sendUX FAIL no dialog %o",s);const c={i:n},v=u.stageID.indexOf(e);v>=0&&(c.v=v),t!=null&&(c.x=t);const g={a:u.actionID.indexOf(i),t:[c]};bt(g,`${i} >>`)}function xs(s="default"){const e="call",t=u.tuneID.indexOf(s);if(t<0)return console.warn("sendTune FAIL no melody %o",s);u.callID.indexOf("call_tune");const i={a:u.actionID.indexOf(e),t:[{i:u.callID.indexOf("call_tune"),v:t}]};bt(i,`${e} >>`)}function Me(s,e,t){const i=u.actionID.indexOf(s);if(i<0)return console.log("sendObject FAIL no action %o",s);let n={a:i,t:[]},c={i:u.getPrefID(e)};return Object.assign(c,t),n.t.push(c),bt(n,`${s} >>`),n}function Ls(s,e,t){const i=Me(s,e,t);if(typeof i=="object"){const n=new CustomEvent("meh");n.data=JSON.stringify(i),Nt(n)}}function Re(s,e,t){let i=u.actionID.indexOf(s);if(i<0){j&&console.log("send FAIL no action %o",s);return}let n={a:i,t:[]},c=-1;switch(s){case"push":case"save":case"sync":c=u.getPrefID(e);break;case"call":c=u.callID.indexOf(e);break;case"ping":c=t=0}if(c<0){j&&console.log("send FAIL no id %o in action %o",e,s);return}return n.t.push({i:c,v:t|0}),bt(n,`${s} >>`),n}function Ds(s,e,t){const i=Re(s,e,t);if(typeof i=="object"){const n=new CustomEvent("meh");n.data=JSON.stringify(i),Nt(n)}}function bt(s,e){const t=JSON.stringify(s);j&&console.log(`${e} ${t}`),Ae()&&Y.send(t)}async function ks(s,e,t){let i={};try{const n=await fetch(e,{method:"GET"});if(n.status===200)i=await n.json();else throw new Error(`${e} FAIL fetch code:${n.status}`)}catch(n){console.warn(`${e} FAIL, using test data`,n),D.prop.preflight||Object.assign(i,t)}console.groupCollapsed(`comm fill ${e}`),console.log(i),console.groupEnd(),Object.assign(s,i)}const $t=Math.floor(new Date().getTime()/1e3);u.actionID.indexOf("info"),u.infoID.indexOf("info_hardware"),u.infoID.indexOf("info_mfg"),u.infoID.indexOf("info_reg");const Is={a:u.actionID.indexOf("info"),t:[{i:u.infoID.indexOf("info_rc"),v:4},{i:u.infoID.indexOf("info_install"),v:u.hwMask.display+u.hwMask.piezo+u.hwMask.xpio+u.hwMask.gps+0,z:u.hwMask.display+u.hwMask.piezo+u.hwMask.xpio+u.hwMask.gps+0},{i:u.infoID.indexOf("info_user"),v:1},{i:u.infoID.indexOf("info_firmware"),v:"8.8.88"},{i:u.infoID.indexOf("info_uptime"),v:$t-3600*24*99},{i:u.infoID.indexOf("info_net"),v:"expresso",p:"8C:CE:4E:D5:36:9D",q:"192.168.2.100"},{i:u.infoID.indexOf("info_rssi"),v:"-79"},{i:u.infoID.indexOf("info_status"),v:u.serviceID.indexOf("GPS"),g:1,n:1},{i:u.infoID.indexOf("info_tap"),v:4,m:884,c:4},{i:u.infoID.indexOf("info_gps"),t:$t,d:1200,v:13,max:12,min:12,rec:22},{i:u.infoID.indexOf("info_ntp"),v:0,s:$t,f:28,p:64,e:0,r:60*30},{i:u.infoID.indexOf("info_display"),v:[0,0,0,0,0]}]},Ts={a:u.actionID.indexOf("sync"),t:[{i:u.getPrefID("net_alert"),v:1},{i:u.getPrefID("ui_bright"),v:0,x:5},{i:u.getPrefID("ui_sound"),v:1},{i:u.getPrefID("tap_mode"),v:0},{i:u.getPrefID("tap_tilt"),v:1},{i:u.getPrefID("tap_alert"),v:0},{i:u.getPrefID("tap"),v:7,t:1023},{i:u.getPrefID("gps_alert"),v:0},{i:u.getPrefID("gps_log_int"),v:1200},{i:u.getPrefID("clock_static"),v:1},{i:u.getPrefID("clock_disp"),v:u.clockID.indexOf("CLOCK_HHMM")},{i:u.getPrefID("clock_24h"),v:0},{i:u.getPrefID("clock_tz"),v:-6},{i:u.getPrefID("clock_dst"),v:1},{i:u.getPrefID("clock_pps"),v:0},{i:u.getPrefID("daily"),v:1,h:9,m:32},{i:u.getPrefID("daily_vol"),v:1},{i:u.getPrefID("daily_ind"),v:1},{i:u.getPrefID("daily_snooze"),v:1},{i:u.getPrefID("ux_index"),v:u.uxID.indexOf("clock_static")}]};u.infoID.indexOf("info_gps_log"),$t-200;const Es={a:u.actionID.indexOf("info"),t:[{i:u.infoID.indexOf("info_display"),v:[127,127,127,127,2]}]},Ss={a:u.actionID.indexOf("info"),t:[{i:u.infoID.indexOf("info_display"),v:[120,121,109,120,0]}]},Ps={a:u.actionID.indexOf("call"),t:[{i:u.callID.indexOf("call_prime"),v:0}]};function $s(){const s=D.prop.local?500:75;setTimeout(async()=>{if(x.ready())return;D.open(),console.log("%ccomm test",et.style.test,"info + sync");const e=new CustomEvent("meh");e.data=JSON.stringify(Is),x.parse(e),e.data=JSON.stringify(Ts),x.parse(e),await B.delay(75),e.data=JSON.stringify(Ps),x.parse(e)},s),setTimeout(()=>{if(x.ready())return;console.log("%ccomm test",et.style.test,"display");const e=new CustomEvent("meh");e.data=JSON.stringify(Es),x.parse(e)},s*2),setTimeout(()=>{if(x.ready())return;const e=new CustomEvent("meh");e.data=JSON.stringify(Ss),x.parse(e)},s*3)}var As={init:$s};let mt;function Cs(){document.body.insertAdjacentHTML("beforeend",'<svg height="0" width="0" style="visibility: hidden"></svg>'),mt=document.body.lastChild}function Ms(s,e){mt.insertAdjacentHTML("beforeend",'<symbol id="" viewBox="0 0 100 100"></symbol>'),mt.lastChild.id="sym_"+s,mt.lastChild.innerHTML=e}function Rs(s){mt.insertAdjacentHTML("beforeend",s)}Cs();var y={add:Ms,def:Rs};function Os(){y.add("warn_ui",`<g stroke-width="12" stroke-linecap="round" stroke-linejoin="round" >  
      <polygon stroke="var(--icon-fg)" fill="var(--icon-fg)" points="50 12.69 7.5 86.31 92.5 86.31 50 12.69" />
      <g>
        <polyline stroke="var(--icon-bg)" fill="none" points="50 55 50 32" />
        <circle fill="var(--icon-bg)" stroke="none" cx="50" cy="78" r="7" />
      </g>    
    </g>`),y.add("warn_text",`<g stroke="var(--icon-fg)" fill="none">
      <path stroke-width="6px" stroke-linejoin="round" d="M66,91.39H90.59A6.2,6.2,0,0,0,96,82.08L55.37,11.78a6.2,6.2,0,0,0-10.74,0L4,82.08a6.2,6.2,0,0,0,5.37,9.31H34" />    
      <polyline stroke-width="14px" points="50 73 50 55.5 50 38" />
      <polyline stroke-width="14px" points="50 94.5 50 80.5" />
    </g>`),y.add("hit",`<defs>
      <radialGradient id="grad">
        <stop offset="0%" stop-color="rgb(0,0,0,1)" />
        <stop offset="33%" stop-color="rgb(0,0,0,0.3)" />
        <stop offset="90%" stop-color="transparent" />
      </radialGradient>
    </defs>
    <g transform="translate(50 50)">
      <circle fill="url('#grad')" stroke-width="4px" stroke="var(--icon-bg)" cx="0" cy="0" r="48" />
    </g>`),y.add("halo",`<g transform="translate(50 50)">
      <circle fill="none" stroke-width="4px" stroke="var(--icon-fg)" cx="0" cy="0" r="48" />
    </g>`),y.add("show",`<g fill="var(--icon-fg)">
      <path d="M100,50C89.32,65.16,69,78,50,78S10.68,65.16,0,50C10.68,34.84,31,22,50,22S89.32,34.84,100,50ZM50,31A19,19,0,1,0,69,50,19,19,0,0,0,50,31Zm0,9A10,10,0,1,0,60,50,10,10,0,0,0,50,40Z" />
    </g>`),y.add("hide",`<g fill="var(--icon-fg)" stroke="none">
      <path d="M100,50C89.32,65.16,69,78,50,78S10.68,65.16,0,50C10.68,34.84,31,22,50,22S89.32,34.84,100,50ZM89.82,50C79.39,38.17,63.45,30,50,30S20.62,38.17,10.19,50C20.62,61.83,36.55,70,50,70S79.39,61.83,89.82,50Z" />
      <circle cx="50" cy="50" r="14" />
    </g>
    <g stroke-linecap="butt" transform="translate(50 50) rotate(45)">
      <line stroke="var(--icon-bg)" stroke-width="16" x1="-40" y1="0" x2="40" y2="0" />
      <line stroke="var(--icon-fav)" stroke-width="5" x1="-50" y1="0" x2="50" y2="0" />
    </g>`),y.add("wifi_def",`<g fill="none">
      <circle stroke="var(--icon-fg)" stroke-width="16" cx="0" cy="0" r="8"></circle>
      <circle stroke="var(--icon-fg)" stroke-width="8" cx="0" cy="0" r="32"></circle>
      <circle stroke="var(--icon-fg)" stroke-width="8" cx="0" cy="0" r="52"></circle>
   </g>`),y.add("wifi",`<g transform="translate(50, 84) rotate(-135) scale(1.25)">
      <use href="#sym_wifi_def" />
    </g>`),y.add("info",`<g stroke="var(--icon-fg)" fill="none">
      <circle stroke-width="5" cx="50" cy="50" r="47.5"></circle>
      <g stroke-width="16" transform="translate(11) skewX(-12)">
        <line x1="50" y1="82" x2="50" y2="44" />
        <line x1="50" y1="34" x2="50" y2="18" />
      </g>
    </g>`),y.add("help",`<g transform="translate(50 50)" stroke="none">
      <path d="M8.6,33.2H-8.6V23.6H8.6Zm12-60.4H-20.6c-5,0-10.3,3.6-10.3,8.3v8.8h16.5v-10H14.4v18H.7c-5.6,0-9.3,3.5-9.3,9.4v9.1H8.6V7.9c0-2.7,1-3.3,3.7-3.3h8.3C25.2,4.6,30.9.8,30.9-4V-18.9C30.9-23.6,25.6-27.2,20.6-27.2Z" /> 
    </g>`),y.add("help_button",`<g>
      <use href="#sym_halo" />
      <use href="#sym_help" />
    </g>`),y.add("tap",`<g>
      <polygon fill="var(--icon-fg)" stroke="none" points="86.76 0 66.96 0 49.87 17.09 32.84 0 13.08 0 49.85 36.91 86.76 0" />
      <g stroke="var(--icon-fg)">
        <line stroke-width="14px" y1="50" x2="100" y2="50" />
        <g stroke-width="10px" >
          <line class="cls-3" x1="50" y1="100" x2="50" y2="77" />
          <line class="cls-3" x1="14.64" y1="85.36" x2="30.91" y2="69.09" />
          <line class="cls-3" x1="85.36" y1="85.36" x2="69.09" y2="69.09" />
        </g>
      </g>
    </g>`),y.add("twirl",`<g fill="var(--icon-fg)" stroke="none">
    <polygon points="0,88 100,88 50,0"/>
  </g>`),y.add("refresh",`<g stroke="var(--icon-fg)" transform="translate(50 50)" fill="none" style="stroke-miterlimit:10;">
      <polyline points="3.536 52.75 19.036 37.25 34.536 52.75" transform="translate(-49.75 -48)" />
      <path d="M0-31A31,31,0,0,1,31,0,31,31,0,0,1,0,31,31,31,0,0,1-31,0a31.041,31.041,0,0,1,1.206-8.593" />
    </g>`),y.add("refresh_run",`<g stroke="var(--icon-fg)" transform="translate(50 50)" fill="none" style="stroke-miterlimit:10;">
      <path d="M0-31A31,31,0,0,1,31,0,31,31,0,0,1,0,31,31,31,0,0,1-31,0a31.041,31.041,0,0,1,1.206-8.593" />
    </g>`),y.add("undo",`<g transform="scale(-1 1) translate(-100 0)" stroke="var(--icon-fg)" stroke-width="8" fill="none">
      <polyline points="46.21 53.21 30 37 46.21 20.79" />
      <path d="M33,79H60.48a21,21,0,1,0,0-42H30" />
      <line x1="18" y1="18" x2="18" y2="56" />
    </g>`),y.add("dot",`<g transform="translate(50, 50)">
      <circle fill="var(--icon-fg)" cx="0" cy="0" r="50"></circle>
    </g>`),y.add("o",`<g transform="translate(50, 50)">
      <circle stroke="var(--icon-fg)" stroke-width="22" fill="none" cx="0" cy="0" r="39"></circle>
    </g>`),y.add("x",`<g stroke="var(--icon-fg)" stroke-width="22">
        <line x1="12" y1="12" x2="88" y2="88"></line>
        <line x1="12" y1="88" x2="88" y2="12"></line>
    </g>`),y.add("bar_1",`<g transform="translate(0, 0)">
      <line stroke="var(--icon-fg)" stroke-width="22" x1="50" y1="0" x2="50" y2="100"></line>
    </g>`),y.add("bar_2",`<g stroke="var(--icon-fg)" stroke-width="22" transform="translate(0, 0)">
      <line x1="20" y1="0" x2="20" y2="100"></line>
      <line x1="80" y1="0" x2="80" y2="100"></line>
    </g>`),y.add("vol_wave_0",`<g transform="translate(0, 0)">
      <g transform="scale(0.5) translate(100, 50)">
        <use href="#sym_x" />
      </g>
    </g>`),y.add("vol_wave_1",`<g transform="translate(0, 0)">
      <path stroke="var(--icon-fg)" stroke-width="10" fill="none" d="M62.7,31.63a28.5,28.5,0,0,1-.45,36.29"/>
     </g>`),y.add("vol_wave_2",`<g transform="translate(0, 0)">
      <use href="#sym_vol_wave_1" />
      <path stroke="var(--icon-fg)" stroke-width="12" fill="none" d="M80.21,14.44a52.94,52.94,0,0,1-.06,71.07"/>
     </g >`),y.add("lock",`<g>
      <path transform="translate(62 55)" stroke-width="12" stroke="var(--icon-fg)" fill="none" d="M-20,0V-22c0-12.15,8.954-22,20-22H0c11.046,0,20,9.85,20,22V0"/>
      <rect fill="var(--icon-fg)" stroke="none" x="25" y="50" width="75" height="50" />
      </g>`),y.add("unlock",`<g>
      <path transform="translate(25 50)" stroke-width="12" stroke="var(--icon-fg)" fill="none" d="M-20,0V-22c0-12.15,8.954-22,20-22H0c11.046,0,20,9.85,20,22V0"/>
      <rect fill="var(--icon-fg)" stroke="none" x="25" y="50" width="75" height="50" />
    </g>`),y.add("bell",`<g transform="translate(5 10)" stroke-width="10" stroke="var(--icon-fg)" fill="none">
      <g transform="translate(-7 -9.73)">
        <path d="M60.59,74a11,11,0,1,1-21.18,0Z" />
        <path d="M79,73,68.5,33.16C67.31,29,63.94,26,59.7,26H40.63a9.42,9.42,0,0,0-8.8,7.12L21.33,73" />
      </g>
      <line x1="43" y1="19.31" x2="43" />
      <line y1="63.27" x2="86" y2="63.27" />
    </g>`),y.add("tna_hex",`<g stroke="var(--icon-fg)" fill="none">
        <polygon points="88.97 72.5 50 95 11.03 72.5 11.03 27.5 50 5 88.97 27.5 88.97 72.5" />
    </g>`),y.add("tna_n",`<g stroke="var(--icon-fg)" fill="none">
        <polyline stroke-linecap="round" stroke-linejoin="round" points="28.71 61.84 28.71 38.16 71.29 61.84 71.29 38.16" />
    </g>`),y.add("tna",`<g>
      <use href="#sym_tna_hex" />
      <use href="#sym_tna_n" />
    </g>`),y.add("warn_tna",`<g fill="var(--icon-fg)" stroke="none" transform="translate(50, 50)">
      <path d="M-17-25.7l-8.2-14.2,4.7-2.7h41l4.7,2.7L17-25.7l16.5,9.5,8.2-14.2L50-25.6l-24.8,43H9.5v-30h-19v30H-25.2L-50-25.6l8.3-4.8,8.2,14.2Zm22.5,52h-11l-9.4,16.3H14.9Z"/>
    </g>`)}Os();function Fs(){y.add("clock",`<g transform="translate(50, 50)">
      <circle stroke="none"  fill="var(--icon-fg)" cx="0" cy="0" r="50"></circle>
      <path d="M0,-40 v40 l26,15" stroke="var(--icon-bg)" stroke-width="10" fill="none"/>
    </g>`)}Fs();const Bs=`<div id="region" class="region">
    <div id="bg" class="bg">
      <div id="action" class="action"></div>
    </div>
    <div id="label_wrap" class="label_wrap">
      <div id="label" class="label"></div>
    </div>
    <div id="status_wrap" class="status_wrap">
      <div id="status" class="status"></div>
      <div id="status_icon" class="status_icon"></div>
    </div>
  </div>`;class Vt extends dt{constructor(t,i="pref"){super(t);l(this,"_label");l(this,"_status");l(this,"iStatus");l(this,"onExecute");this.link(i),this.div.insertAdjacentHTML("beforeend",Bs),this.div.classList.add("tna_Button","disable"),this.dRegion=this.getDiv("region"),this.dBg=this.getDiv("bg"),this.dAction=this.getDiv("action"),this.dLabel=this.getDiv("label_wrap"),this.dLabelVal=this.getDiv("label"),this.dStatusW=this.getDiv("status_wrap"),this.dStatus=this.getDiv("status"),this.dIconStatus=this.getDiv("status_icon"),this.label=this.getDataAttr("label","string",""),this.enable(this.div.dataset.enable!=null)}icon(){this.dStatus.classList.add("alt");const t=new wt(this.dIconStatus).static().prime();return this.iStatus=t,this}enable(t=!0){if(t!=this._enable)return this._enable=t,this.enablePrime(),this}async enablePrime(){this._enable||(this.div.onclick=null);const t=500;this.div.classList.toggle("disable",!this._enable),this.dRegion.style.transition=t+"ms",await this.delay(t),this.dRegion.style="",this._enable&&(this.div.onclick=this.execute.bind(this))}execute(t){t.preventDefault(),t.stopImmediatePropagation();let i;this.onExecute!=null&&(i=this.onExecute(this)),i=i==null?!0:i,i&&this.confirm()}confirm(){this.div.classList.add("confirm"),this.dAction.onanimationend=this.confirmEnd.bind(this)}confirmEnd(t){this.div.classList.remove("confirm"),this.dAction.onanimationend=void 0}shuffleIcon(t=!0){const i=t?"beforeend":"afterbegin";return this.dStatusW.insertAdjacentElement(i,this.dIconStatus),this.dStatus.classList.toggle("alt",t),this}displayIcon(t=!0){return this.iStatus.display(t),this.dStatus.classList.toggle("alt",t),this}set label(t){this._label=t,this.dLabelVal.innerHTML=t}set status(t){this._status=t,this.dStatus.innerHTML=t}}class Hs extends wt{constructor(t,i,n=4){super(t);l(this,"_count");l(this,"_inMin",-83);l(this,"_inMax",-45);l(this,"_out");this.link(i),this._count=n,this.div.classList.add("tna_RSSI"),this.setProp("--rssi-n",n)}init(){this.bars=this.div;for(let t=1;t<=5;t++)this.bars=this.bars.firstElementChild;this.bars=this.bars.children,this.index=0}draw(){const t=this._out;for(let i=0;i<this._count;i++)this.bars[i].classList.toggle("lit",i<t&&t!=0)}set value(t){this._out=t!=0?Math.round(this.range(t,this._inMin,this._inMax,0,this._count)):0,super.value=t,this.draw()}get value(){return super.value}warn(t=!0){return this.div.classList.toggle("warn",t),this}map(t,i){return this._inMin=t,this._inMax=i,this}range(t,i,n,c,v){const g=c+(v-c)*(t-i)/(n-i),_=Math.min(g,v);return Math.max(1,_)}}var Oe={exports:{}};(function(s,e){(function(t){s.exports=t()})(function(t){var i=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function n(f,h){var o=f[0],a=f[1],d=f[2],r=f[3];o+=(a&d|~a&r)+h[0]-680876936|0,o=(o<<7|o>>>25)+a|0,r+=(o&a|~o&d)+h[1]-389564586|0,r=(r<<12|r>>>20)+o|0,d+=(r&o|~r&a)+h[2]+606105819|0,d=(d<<17|d>>>15)+r|0,a+=(d&r|~d&o)+h[3]-1044525330|0,a=(a<<22|a>>>10)+d|0,o+=(a&d|~a&r)+h[4]-176418897|0,o=(o<<7|o>>>25)+a|0,r+=(o&a|~o&d)+h[5]+1200080426|0,r=(r<<12|r>>>20)+o|0,d+=(r&o|~r&a)+h[6]-1473231341|0,d=(d<<17|d>>>15)+r|0,a+=(d&r|~d&o)+h[7]-45705983|0,a=(a<<22|a>>>10)+d|0,o+=(a&d|~a&r)+h[8]+1770035416|0,o=(o<<7|o>>>25)+a|0,r+=(o&a|~o&d)+h[9]-1958414417|0,r=(r<<12|r>>>20)+o|0,d+=(r&o|~r&a)+h[10]-42063|0,d=(d<<17|d>>>15)+r|0,a+=(d&r|~d&o)+h[11]-1990404162|0,a=(a<<22|a>>>10)+d|0,o+=(a&d|~a&r)+h[12]+1804603682|0,o=(o<<7|o>>>25)+a|0,r+=(o&a|~o&d)+h[13]-40341101|0,r=(r<<12|r>>>20)+o|0,d+=(r&o|~r&a)+h[14]-1502002290|0,d=(d<<17|d>>>15)+r|0,a+=(d&r|~d&o)+h[15]+1236535329|0,a=(a<<22|a>>>10)+d|0,o+=(a&r|d&~r)+h[1]-165796510|0,o=(o<<5|o>>>27)+a|0,r+=(o&d|a&~d)+h[6]-1069501632|0,r=(r<<9|r>>>23)+o|0,d+=(r&a|o&~a)+h[11]+643717713|0,d=(d<<14|d>>>18)+r|0,a+=(d&o|r&~o)+h[0]-373897302|0,a=(a<<20|a>>>12)+d|0,o+=(a&r|d&~r)+h[5]-701558691|0,o=(o<<5|o>>>27)+a|0,r+=(o&d|a&~d)+h[10]+38016083|0,r=(r<<9|r>>>23)+o|0,d+=(r&a|o&~a)+h[15]-660478335|0,d=(d<<14|d>>>18)+r|0,a+=(d&o|r&~o)+h[4]-405537848|0,a=(a<<20|a>>>12)+d|0,o+=(a&r|d&~r)+h[9]+568446438|0,o=(o<<5|o>>>27)+a|0,r+=(o&d|a&~d)+h[14]-1019803690|0,r=(r<<9|r>>>23)+o|0,d+=(r&a|o&~a)+h[3]-187363961|0,d=(d<<14|d>>>18)+r|0,a+=(d&o|r&~o)+h[8]+1163531501|0,a=(a<<20|a>>>12)+d|0,o+=(a&r|d&~r)+h[13]-1444681467|0,o=(o<<5|o>>>27)+a|0,r+=(o&d|a&~d)+h[2]-51403784|0,r=(r<<9|r>>>23)+o|0,d+=(r&a|o&~a)+h[7]+1735328473|0,d=(d<<14|d>>>18)+r|0,a+=(d&o|r&~o)+h[12]-1926607734|0,a=(a<<20|a>>>12)+d|0,o+=(a^d^r)+h[5]-378558|0,o=(o<<4|o>>>28)+a|0,r+=(o^a^d)+h[8]-2022574463|0,r=(r<<11|r>>>21)+o|0,d+=(r^o^a)+h[11]+1839030562|0,d=(d<<16|d>>>16)+r|0,a+=(d^r^o)+h[14]-35309556|0,a=(a<<23|a>>>9)+d|0,o+=(a^d^r)+h[1]-1530992060|0,o=(o<<4|o>>>28)+a|0,r+=(o^a^d)+h[4]+1272893353|0,r=(r<<11|r>>>21)+o|0,d+=(r^o^a)+h[7]-155497632|0,d=(d<<16|d>>>16)+r|0,a+=(d^r^o)+h[10]-1094730640|0,a=(a<<23|a>>>9)+d|0,o+=(a^d^r)+h[13]+681279174|0,o=(o<<4|o>>>28)+a|0,r+=(o^a^d)+h[0]-358537222|0,r=(r<<11|r>>>21)+o|0,d+=(r^o^a)+h[3]-722521979|0,d=(d<<16|d>>>16)+r|0,a+=(d^r^o)+h[6]+76029189|0,a=(a<<23|a>>>9)+d|0,o+=(a^d^r)+h[9]-640364487|0,o=(o<<4|o>>>28)+a|0,r+=(o^a^d)+h[12]-421815835|0,r=(r<<11|r>>>21)+o|0,d+=(r^o^a)+h[15]+530742520|0,d=(d<<16|d>>>16)+r|0,a+=(d^r^o)+h[2]-995338651|0,a=(a<<23|a>>>9)+d|0,o+=(d^(a|~r))+h[0]-198630844|0,o=(o<<6|o>>>26)+a|0,r+=(a^(o|~d))+h[7]+1126891415|0,r=(r<<10|r>>>22)+o|0,d+=(o^(r|~a))+h[14]-1416354905|0,d=(d<<15|d>>>17)+r|0,a+=(r^(d|~o))+h[5]-57434055|0,a=(a<<21|a>>>11)+d|0,o+=(d^(a|~r))+h[12]+1700485571|0,o=(o<<6|o>>>26)+a|0,r+=(a^(o|~d))+h[3]-1894986606|0,r=(r<<10|r>>>22)+o|0,d+=(o^(r|~a))+h[10]-1051523|0,d=(d<<15|d>>>17)+r|0,a+=(r^(d|~o))+h[1]-2054922799|0,a=(a<<21|a>>>11)+d|0,o+=(d^(a|~r))+h[8]+1873313359|0,o=(o<<6|o>>>26)+a|0,r+=(a^(o|~d))+h[15]-30611744|0,r=(r<<10|r>>>22)+o|0,d+=(o^(r|~a))+h[6]-1560198380|0,d=(d<<15|d>>>17)+r|0,a+=(r^(d|~o))+h[13]+1309151649|0,a=(a<<21|a>>>11)+d|0,o+=(d^(a|~r))+h[4]-145523070|0,o=(o<<6|o>>>26)+a|0,r+=(a^(o|~d))+h[11]-1120210379|0,r=(r<<10|r>>>22)+o|0,d+=(o^(r|~a))+h[2]+718787259|0,d=(d<<15|d>>>17)+r|0,a+=(r^(d|~o))+h[9]-343485551|0,a=(a<<21|a>>>11)+d|0,f[0]=o+f[0]|0,f[1]=a+f[1]|0,f[2]=d+f[2]|0,f[3]=r+f[3]|0}function c(f){var h=[],o;for(o=0;o<64;o+=4)h[o>>2]=f.charCodeAt(o)+(f.charCodeAt(o+1)<<8)+(f.charCodeAt(o+2)<<16)+(f.charCodeAt(o+3)<<24);return h}function v(f){var h=[],o;for(o=0;o<64;o+=4)h[o>>2]=f[o]+(f[o+1]<<8)+(f[o+2]<<16)+(f[o+3]<<24);return h}function g(f){var h=f.length,o=[1732584193,-271733879,-1732584194,271733878],a,d,r,S,U,K;for(a=64;a<=h;a+=64)n(o,c(f.substring(a-64,a)));for(f=f.substring(a-64),d=f.length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a=0;a<d;a+=1)r[a>>2]|=f.charCodeAt(a)<<(a%4<<3);if(r[a>>2]|=128<<(a%4<<3),a>55)for(n(o,r),a=0;a<16;a+=1)r[a]=0;return S=h*8,S=S.toString(16).match(/(.*?)(.{0,8})$/),U=parseInt(S[2],16),K=parseInt(S[1],16)||0,r[14]=U,r[15]=K,n(o,r),o}function _(f){var h=f.length,o=[1732584193,-271733879,-1732584194,271733878],a,d,r,S,U,K;for(a=64;a<=h;a+=64)n(o,v(f.subarray(a-64,a)));for(f=a-64<h?f.subarray(a-64):new Uint8Array(0),d=f.length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a=0;a<d;a+=1)r[a>>2]|=f[a]<<(a%4<<3);if(r[a>>2]|=128<<(a%4<<3),a>55)for(n(o,r),a=0;a<16;a+=1)r[a]=0;return S=h*8,S=S.toString(16).match(/(.*?)(.{0,8})$/),U=parseInt(S[2],16),K=parseInt(S[1],16)||0,r[14]=U,r[15]=K,n(o,r),o}function b(f){var h="",o;for(o=0;o<4;o+=1)h+=i[f>>o*8+4&15]+i[f>>o*8&15];return h}function E(f){var h;for(h=0;h<f.length;h+=1)f[h]=b(f[h]);return f.join("")}E(g("hello")),typeof ArrayBuffer!="undefined"&&!ArrayBuffer.prototype.slice&&function(){function f(h,o){return h=h|0||0,h<0?Math.max(h+o,0):Math.min(h,o)}ArrayBuffer.prototype.slice=function(h,o){var a=this.byteLength,d=f(h,a),r=a,S,U,K,ne;return o!==t&&(r=f(o,a)),d>r?new ArrayBuffer(0):(S=r-d,U=new ArrayBuffer(S),K=new Uint8Array(U),ne=new Uint8Array(this,d,S),K.set(ne),U)}}();function p(f){return/[\u0080-\uFFFF]/.test(f)&&(f=unescape(encodeURIComponent(f))),f}function k(f,h){var o=f.length,a=new ArrayBuffer(o),d=new Uint8Array(a),r;for(r=0;r<o;r+=1)d[r]=f.charCodeAt(r);return h?d:a}function L(f){return String.fromCharCode.apply(null,new Uint8Array(f))}function T(f,h,o){var a=new Uint8Array(f.byteLength+h.byteLength);return a.set(new Uint8Array(f)),a.set(new Uint8Array(h),f.byteLength),o?a:a.buffer}function m(f){var h=[],o=f.length,a;for(a=0;a<o-1;a+=2)h.push(parseInt(f.substr(a,2),16));return String.fromCharCode.apply(String,h)}function w(){this.reset()}return w.prototype.append=function(f){return this.appendBinary(p(f)),this},w.prototype.appendBinary=function(f){this._buff+=f,this._length+=f.length;var h=this._buff.length,o;for(o=64;o<=h;o+=64)n(this._hash,c(this._buff.substring(o-64,o)));return this._buff=this._buff.substring(o-64),this},w.prototype.end=function(f){var h=this._buff,o=h.length,a,d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r;for(a=0;a<o;a+=1)d[a>>2]|=h.charCodeAt(a)<<(a%4<<3);return this._finish(d,o),r=E(this._hash),f&&(r=m(r)),this.reset(),r},w.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},w.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},w.prototype.setState=function(f){return this._buff=f.buff,this._length=f.length,this._hash=f.hash,this},w.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},w.prototype._finish=function(f,h){var o=h,a,d,r;if(f[o>>2]|=128<<(o%4<<3),o>55)for(n(this._hash,f),o=0;o<16;o+=1)f[o]=0;a=this._length*8,a=a.toString(16).match(/(.*?)(.{0,8})$/),d=parseInt(a[2],16),r=parseInt(a[1],16)||0,f[14]=d,f[15]=r,n(this._hash,f)},w.hash=function(f,h){return w.hashBinary(p(f),h)},w.hashBinary=function(f,h){var o=g(f),a=E(o);return h?m(a):a},w.ArrayBuffer=function(){this.reset()},w.ArrayBuffer.prototype.append=function(f){var h=T(this._buff.buffer,f,!0),o=h.length,a;for(this._length+=f.byteLength,a=64;a<=o;a+=64)n(this._hash,v(h.subarray(a-64,a)));return this._buff=a-64<o?new Uint8Array(h.buffer.slice(a-64)):new Uint8Array(0),this},w.ArrayBuffer.prototype.end=function(f){var h=this._buff,o=h.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],d,r;for(d=0;d<o;d+=1)a[d>>2]|=h[d]<<(d%4<<3);return this._finish(a,o),r=E(this._hash),f&&(r=m(r)),this.reset(),r},w.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},w.ArrayBuffer.prototype.getState=function(){var f=w.prototype.getState.call(this);return f.buff=L(f.buff),f},w.ArrayBuffer.prototype.setState=function(f){return f.buff=k(f.buff,!0),w.prototype.setState.call(this,f)},w.ArrayBuffer.prototype.destroy=w.prototype.destroy,w.ArrayBuffer.prototype._finish=w.prototype._finish,w.ArrayBuffer.hash=function(f,h){var o=_(new Uint8Array(f)),a=E(o);return h?m(a):a},w})})(Oe);var Ns=Oe.exports;const Fe={};let Ot;async function zs(){await x.fill(Fe,"/update-fill",Xs)}async function Ws(){const s=new FormData;s.append("stage","prime");let e=await fetch("/ota-prime",{method:"POST",body:s});if(e.status==200)e=await e.text();else throw new Error(`ota prime FAIL fetch code${e.status}`);if(console.log(`ota prime, response = "${e}"`),e.length==0)throw new Error("ota prime FAIL no text")}async function Vs(s,e){console.log(`ota upload "${s.name}" flash:${e} ${Ot}`);const t=new FormData;t.append("MD5",Ot),t.append("total",s.size),t.append("flash",e),t.append("file",s,s.name);let i=await fetch("/ota",{method:"POST",body:t}),n;if(i.status==200)n=await i.text();else throw new Error("ota upload FAIL fetch");if(console.log(`ota upload, response = "${n}"`),n.length==0)throw new Error("ota upload FAIL no text");if(n!=="OK")throw new Error("ota upload FAIL upload response")}function js(s){return new Promise((e,t)=>{const i=File.prototype.slice,n=2097152,c=new Ns.ArrayBuffer,v=new FileReader;v.readAsArrayBuffer(i.call(s,0,n)),v.onload=function(g){c.append(g.target.result),Ot=c.end(),e(Ot)},v.onerror=function(){t("generateMD5 FAIL squished blob")}})}var ot={prop:Fe,fill:zs,prime:Ws,upload:Vs,calcMD5:js};const Us=Math.floor(new Date().getTime()/1e3),Xs={ota_version:"2.3.14",ota_version_fs:"1.3.14",ota_time:Us-3600*24,ota_time_fs:1647296040};function Be(s){return{days:Math.floor(s/(3600*24)),hours:Math.floor(s%(3600*24)/3600),minutes:Math.floor(s%3600/60),seconds:Math.floor(s%60)}}function Gs(s){const e=Be(s);return sprintf("%ih%02im%02is",e.hours,e.minutes,e.seconds)}function He(s,e=!0){let t={};return s>=3600?(t.v=`${Math.round(s/3600)}`,t.u=e?"h":"hr"):s>60?(t.v=`${Math.round(s/60)}`,t.u=e?"m":"min"):(t.v=`${s}`,t.u=e?"s":"sec"),t}function Zs(s){return He(s,!1)}function se(s){const e=s!=null?new Date(s*1e3):new Date,t=String(e.getFullYear()).slice(-2);return sprintf("%s.%02i.%02i",t,e.getMonth()+1,e.getDate())}function Ne(s){const e=s!=null?new Date(s*1e3):new Date;return sprintf("%02i:%02i:%02i",e.getHours(),e.getMinutes(),e.getSeconds())}function ze(s){const e=s!=null?new Date(s*1e3):new Date,t=e.getHours(),i=t%12,n=t<=11||t==0?"A":"P";return sprintf("%2i:%02i%s",i,e.getMinutes(),n)}function Ys(s){return`${se(s)} ${Ne(s)}`}function qs(s){return`${se(s)} ${ze(s)}`}const Js=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Ks=["January","February","March","April","May","June","July","August","September","October","November","December"];function kt(s,e=!0){let t;if(e){const i=s.getHours()%12;t=sprintf("%u:%02u ",i==0?12:i,s.getMinutes()),t+=s.getHours()>=12?"PM":"AM"}else t=sprintf("%u:%02u ",s.getHours(),s.getMinutes());return t}function Qs(s,e=!1){const t=s!=null?new Date(s*1e3):new Date,i=new Date,n=Ks[t.getMonth()].slice(0,e?3:void 0),c=Js[t.getDay()].slice(0,e?3:void 0),g=i.toLocaleTimeString().match(/AM|PM|am|pm|a.m.|p.m./),_=g!=null?g.length>0:!1,b=new Date;b.setHours(-24*6,0,0,0);const E=new Date;E.setHours(-24,0,0,0);const p=new Date;p.setHours(0,0,0,0);let k="unset";const L=t.getTime();return L>p.getTime()?k="Today at "+kt(t,_):L>E.getTime()?k="Yesterday at "+kt(t,_):L>b.getTime()?k=`${c}, ${kt(t,_)}`:(k=`${n} ${t.getDate()}, `,k+=t.getFullYear()==i.getFullYear()?kt(t,_):t.getFullYear()),k}var tn={durationObject:Be,durationString:Gs,durationFormat:He,durationFormatLong:Zs,dateString:se,timeString:Ne,timeString12h:ze,timeStringLong:Ys,timeStringLong12h:qs,relative:Qs};const en=`
  <g fill="none">
    <circle stroke-width="18" r="8"></circle>
    <circle stroke-width="10" r="32"></circle>
    <circle stroke-width="10" r="52"></circle>
  </g>
  <g id="caution" class="caution">
    <polyline stroke-width="15" points="20 20 46 46"></circle>
  </g>`;class sn extends Hs{constructor(e,t){super(e,t,3),this.div.classList.add("tna_RSSI_Wave"),this.add=en,super.init(),this.dCaution=this.getDiv("caution")}draw(){super.draw()}}const nn=`<g class="shape" transform="translate(-50 -50)">
    <polyline points="25,100 75,50 25,0" />
  </g>`;class Ft extends Ht{constructor(t){super(t);l(this,"_duration");l(this,"_count",0);this.div.classList.add("tna_Tread"),this.duration=this.getPropVal("--tread-t"),this.count=this.getPropVal("--tread-n"),this.getProp("--tread-fade").indexOf("in")>=0&&this.div.classList.add("fadeIn"),this.value=0}set count(t){this.clear();for(let i=0;i<t;i++){this.add=nn;const n=this.list[this.list.length-1],c=-(i/t)*this._duration;n.style.animationDelay=c+"s",n._tna_id=i,n.onanimationiteration=this.iterate.bind(this)}this.translate(50,50),this.scale(.88),this.update()}set duration(t){this._duration=t,this.div.style.setProperty("--tread-t",t+"s")}show(t=!1){this._val=!0,t&&(this.dWrap.onanimationend=void 0,this.div.classList.remove("hide")),this.div.classList.add("show","run")}hide(){this._val=!1,this.div.classList.remove("show"),this.div.classList.add("hide"),this.dWrap.onanimationend=t=>{t.animationName=="tna_Tread_hide"&&this.div.classList.remove("run","hide"),this.dWrap.onanimationend=void 0}}toggle(t){this._val=t==null?!this._val:t,this._val?this.show():this.hide()}iterate(t){t.animationName=="tna_Tread_move"&&this._count++}}const an=`<div id="region" class="region">
    <input id="input" type="file" accept=".bin" hidden />
    <div id="bar_region" class="bar">
      <div id="bar_fill" class="fill">
        <div id="tread" class="tread"></div>
      </div>
    </div>
    <div id="divot" class="divot prime"></div>
    <div id="prompt" class="info prompt _dmm"></div>
    <div id="info" class="contain_info">
      <div id="size" class="size"></div>
      <div id="hash" class="info hash _dmm"></div>
      <div id="cat" class="info cat _dmm"></div>
    </div>
    <div id="select" class="select _dmm"></div>
    <div id="label" class="label _dmm"></div>
    <div id="result" class="result">
      <div class="halo svg_wrap">
        <svg viewBox="0 0 100 100">
          <g transform="translate(50 50)">
            <g class="spin">
              <circle cx="0" cy="0" r="45" />
            </g>
          </g>
        </svg>
      </div>
      <div class="fail seq_wrap">
        <div class="fail_L chevron svg_wrap">
          <svg viewBox="0 0 100 100">
            <g class="wrap">
              <g transform="translate(70 50)">
                <g class="art">
                  <polyline points="25 100 75 50 25 0" />
                </g>
              </g>
            </g>
          </svg>
        </div>
        <div class="fail_R chevron svg_wrap">
          <svg viewBox="0 0 100 100">
            <g class="wrap">
              <g transform="translate(30 50) rotate(180)">
                <g class="art">
                  <polyline points="25 100 75 50 25 0" />
                </g>
              </g>
            </g>
          </svg>
        </div>
      </div>
      <div class="pass seq_wrap">
        <div class="check svg_wrap _dmm">
          <svg viewBox="0 0 100 100">
            <polygon
              points="100 0 45.4 100 27.2 100 0 54 25.0 54 36.3 82.2 69.7 0 100 0"
            />
          </svg>
        </div>
      </div>
      <div id="result_msg" class="msg"></div>
    </div>
    <div id="zone" class="zone"></div>
    <div id="reset"></div>
  </div>`,on=`<g fill="var(--icon-fg)">
    <path d="M100,50A50,50,0,1,1,50,0,50,50,0,0,1,100,50ZM87.5,41h-75V59h75Z" />
  </g>`;var le={HTML:an,RESET:on};const At=[{id:"firmware",val:0},{id:"littlefs",val:100},{id:"system",val:0},{id:"interface",val:100}],P=Object.freeze({IDLE:0,START:1,READY:2,RUN:3,FINISH:4,FAIL:5});class rn extends dt{constructor(t){super(t);l(this,"_hash");l(this,"_valid",!1);l(this,"_file");l(this,"_flash");l(this,"tnaTread");l(this,"onValidate");this.div.insertAdjacentHTML("beforeend",le.HTML),this.rootClass="tna_Drop",this.div.classList.add(this.rootClass),this.dInput=this.getDiv("input"),this.dRegion=this.getDiv("region"),this.dDivot=this.getDiv("divot"),this.dZone=this.getDiv("zone"),this.dBar=this.getDiv("bar_region"),this.dFill=this.getDiv("bar_fill"),this.dPrompt=this.getDiv("prompt"),this.dLabel=this.getDiv("label"),this.dSelect=this.getDiv("select"),this.dSize=this.getDiv("size"),this.dHash=this.getDiv("hash"),this.dCat=this.getDiv("cat"),this.getDiv("info"),this.dResult=this.getDiv("result"),this.dMessage=this.getDiv("result_msg"),this.dReset=this.getDiv("reset"),this.dReset.classList.add(this.rootClass+"_reset"),this.iconReset=new wt(this.dReset),this.iconReset.addCenter=le.RESET,this.iconReset.center().def().prime(),this.iconReset.onExecute=this.reset.bind(this),this.dTread=this.getDiv("tread"),this.tnaTread=new Ft(this.dTread.id),this.textPrompt=this.getDataAttr("prompt","string","Drag 'n Drop"),this.textLabel=this.getDataAttr("label","string","File Select"),this.dLabel.textContent=this.textLabel,this.bStop=this.stop.bind(this),this.dInput.onchange=this.change.bind(this),this.stage=P.IDLE,this.isDesktop=!/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)}enable(t=!0){if(t!=this._enable)return this._enable=t,this.enablePrime(t),this}async enablePrime(t){this.stage<P.RUN?(this.stage==P.READY?(this.reset(!0),await this.delay(1e3)):this.interact=t,this.dPrompt.textContent=this.textPrompt,this.dLabel.classList.toggle("show",t),this.dPrompt.classList.toggle("show",t&&this.isDesktop),this.dDivot.classList.toggle("show",t&&this.isDesktop),this.iconReset.enable(t)):this.interact=t}set interact(t){t?(this.dZone.onmousedown=this.dZone.ontouchstart=this.start.bind(this),this.dZone.ondragover=this.track.bind(this),this.dZone.ondragleave=this.leave.bind(this),this.dZone.ondrop=this.drop.bind(this)):(this.dZone.onmousedown=this.dZone.ontouchstart=null,this.dZone.ondragover=this.dZone.ondragleave=null,this.dZone.ondrop=null),this.div.classList.toggle("lock",!t)}start(t){t.preventDefault(),document.addEventListener("mouseup",this.bStop),document.addEventListener("touchend",this.bStop),this.dRegion.classList.add("highlight","active")}track(t){t.preventDefault(),this.stage=P.START,this.dRegion.classList.add("active")}leave(t){t.preventDefault(),this.stage=P.IDLE,this.dRegion.classList.remove("active")}stop(t){t.preventDefault(),document.removeEventListener("mouseup",this.bStop),document.removeEventListener("touchend",this.bStop),this.dRegion.classList.remove("highlight","active"),this.dInput.click(),this.stage=P.IDLE}drop(t){t.preventDefault(),this.dRegion.classList.remove("active"),t.dataTransfer.items?t.dataTransfer.items[0].kind==="file"&&(this._file=t.dataTransfer.items[0].getAsFile()):this._file=t.dataTransfer.files[0],this.stage=P.IDLE,this.validate()}change(t){[this._file]=t.target.files,console.log(`${this.id} Drop > change ${this._file.name}`),this._file!=null&&this.validate(),this.dInput.value=""}async validate(){this._flash=this.setFlash(this._file.name);const i=["application/macbinary","application/octet-stream"].includes(this._file.type)&&this._flash!=null;this.dRegion.classList.remove("pass","fail"),this.dResult.classList.remove("show"),this.dReset.classList.toggle("valid",i),this.dRegion.classList.toggle("valid",i),this.dPrompt.classList.toggle("show",!i&&this.isDesktop),this.dDivot.classList.add("prime"),this.dDivot.classList.toggle("show",i||this.isDesktop),this.dLabel.classList.toggle("slide",i),this.dHash.classList.toggle("show",i),this.dCat.classList.toggle("show",i),this.dSize.classList.toggle("show",i),await this.delay(250),i&&(this.iconReset.enable().show(),this.dSelect.innerHTML=this.formatName(this._file.name),this.dCat.textContent=At[this._flash].id,this.formatSize(this._file.size),this.stage=P.READY),this._valid=i,this.onValidate!=null&&this.onValidate(this)}async prime(){this.stage=P.RUN,this.interact=!1,this.iconReset.choreo("spin_out").timing(0,500).act(),this.iconReset.onAnimEnd=t=>{this.dReset.classList.remove("valid")},this.dBar.classList.add("show"),this.dHash.style.transition="",await this.delay(500),this.dDivot.classList.remove("show")}commit(){this.stage>P.FINISH||this.finish()}async finish(){this.stage=P.FINISH,this.value=100,this.clear(),await this.delay(1e3),this.dFill.style="",this.dMessage.innerText="DONE",this.dRegion.classList.add("pass"),this.dResult.classList.add("show"),await this.delay(400),this.dDivot.classList.add("show"),this.dReset.classList.remove("valid"),this.interact=this._flash!=0}async fail(){this._valid=!1,this.flash=void 0,this.stage=P.FAIL,this.clear(),this.dMessage.innerText="FAILURE",this.dRegion.classList.add("fail"),this.dResult.classList.add("show"),this.dReset.classList.remove("valid"),this.dDivot.classList.add("show"),await this.delay(1e3),this.div.classList.remove("lock"),this.dRegion.classList.remove("active"),this.dFill.style="",this.stage=P.IDLE,this.interact=!0}clear(){this.tnaTread.hide(),this.dBar.classList.remove("show"),this.dSize.classList.remove("show"),this.dHash.style="",this.dHash.classList.remove("show"),this.dCat.classList.remove("show")}reset(t=!1){(this.stage<P.RUN||t)&&(this.resetPrime(),this.onValidate!=null&&this.onValidate(this))}async resetPrime(){this._valid=!1,this.flash=void 0,this.clear(),this._val=0,this.dResult.classList.remove("show"),this.dReset.classList.add("hit"),this.iconReset.choreo("spin_out").timing(0,500).act(),this.iconReset.onAnimEnd=t=>this.dReset.classList.remove("hit"),this.dPrompt.classList.toggle("show",this.isDesktop),await this.delay(500),this.dDivot.classList.toggle("show",this.isDesktop),this.div.classList.remove("lock"),this.dRegion.classList.remove("valid","pass","fail"),this.dLabel.classList.remove("slide"),this.dReset.classList.remove("valid"),this.iconReset.enable(!1).hide(),this.stage=P.IDLE,this.interact=!0}set value(t){this._val=t,this.dFill.style.width=t+"%",this.dFill.style.opacity=t/66,this.tnaTread.show();const i=75,n=25,c=1-(t-i)/n;this.dHash.style.opacity=c;const v=this._hash.length*(100-t)/100,g=this.dHash.children;for(let _=this._hash.length-1;_>v;_--)g[_].style.opacity=0;this.dTread.style.opacity=c-.25}get value(){return this._val}set hash(t){for(this._hash=t;this.dHash.firstChild;)this.dHash.firstChild.remove();for(let i=0;i<t.length;i++){const n=document.createElement("span");this.dHash.appendChild(n),n.innerText=t[i]}}setFlash(t){for(let i in At)if(t.indexOf(At[i].id)!=-1)return i;console.warn(`${this.id} Drop setFlash FAIL str = ${t}`)}formatName(t){const i=t.split(".");let n="";for(let c in i)c<i.length-1?(n+=i[c],c<i.length-2&&(n+=".")):n+=`<span class="suffix">.${i[c]}</span>`;return n}formatSize(t){let i=t/1e3;if(i>1e3){const c=(i/1e3).toFixed(2).toString().split("."),v=parseInt(c[0]);this.dSize.innerHTML=(v==1?`<span class="int">${c[0]}</span>`:c[0])+`<span class="unit">M</span>${c[1]}`}else this.dSize.innerHTML=`${i.toFixed(0)}<span class="unit">K</span>`}}var he={tna:rn,flashMode:At};const dn=`<div id="region" class="region">
    <div id="bg" class="bg"></div>
    <div id="strip" class="strip"></div>
    <div id="fill" class="fill"></div>
    <div class="flex left">
      <div id="status" class="status"></div>
      <div id="value_wrap" class="value_wrap">
        <div id="value" class="value"></div>
      </div>
    </div>
    <div class="flex right">
      <div style="flex:1"></div>
      <div id="tread" class="tread"></div>
      <div id="prompt" class="prompt"></div>
    </div>
    <div id="thumb" class="thumb">
      <svg id="chevron" class="chevron" viewBox="0 0 100 100">
        <g transform="translate(0 6) scale(.88)">
          <polyline stroke-width="24" points="25 100 75 50 25 0" />
        </g>
      </svg>
    </div>
  </div>`;class ln extends dt{constructor(t,i="ux"){super(t);l(this,"_ready",!1);l(this,"sticky",!1);l(this,"autoReset",!0);l(this,"committed",!1);l(this,"expired",!1);l(this,"textStatus","");l(this,"textPrompt");l(this,"x0");l(this,"loc");l(this,"locMax");l(this,"locNorm");l(this,"delta");l(this,"defH");l(this,"thumbW");l(this,"promptW");l(this,"treadPersist",!1);l(this,"treadPrompt",!1);l(this,"cancelDelay",75);l(this,"commitDelay",0);l(this,"timeout");l(this,"tread");l(this,"animThumb");l(this,"onBegin");l(this,"onReady");l(this,"onPrime");l(this,"onCommit");l(this,"onEnd");l(this,"onCancel");l(this,"onExpire");l(this,"onChange");this.link(i),this.div.insertAdjacentHTML("beforeend",dn),this.div.classList.add("tna_SafeSlide","disable"),this.dRegion=this.getDiv("region"),this.dBg=this.getDiv("bg"),this.dStrip=this.getDiv("strip"),this.dFill=this.getDiv("fill"),this.dPrompt=this.getDiv("prompt"),this.dStatus=this.getDiv("status"),this.dValueW=this.getDiv("value_wrap"),this.dValue=this.getDiv("value"),this.dThumb=this.getDiv("thumb"),this.divChevron=this.getDiv("chevron"),this.divTread=this.getDiv("tread"),this.treadPrompt=this.div.dataset.safeTread!=null,this.treadPersist=this.div.dataset.safeTreadPersist!=null,this.treadIcon=this.treadPrompt||this.treadPersist,this.treadIcon&&(this.tread=new Ft(this.divTread.id)),this.dPrompt.innerText=this.textPrompt=this.getDataAttr("safePrompt","string",""),this.dStatus.innerText=this.textStatus=this.getDataAttr("safeStatus","string",""),this.defH=this.getPropVal("--safe-h"),this.defP=this.getPropVal("--safe-p"),this.getDataAttr("safeThumbW","percent"),this.bEnableEnd=this.enableEnd.bind(this),this.bStart=this.start.bind(this),this.bTrack=this.track.bind(this),this.bStop=this.stop.bind(this),this.bResetEnd=this.resetEnd.bind(this),this.bCommitEnd=this.commitEnd.bind(this),this.observer=new ResizeObserver(n=>{n[0].contentRect.width,this.resize()}),this.observer.observe(this.div),this.resize(),this.sticky=this.div.dataset.sticky!=null,this._enable=this.div.dataset.enable!=null,this._enable==1&&this.enable()}resize(){const t=this.thumbW;if(this.calcThumb(),this.thumbW==t)return;const i=this.locNorm*this.locMax;this.dThumb.style.left=this.defP+i+"px",this.dFill.style.left=this.defP+i-this.width+"px",this.calcPrompt();let n,c;const v=this.div.dataset.safeGradStart;if(v!=null){const g=parseFloat(v);isNaN(g)?n=50:(c=v.indexOf("px"),n=c>0?(this.thumbW+g)/this.width*100:((this.width-this.thumbW)*g/100+this.thumbW)/this.width*100),this.div.style.setProperty("--safe-grad-start",n+"%")}}enable(t=!0){if(t==this._enable)return;if(this._enable=t,this.loc=this.locNorm=0,this.primed&&!t)return this.committed=!0,this.commitPrime(),this;this.div.classList.toggle("disable",!t),this.divChevron.classList.toggle("show",t);let i=500;return t?this.animThumb=this.dThumb.animate([{opacity:0,width:this.defH+"px"},{opacity:1,width:this.thumbW/3+"px",offset:.33},{opacity:1,width:this.thumbW+"px"}],{duration:i,easing:"ease-out",fill:"backwards"}):(this.dThumb.onmousedown=this.dThumb.ontouchstart=null,this.dPrompt.classList.remove("show"),this.treadPersist&&this.tread.hide(),this.animThumb=this.dThumb.animate([{opacity:1,left:this.defP+"px"},{opacity:0,left:this.width-this.thumbW+"px"}],{duration:i,easing:"ease-in"})),this.animThumb.addEventListener("finish",this.bEnableEnd),this}enableEnd(){this.animThumb.removeEventListener("finish",this.bEnableEnd),this.div.classList.toggle("disable",!this._enable),this.dThumb.onmousedown=this.dThumb.ontouchstart=this._enable?this.bStart:null,this._enable&&(this.dPrompt.classList.add("show"),this.treadPersist&&(this.tread.prime(),this.tread.show()))}parse(t){const i=t.v;if(i<0)return console.warn(`${this.id} safeSlide parse FAIL no stage value`);switch(u.stageID[i]){case"ready":this.ready(t);break;case"run":this.update(t);break;case"commit":this.commit(t);break;case"expire":this.expire(t);break}}start(t){t.preventDefault(),t.stopImmediatePropagation(),this.primed=!0,this._ready=this.expired=this.committed=!1,clearTimeout(this.timeout),this.dThumb.style.cursor="grab",document.addEventListener("mousemove",this.bTrack),document.addEventListener("touchmove",this.bTrack),document.addEventListener("mouseup",this.bStop),document.addEventListener("touchend",this.bStop),this.x0=isNaN(t.pageX)?t.changedTouches[0].pageX:t.pageX,this.delta=0,this.calcThumb(),this.div.classList.add("active"),this.dPrompt.classList.add("active"),this.onTron!=null&&this.onTron(`${this.div.id} > start`),this.onBegin!=null&&this.onBegin(this),this.dPrompt.style.transition="none",this.treadIcon&&(this.tread.prime(!1),this.tread.show(!0),this.tread.div.style.transition="none")}track(t){if(!this.primed)return;const i=isNaN(t.pageX)?t.changedTouches[0].pageX:t.pageX;this.loc=Math.round(i-this.x0),this.loc=this.loc<this.locMax?this.loc:this.locMax,this.delta=this.loc=Math.max(this.loc,0),this.onTron!=null&&this.onTron(`${this.div.id} track ${Math.round(this.delta)}`),this.locNorm=this.loc/this.locMax,this.dThumb.style.left=this.defP+this.loc+"px",this.dFill.style.left=this.defP+this.loc-this.width+"px";const n=(this.loc-(this.locMax-(1-this.promptStart)*this.promptW))/((this.promptEnd-this.promptStart)*this.promptW);this.dPrompt.style.opacity=1-n,this.tread.div.style.opacity=1-n*2,this.loc>=this.locMax?(this.dPrompt.classList.remove("show"),!this.expired&&this._ready&&this.execute()):this.dPrompt.classList.add("show"),t.preventDefault()}execute(){document.removeEventListener("mousemove",this.bTrack),document.removeEventListener("touchmove",this.bTrack),this.treadIcon&&this.tread.hide(),this.div.classList.add("hold"),this.sticky?(this.onTron!=null&&this.onTron(`${this.div.id} > prime sticky`),document.removeEventListener("mouseup",this.bStop),document.removeEventListener("touchend",this.bStop),this.dThumb.style.pointerEvents="none",this.dThumb.onmousedown=this.dThumb.ontouchstart=null):this.onTron!=null&&this.onTron(`${this.div.id} > prime`),this.onPrime!=null?this.onPrime(this):this.dRegion.classList.add("confirm")}ready(){this._ready=!0,this.onReady!=null&&this.onReady()}async commit(t){!this.primed||(this.committed=!0,this.sticky||(document.removeEventListener("mouseup",this.bStop),document.removeEventListener("touchend",this.bStop),this.dThumb.style.pointerEvents="none",this.dValueW.classList.remove("show","blink"),this.dValue.innerText=""),this.onTron!=null&&this.onTron(`${this.div.id} > commit`),this.onCommit!=null&&this.onCommit(this,t),this.autoReset?this.commitDelay>0?this.timeout=setTimeout(this.resetPrime.bind(this),this.commitDelay):this.resetPrime():this.commitDelay>0?this.timeout=setTimeout(this.commitPrime.bind(this),this.commitDelay):this.commitPrime())}async commitPrime(){if(!this.committed)return;this.primed=!1;const t=500;this.dStrip.style.opacity=0,this.dStrip.style.transition=t+"ms",await this.delay(t/2),this.dPrompt.style="",this.dPrompt.classList.remove("show"),this.tread.div.style.opacity="",this.tread.div.style.transition="",this.dFill.style.opacity=0,this.dFill.style.transition=t+"ms",this.dThumb.style.left=this.width-this.defP-this.defH+"px",this.dThumb.style.width=this.defH+"px",this.dThumb.style.opacity=0,this.dThumb.style.transition=`${t}ms ease-in`,this.drawStatus(!1),this.dThumb.addEventListener("transitionend",this.bCommitEnd),this.dBg.classList.add("disable")}commitEnd(){this.dThumb.removeEventListener("transitionend",this.bCommitEnd),this.onEnd!=null&&this.onEnd(this),this.dThumb.style="",this.div.classList.remove("active","hold"),this.dThumb.onmousedown=this.dThumb.ontouchstart=null,this.dStrip.style="",this.dStrip.classList.remove("show"),this.dFill.style="",this.status="",this.value="",this.dRegion.classList.remove("confirm"),this.dBg.classList.remove("disable"),this.div.classList.add("disable"),this._enable=!1,this.loc=this.locNorm=0}expire(t){if(console.warn(`${this.id} safeSlide expire, primed:${this.primed}`),!this.primed)return;this.expired=!0;const i=this.onExpire!=null?this.onExpire(this,t):void 0;this.endMouse(i)}stop(t){this.endMouse(),t.preventDefault(),t.stopImmediatePropagation()}endMouse(t=!0){document.removeEventListener("mousemove",this.bTrack),document.removeEventListener("touchmove",this.bTrack),document.removeEventListener("mouseup",this.bStop),document.removeEventListener("touchend",this.bStop),t&&this.resetPrime()}async resetPrime(){if(!this.primed)return;this.primed=!1,this.onTron!==void 0&&this.onTron(`${this.div.id} > endPrime`),this.drawStatus(!1);let t=this.delta/this.locMax*200;t=t>50?t:50,this.committed&&await this.delay(t),this.delta!=0?(this.dThumb.addEventListener("transitionend",this.bResetEnd),this.loc=this.locNorm=0,this.dThumb.style.left=this.defP+"px",this.dThumb.style.transition=`${t}ms ease-in`,this.dFill.style.left=-this.width+"px",this.dFill.style.transition=`${t}ms ease-in`):this.resetEnd(),this.dStrip.classList.remove("show"),this.dPrompt.classList.remove("active"),this.dPrompt.style.opacity="",this.tread.div.style.opacity="",this.tread.div.style.transition="",this.treadPrompt&&!this.treadPersist&&(this.tread.prime(),this.tread.hide()),this.dRegion.classList.remove("confirm")}resetEnd(){this.dThumb.removeEventListener("transitionend",this.bResetEnd),this.onTron!=null&&this.onTron(`${this.div.id} > end`),!this.committed&&this.onCancel!=null&&(this.cancelDelay>0?this.timeout=setTimeout(this.onCancel,this.cancelDelay,this):this.onCancel(this)),this.committed=!1,this.div.classList.remove("confirm"),this.dThumb.style="",this.div.classList.remove("active","hold"),this.dThumb.onmousedown=this.dThumb.ontouchstart=this.bStart,this.dFill.style="",this.dPrompt.classList.add("show"),this.dPrompt.innerText=this.textPrompt,this.dPrompt.style="",this.dValue.innerText="",this.treadPersist&&this.tread.show()}reset(t=0){this.committed&&(t>0?this.timeout=setTimeout(this.expire.bind(this),t):this.expire())}update(t){!this.primed||(this.onChange!=null&&this.onChange(this,t),this.drawStrip())}drawStrip(t=!0){this.dStrip.classList.toggle("show",t)}drawStatus(t=!0){this.dStatus.classList.toggle("show",t),this.dValueW.classList.toggle("show",t),t||this.dValueW.classList.remove("blink")}drawValue(t=!0){this.dValueW.classList.toggle("show",t)}blink(t=.14){this.div.style.setProperty("--blink-rate",t+"s"),this.dValueW.classList.add("blink"),this.dValueW.onanimationend=this.blinkEnd.bind(this)}blinkEnd(t){this.dValueW.classList.remove("blink"),this.dValueW.onanimationend=void 0}calcThumb(){const t=this.div.offsetWidth;t!=this.width&&(this.width=t,this.thumbW=this.dThumb.offsetWidth,this.locMax=this.width-this.thumbW-this.defP*2)}calcPrompt(){let t,i;this.promptW=this.dPrompt.offsetWidth;let n=this.div.dataset.safePromptStart,c=this.div.dataset.safePromptEnd;n=n!=null?n:"0",c=c!=null?c:"50%";const v=parseFloat(n),g=parseFloat(c);isNaN(v)?t=0:(i=n.indexOf("px"),t=i>0?v/this.promptW:v/100),this.promptStart=t,isNaN(g)||(i=c.indexOf("px"),t=i>0?g/this.promptW:g/100),this.promptEnd=t}set value(t){this.dValue.innerText=this._val=t}get value(){return this._val}set prompt(t){this.textPrompt=this.dPrompt.innerText=t,this.calcPrompt()}set status(t){this.textStatus=this.dStatus.innerText=t,this.dStatus.classList.toggle("nil",t=="")}}const Kt={},Ct={act:!1};let H,N,gt,It=!0;function hn(){Kt.drop=H=new he.tna("update_drop"),H.onValidate=async s=>{const e=s._valid;if(e){nt.kill();try{s.hash=await ot.calcMD5(s._file)}catch(t){console.warn(t)}await B.delay(500)}N.enable(e)},H.onReset=s=>N.enable(!1),Kt.safe=N=new ln("sys_ota"),N.autoReset=!1,N.onBegin=s=>x.ready()?x.sendUX("sys_ota","begin"):s.ready(),N.onCancel=()=>x.sendUX("sys_ota","cancel"),N.onChange=(s,e)=>{if(e==null)return;const t=e.x;if(!It)s.value=t+"%",H.value=t;else{if(gt!=0)return;t<5?(s.status="RESTART",s.value=`0:0${t}`):s.value="",t==0&&s.blink()}},N.onCommit=async s=>{!It||(gt==0?(s.value="",await s.delay(500),s.status="RESTARTING",D.close(),await s.delay(2e3),await xt.freeze(),await s.delay(23e3),window.location.reload()):(await s.delay(1e3),s.commit()),Ct.act=!1)},N.onPrime=async s=>{Ct.act=!0,It=!1,gt=he.flashMode[H._flash].val,s.commitDelay=gt==0?2e3:0,s.status="CONNECTING",s.drawStatus(),s.drawStrip();try{await H.prime(),await ot.prime(),s.status="UPLOAD",await ot.upload(H._file,gt)}catch(e){console.warn(e),s.status="UPLOAD",s.value="",s.onEnd=void 0,s.dValue.classList.remove("show"),H.fail(),await s.delay(2e3),s.commitDelay=0,s.commit(),Ct.act=!1;return}finally{}It=!0,s.value="100%",await s.delay(1e3),s.blink(),H.finish(),N.onEnd=()=>H.commit()}}var C={tna:Kt,prop:Ct,init:hn};const vt={};let We,Ve,je,Ue,Qt,te;function cn(){ot.prop.ota_time!=null&&ot.prop.ota_time!=0&&(window.ota_time.innerText=tn.relative(ot.prop.ota_time))}function fn(){nt.onWrite=(n,c)=>window.tron_output.parentElement.style.zIndex=c==n.STAGE.BEGIN?-1:"",nt.onWrite(nt,nt.STAGE.END);const s="\xA0\xA0\xA0\xA0",e=`\u2022\xA0\u2022\xA0\u2022${s}Caution explosive bolts${s}\u2022\xA0\u2022\xA0\u2022`;nt.write(e,1.5),vt.overlay=We=new J("overlay").fuse().prime(),vt.overlay_tread_L=Ve=new Ft("overlay_tread_L"),vt.overlay_tread_R=je=new Ft("overlay_tread_R"),new O("info_firmware","object").onChange=(n,c)=>{const v=B.versionString(c.v),g=window.diag_client.innerText!=v;g&&(window.diag_firmware.innerText=v),window.diag_firmware.style.display=g?"unset":"none",window.diag_version.style.display="unset",window.page.classList.add("show")};const t=new sn("rssi_ind").static().prime();vt.rssi_head=t;const i=new O("info_rssi","object");i.onChange=(n,c)=>{t.value=n.value=parseInt(c.v);const v=n.value>-79;t.div.classList.toggle("warn",!v),t.view(!0),window.update_warn.style.display=v?"none":"",window.readme_p.style.paddingTop=v?"1em":""},Ue=new fe("debug_insert").prime(),new Vt("debug_load").enable().onExecute=()=>{C.tna.drop.prime(),te=un,Qt=setInterval(ce,200)},new Vt("debug_reset").enable().onExecute=()=>{C.tna.drop.reset(!0),C.tna.safe.enable(!1)},new Vt("debug_fail").enable().onExecute=()=>{C.tna.drop.prime(),te=pn,Qt=setInterval(ce,200)}}async function Xe(){document.body.classList.add("freeze"),await B.delay(1200),We.view(),Ve.show(),je.show()}const ce=()=>{C.tna.drop.value+=Math.random()*5,C.tna.drop.value>=100&&(clearInterval(Qt),te())},un=async()=>{await C.tna.drop.delay(500),C.tna.drop.finish()},pn=async()=>{await C.tna.drop.delay(500),C.tna.drop.fail()};function gn(){D.click.retro=()=>C.prop.act,D.prop.user&&(D.click.title=()=>Ue.toggle()),D.prop.user&&(D.click.retro=Xe)}var xt={tna:vt,init:fn,fill:cn,prime:gn,freeze:Xe};async function vn(){document.title=window.location.hostname.split(".")[0]+" \u2022 Update",ii.init(),D.init(),et.init(),xt.init(),C.init(),D.patch(),x.monitor(D.prop.preflight),!D.prop.preflight&&As.init()}D.upon.prime=xt.prime;D.upon.open=async()=>{await ot.fill(),xt.fill(),C.tna.drop.enable()};D.upon.close=()=>{xt.tna.rssi_head.view(!1),C.tna.drop.enable(!1)};window.addEventListener("load",vn);
