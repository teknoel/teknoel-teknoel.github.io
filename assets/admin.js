var ti=Object.defineProperty;var ei=(s,e,t)=>e in s?ti(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var a=(s,e,t)=>(ei(s,typeof e!="symbol"?e+"":e,t),t);const ii=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}};ii();var si={};(function(s){(function(){var e={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function t(c){return n(l(c),arguments)}function i(c,_){return t.apply(null,[c].concat(_||[]))}function n(c,_){var u=1,b=c.length,h,E="",k,$,g,Et,Bt,jt,Vt,dt;for(k=0;k<b;k++)if(typeof c[k]=="string")E+=c[k];else if(typeof c[k]=="object"){if(g=c[k],g.keys)for(h=_[u],$=0;$<g.keys.length;$++){if(h==null)throw new Error(t('[sprintf] Cannot access property "%s" of undefined value "%s"',g.keys[$],g.keys[$-1]));h=h[g.keys[$]]}else g.param_no?h=_[g.param_no]:h=_[u++];if(e.not_type.test(g.type)&&e.not_primitive.test(g.type)&&h instanceof Function&&(h=h()),e.numeric_arg.test(g.type)&&typeof h!="number"&&isNaN(h))throw new TypeError(t("[sprintf] expecting number but found %T",h));switch(e.number.test(g.type)&&(Vt=h>=0),g.type){case"b":h=parseInt(h,10).toString(2);break;case"c":h=String.fromCharCode(parseInt(h,10));break;case"d":case"i":h=parseInt(h,10);break;case"j":h=JSON.stringify(h,null,g.width?parseInt(g.width):0);break;case"e":h=g.precision?parseFloat(h).toExponential(g.precision):parseFloat(h).toExponential();break;case"f":h=g.precision?parseFloat(h).toFixed(g.precision):parseFloat(h);break;case"g":h=g.precision?String(Number(h.toPrecision(g.precision))):parseFloat(h);break;case"o":h=(parseInt(h,10)>>>0).toString(8);break;case"s":h=String(h),h=g.precision?h.substring(0,g.precision):h;break;case"t":h=String(!!h),h=g.precision?h.substring(0,g.precision):h;break;case"T":h=Object.prototype.toString.call(h).slice(8,-1).toLowerCase(),h=g.precision?h.substring(0,g.precision):h;break;case"u":h=parseInt(h,10)>>>0;break;case"v":h=h.valueOf(),h=g.precision?h.substring(0,g.precision):h;break;case"x":h=(parseInt(h,10)>>>0).toString(16);break;case"X":h=(parseInt(h,10)>>>0).toString(16).toUpperCase();break}e.json.test(g.type)?E+=h:(e.number.test(g.type)&&(!Vt||g.sign)?(dt=Vt?"+":"-",h=h.toString().replace(e.sign,"")):dt="",Bt=g.pad_char?g.pad_char==="0"?"0":g.pad_char.charAt(1):" ",jt=g.width-(dt+h).length,Et=g.width&&jt>0?Bt.repeat(jt):"",E+=g.align?dt+h+Et:Bt==="0"?dt+Et+h:Et+dt+h)}return E}var o=Object.create(null);function l(c){if(o[c])return o[c];for(var _=c,u,b=[],h=0;_;){if((u=e.text.exec(_))!==null)b.push(u[0]);else if((u=e.modulo.exec(_))!==null)b.push("%");else if((u=e.placeholder.exec(_))!==null){if(u[2]){h|=1;var E=[],k=u[2],$=[];if(($=e.key.exec(k))!==null)for(E.push($[1]);(k=k.substring($[0].length))!=="";)if(($=e.key_access.exec(k))!==null)E.push($[1]);else if(($=e.index_access.exec(k))!==null)E.push($[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");u[2]=E}else h|=2;if(h===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");b.push({placeholder:u[0],param_no:u[1],keys:u[2],sign:u[3],pad_char:u[4],align:u[5],width:u[6],precision:u[7],type:u[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");_=_.substring(u[0].length)}return o[c]=b}s.sprintf=t,s.vsprintf=i,typeof window!="undefined"&&(window.sprintf=t,window.vsprintf=i)})()})(si);function ni(s){return new Promise(e=>{setTimeout(()=>{e()},s)})}String.prototype.camelKabob=function(){let s="";return this.split("").map(e=>{s+=e.toUpperCase()==e?`-${e.toLowerCase()}`:e}),s};String.prototype.kabobCamel=function(){return this.replace(/-./g,s=>s[1].toUpperCase())};function ai(s,e,t){if(e.value==null){console.warn(`initStorage FAIL name:${s} target:${e}`);return}const i=localStorage.getItem(s);if(i!=null)return e.value=parseFloat(i),console.log(`initStorage ${s}:${e.value} data:${parseFloat(i)}`),e.value;if(t==null)localStorage.setItem(s,Number(e.value)),console.warn(`initStorage none:${s}, target:${e.value}`),e.onDefault!=null&&e.onDefault();else return localStorage.setItem(s,Number(t)),console.warn(`initStorage none:${s}, default:${t}`),e.value=t,t}function oi(s){const e=s.split(".");let t="";for(let i in e)t+=i!=1?e[i]:Number("0x"+e[1]),i<e.length-1&&(t+=".");return t}var F={delay:ni,initStorage:ai,versionString:oi};Element.prototype.createDiv=function(s){const e=document.createElement("div");return e.id=s,this.appendChild(e),e};Element.prototype.createDivFirst=function(s){const e=document.createElement("div");return s!=null&&(e.id=s),this.insertAdjacentElement("afterbegin",e),e};class z{constructor(e,t){a(this,"_id");a(this,"_tags",[]);a(this,"_valRef");a(this,"_valIO",!1);a(this,"_val");a(this,"_valLast");a(this,"_tron",!1);a(this,"_view",!1);a(this,"_height",0);a(this,"div");a(this,"data");a(this,"onChange");a(this,"onRender");switch(t=e.nodeType!=null?"div":t,t){case"object":case"obj":this.id=e;break;case"div":this.div=e,this.div.tna=this,this.id=e.id;break;case"id":default:this.div=document.getElementById(e),this.div!=null?this.div.tna=this:console.error(`tna construct no element for ${e}`),this.id=this.div==null?e:this.div.id;break}this.bRenderEnd=this.renderEnd.bind(this)}fuse(){return this.div==null?console.warn(`${this.id} fuse no div`):(this.div.classList.add("_tna"),this)}shy(e=!0){return this.div.classList.toggle("shy",e),this}prime(e=!0){if(this.div!=null)return this.div.classList.toggle("prime",e),this}touchPrime(){return this.div.ontouchstart=()=>{},this}show(){return this.render(!0),this}hide(){return this.render(!1),this}view(e=!0,t=!1){return this.render(e,t),this}viewStaged(e){return this.view(e,!0)}render(e=this._view,t=!1){this._view=e,this.div.classList.toggle("show",e),t?this.div.addEventListener("transitionend",this.bRenderEnd):this.callRender()}draw(){}renderEnd(){this.div.removeEventListener("transitionend",this.bRenderEnd),this.div.style.transition="",this.callRender()}callRender(){this.onRender!=null?this.onRender(this):this._view&&(this.onShow!=null?this.onShow(this):this.onHide!=null&&this.onHide(this))}display(e=!0){return console.log(`${this.id} display b:%o`,e),this.div.style.display=e?"":"none",this}getDiv(e,t){const i=this.div.querySelector(`#${e}`);if(i==null){console.warn(`${this.id} getDiv FAIL for "${e}"`);return}const n=t==null?this.div.id:t;return i.id=`${e}_${n}`,i}setProp(e,t){this.div.style.setProperty(e,t)}getProp(e){return getComputedStyle(this.div).getPropertyValue(e)}getPropVal(e){return parseFloat(this.getProp(e))}getDataAttr(e,t,i){const n=this.div.dataset[e],o=`--${e.camelKabob()}`,l=this.getProp(o);let c,_="";switch(t){case"pixel":_="px";case"integer":c=parseInt(n);break;case"percent":_="%";case"number":case"float":c=parseFloat(n);break;case"s":c=parseFloat(n)*1e3;break;case"string":return n==null?l.length>0?l:i:(c=n,c);default:c=parseFloat(n),n.indexOf("%")>0&&(_="%"),n.indexOf("px")>0&&(_="px");break}return isNaN(c)&&(c=parseInt(l),l.indexOf("%")>0&&(_="%"),l.indexOf("px")>0&&(_="px")),isNaN(c)&&c!=null&&(c=i),this.div.style.setProperty(o,c+_),c}parent(e,t){for(;!(e.id.indexOf(t)!=-1||e.parentElement==null);)e=e.parentElement;return e}async delay(e=1){return new Promise(t=>{setTimeout(()=>{t()},e)})}set(e){return this.data=e,e!=this._valLast&&(this.draw(),this.onChange!=null&&this.onChange(this,e),this._valLast=e),this}enable(e=!0){return this._enable=e,this}tag(...e){for(const t of e)this._tags.push(t);return this}hasTag(...e){let t=!1;for(const i of e)t=t||this._tags.find(n=>n==i);return t}latchClass(e){return this.div.querySelectorAll("._"+e).forEach(i=>i.classList.add(e)),this}set id(e){this._id=e}get id(){return this._id}valRef(e){return this._valRef=e,this}valIO(){return this._valIO=!0,this}set value(e){if(this._valIO&&this._valRef!=null&&this._valRef[0].val!=null){let t=this._valRef.findIndex(i=>i.val==e);t==-1&&(t=0,console.warn(`${this.id} set value(${e}) FAIL not in valRef, using _val:0`)),e=t}this._val=e}get value(){let e=this._val;return this._valIO&&this._valRef!=null&&this._valRef[0].val!=null&&(e=this._valRef[e].val),e}set height(e){this._height=e}get height(){return this._height}tron(e=!0){return this._tron=e,this}clamp(e,t,i){return Math.min(Math.max(e,t),i)}easeLinear(e,t,i,n){return i*e/n+t}easeInQuad(e,t,i,n){return i*(e/=n)*e+t}easeOutQuad(e,t,i,n){return-i*(e/=n)*(e-2)+t}easeInOutQuad(e,t,i,n){return(e/=n/2)<1?i/2*e*e+t:-i/2*(--e*(e-2)-1)+t}easeInSine(e,t,i,n){return-i*Math.cos(e/n*(Math.PI/2))+i+t}easeOutSine(e,t,i,n){return i*Math.sin(e/n*(Math.PI/2))+t}easeInOutSine(e,t,i,n){return-i/2*(Math.cos(Math.PI*e/n)-1)+t}easeInCubic(e,t,i,n){return i*(e/=n)*e*e+t}easeOutCubic(e,t,i,n){return i*((e=e/n-1)*e*e+1)+t}easeInOutCubic(e,t,i,n){return(e/=n/2)<1?i/2*e*e*e+t:i/2*((e-=2)*e*e+2)+t}easeOutElastic(e,t,i,n){let o,l=0,c=i;return e==0?t:(e/=n)==1?t+i:(l||(l=n*.3),c<Math.abs(i)?o=l/4:o=l/(2*Math.PI)*Math.asin(i/c),c*Math.pow(2,-10*e)*Math.sin((e*n-o)*(2*Math.PI)/l)+i+t)}}class M extends z{constructor(t){super(t);a(this,"_enable",!1);a(this,"_dynamic",!1);a(this,"_val",!1);a(this,"onChange");this.div.classList.add("tna_Accord"),this.div.dataset.dynamic!=null&&this.dynamic(),this.div.dataset.open!=null&&this.open(),this.div.dataset.prime!=null&&this.prime(),this._spill=this.div.dataset.spill!=null,this.bSpill=this.spill.bind(this)}prime(){return this.div.classList.add("prime"),this}resize(){const t=this.div.classList.contains("prime");this.div.classList.remove("prime"),this.div.classList.add("open"),this.div.style.setProperty("--accord-h","");const i=this.div.offsetHeight;this.div.style.setProperty("--accord-h",i+"px"),this.div.classList.toggle("open",this._val),this.div.classList.toggle("prime",t)}toggle(t){return this._val=t==null?!this._val:t,this._val?this.open():this.close(),this}open(){return this._val=!0,this.div.classList.add("open"),this._spill&&this.div.addEventListener("transitionend",this.bSpill),this.onChange!=null&&this.onChange(this),this}close(){return this._val=!1,this.div.classList.remove("open","spill"),this.onChange!=null&&this.onChange(this),this}spill(){return console.log(`${this.id} spill`),this.div.classList.add("spill"),this.div.removeEventListener("transitionend",this.bSpill),this}dynamic(t=!0){return t&&!this._dynamic?window.addEventListener("resize",this.resize.bind(this)):window.removeEventListener("resize",this.resize.bind(this)),this.resize(),this._dynamic=t,this}}const ri=`<div id="region" class="region">
    <div id="bg" class="bg"></div>
    <div id="label" class="label"></div>
  </div>`;class li extends z{constructor(t){super(t);a(this,"_label");this._label=this.div.innerHTML,this.div.innerText="",this.div.insertAdjacentHTML("beforeend",ri),this.div.classList.add("tna_RetroT"),this.dRegion=this.getDiv("region"),this.dLabel=this.getDiv("label"),this.dBg=this.getDiv("bg"),this.dLabel.innerText=this._label}}const Nt={};function di(){ci(),fi(),ye()}async function hi(){for(const[s,e]of Object.entries(Nt))e.prime()}function ci(){document.querySelectorAll("._tna_Accord").forEach((e,t)=>{e.id.length==0&&(e.id=`accord_${t}`);const i=e.id.length!=0?e.id:t;Nt[i]=new M(e.id)})}function fi(){document.querySelectorAll("._hr").forEach((e,t)=>{e.id.length==0&&(e.id=`hr_${t}`);const i=e.id.length!=0?e.id:t;Nt[i]=new z(e.id).fuse(),e.classList.add("hr_wrap");const n=document.createElement("hr");e.insertAdjacentElement("afterbegin",n)})}function ye(){let s;s=document.querySelectorAll(".tna_RetroT"),s.forEach((e,t)=>{e.id.length==0&&(e.id=`retro_text_${t}`),new li(e.id)})}var ui={init:di,prime:hi,items:Nt,retro:ye};const we=["ping","call","ux","info","push","save","sync"],xe=["call_prime","call_console","call_tune","call_warn","call_restart","call_admin","call_photo","call_gps_log"],gi=["none","default","notify","toggle_on","toggle_off","alarm","close_encounter","charge_fanfare","bonanza","guantanamera","rhythm_dancer"],pi=["OK",'"index.html" served from FS'],ke=["null","sys_splash","sys_boot","sys_ap","sys_ota","sys_restart","sys_fail","reset_user","reset_admin","net_setup","net_menu","net_fail","set_bright","set_sound","tap_menu","tap_test","tap_notify","clock_static","clock_hide","clock_switch","clock_service","clock_tz","clock_dst","clock_24h","clock_pps","alarm_menu","alarm_set","alarm_notify","alarm_snooze","diag_info","diag_serial","diag_console","diag_net","diag_net_mac","diag_gps","diag_led","photo"],Le=["idle","init","begin","splash","prime","ready","run","update","wait","confirm","notify","commit","end","exit","cancel","expire","fail"],Ee=["info_rc","info_user","info_mfg","info_reg","info_hardware","info_firmware","info_install","info_uptime","info_net","info_rssi","info_display","info_status","info_tap","info_ntp","info_gps","info_gps_log"],De=["admin_sign","admin_fpo","ota_version","ota_version_fs","ota_time","ota_time_fs","ota_fpo","mfg_product","mfg_version","mfg_date","mfg_serial","mfg_logic","mfg_display","mfg_color","mfg_note","mfg_fpo","reg_date","reg_name_1","reg_name_2","reg_user","reg_gift","reg_gp_1","reg_gp_2","reg_fpo","sys_output","sys_console","sys_fpo","def_name","def_device","def_ssid","def_pass","def_alert","def_net_fpo","def_bright","def_sound","def_av_fpo","def_tap_act","def_tap","def_tilt","def_tap_fpo","def_ntp_serve","def_ntp_int","def_ntp_fpo","def_nts_fpo","def_gps_alert","def_gps_log_i","def_gps_log_x","def_gps_fpo","def_tz","def_dst","def_24h","def_pps","def_clock_fpo","def_alarm_ind"],_i=100,Te=["ux_boot","ux_index","ux_fpo","user_consent","user_fpo","net_name","net_device","net_ssid","net_pass","net_alert","net_fpo","ui_bright","ui_sound","ui_fpo","tap","tap_mode","tap_tilt","tap_alert","tap_fpo","ntp_server","ntp_interval","ntp_fpo","nts_fpo","gps_alert","gps_log_int","gps_log_ratio","gps_fpo","clock_static","clock_disp","clock_service","clock_tz","clock_dst","clock_24h","clock_pps","clock_fpo","alarm_tap","alarm_fpo","daily","daily_ind","daily_tone","daily_vol","daily_d","daily_h","daily_m","daily_snooze"],vi={display:0,piezo:1,xpio:2,gps:3},mi={display:1,piezo:2,xpio:4,gps:8},bi=["CLOCK_HHMM","CLOCK_DATE","CLOCK_MMSS"],yi=["NTP","GPS","pps","none"],wi={action:we,call:xe,ux:ke,info:Ee,admin:De,pref:Te,stage:Le};var P={master:wi,hwOffset:vi,hwMask:mi,actionID:we,callID:xe,tuneID:gi,warnID:pi,uxID:ke,stageID:Le,infoID:Ee,prefBase:_i,prefID:Te,adminID:De,clockID:bi,serviceID:yi};const ut={},gt={};let Y=!1;var r={...P,getPrefID:Ei,controls:ut,linkControl:xi,getControlByID:ki,getControlByIndex:Li,dialogs:gt,linkDialog:Ti,printDialogs:Si,getDialogByIndex:Ii,tron:Di};function xi(s){const e=P.master[s.linkType];if(e==null){Y&&console.log(`linkControl FAIL id:${s.id}, bad type:${s.linkType}`);return}const t=e.indexOf(s.id),i=s.linkType=="pref"?P.prefBase:0;return t<0?(Y&&console.log(`linkControl FAIL not found id:${s.id}`),!1):(s.linkID=t+i,ut[s.id]={obj:s},!0)}function ki(s){if(ut.hasOwnProperty(s))return ut[s].obj;Y&&console.log(`map.getControlByID FAIL no table entry for ${s}`)}function Li(s,e){let t=0;switch(s){case"action":t=P.actionID[e];break;case"call":t=P.callID[e];break;case"ux":t=P.uxID[e];break;case"info":t=P.infoID[e];break;case"pref":t=P.prefID[e-P.prefBase];break;case"admin":t=P.adminID[e];break}if(t==0){Y&&console.log(`map.getControlByIndex FAIL not registered ${typeID}: ${e}`);return}if(ut.hasOwnProperty(t))return ut[t].obj;Y&&console.log(`map.getControlByIndex FAIL no object ${typeID}:${e}`)}function Ei(s){let e=P.prefID.indexOf(s);if(e!=-1)return e+P.prefBase;console.warn(`getPrefID FAIL ${s} not found`)}function Di(s=!0){Y=s}function Ti(s){const e=P.uxID.indexOf(s.id);switch(e){case-1:return Y&&console.log(`map.linkDialog FAIL id:${s.id}`),!1;default:s.linkID=e,gt[s.id]={obj:s};break}return!0}function Ii(s){const e=P.uxID[s];if(e==null){Y&&console.log(`map.getDialogByIndex FAIL ux not registered for ${s}`);return}if(gt.hasOwnProperty(e))return gt[e].obj;Y&&console.log(`map.getDialogByIndex FAIL no object for :${e}`)}function Si(){console.warn("printDialogs");for(const s in gt)console.log(`  ${gt[s].obj.id}`)}class X extends z{constructor(t,i){super(t,i);a(this,"_enable",!1);a(this,"autoEnable",!0);a(this,"primed",!1);a(this,"synced");a(this,"linked");a(this,"linkType");a(this,"linkID");a(this,"valPush");a(this,"valSave");a(this,"lastTime");this._val=0}link(t){t!=null&&(this.linkType=t,this.linked=r.linkControl(this))}sync(t){const i=t.v;this.value=i,this.valPush=this.valSave=i,this.set(t),this.synced||(this.autoEnable&&this._enable!=null&&this.enable(),this.synced=!0)}push(){if(this.linked==!1)return;const t=this.value;t!=this.valPush&&(this.valPush=t,this.send("push",t))}save(){if(this.linked==!1)return;const t=this.value;t!=this.valSave&&(this.valSave=this.valPush=t,this.send("save",t))}send(t,i){const n={a:r.actionID.indexOf(t),t:[]};n.t.push({i:this.linkID,v:i|0}),this.linked!=null&&m.transmit(n,`${this.id} >>`)}}const $i=`<div id="region" class="region">
    <div id="wrap" class="wrap"></div>
    <div id="label"></div>
  </div>`;class I extends X{constructor(t,i){super(t);a(this,"_enable",!0);a(this,"_highlight",!1);a(this,"_static",!1);a(this,"_target");a(this,"_index");a(this,"_x0",0);a(this,"_y0",0);a(this,"_x1",100);a(this,"_y1",100);a(this,"_x",0);a(this,"_y",0);a(this,"_scaleX",1);a(this,"_scaleY",1);a(this,"list",[]);a(this,"onExecute");this.link(i),this.target(this.div),this.div.insertAdjacentHTML("beforeend",$i),this.div.classList.add("tna_Icon"),this.dRegion=this.getDiv("region"),this.dWrap=this.getDiv("wrap"),this.dLabel=this.getDiv("label"),isNaN(this.getPropVal("--icon-w"))&&this.setProp("--icon-w",this.getProp("--icon-h")),this._val=0,this.label=this.getDataAttr("label","string","")}set add(t){const i=`
      <svg class="svg" viewBox="${this._x0} ${this._y0} ${this._x1} ${this._y1}">
        <g><circle cx="0" cy="0" r="50" /></g>
      </svg>`;this.dWrap.insertAdjacentHTML("beforeend",i);const n=this.dWrap.lastChild,o=n.lastElementChild;o.innerHTML=t,this.list.push(n),this.update()}set addCenter(t){this.add=t,this.list.slice(-1)[0].lastElementChild.firstElementChild.setAttribute("transform","translate(-50 -50)")}symbol(t){return window["sym_"+t]==null?console.warn(`${this.id} addSymbol FAIL: ${t}`):this.add=`<use href="#sym_${t}"/>`,this}enable(t=!0){return t==this._enable?this:(this._enable=t,this.render(),this)}render(t=this._view,i){super.render(t,i),this.div.classList.toggle("interact",t&&this._enable&&!this._static),this.div.classList.toggle("disable",!this._enable&&this._view)}set index(t){if(t=Number(t),isNaN(t))return console.warn(`${this.id} set index NaN`);if(t==this._index)return;this._index!=null&&this.list[this._index].classList.remove("show"),this.list[t].classList.add("show"),this._index=t}get index(){return this._index}def(){return this.index=0,this}toggle(t){return this._val=t==null?!this._val:t,this.draw(t),this}cycle(){let t=this._index+1;return t=t>=this.list.length?0:t,this.index=t,this.draw(),this}clear(){this.list.forEach(t=>t.remove()),this.list=[]}update(){const t=`translate(${this._x} ${this._y}) scale(${this._scaleX} ${this._scaleY})`;for(let i in this.list)this.list[i].firstElementChild.setAttribute("transform",t)}execute(){this.onExecute!=null&&this.onExecute(this),this.onChange!=null&&this.onChange(this)}set(t){typeof t!="object"&&(this.value=t),t!=this.lastVal&&(this.index=this.value),super.set(t)}svgRef(t){return t>this.list.length-1?console.warn(`${this.id} svgRef FAIL, bad index`):this.list[t]}gRef(t){return t>this.list.length-1?console.warn(`${this.id} gRef FAIL, bad index`):this.list[t].firstElementChild}viewBox(t,i,n,o){return this._x0=t,this._y0=i,this._x1=n,this._y1=o,this}translate(t,i){return this._x=t,this._y=i,this.update(),this}center(){return this.translate(50,50),this}scaleXY(t,i){return this._scaleX=t,this._scaleY=i,this.update(),this}scale(t){return this._scaleX=this._scaleY=t,this.update(),this}scaleCenter(t){return this._scaleX=this._scaleY=t,this._x=50,this._y=50,this.update(),this}sizeXY(t,i){return this.div.style.setProperty("--icon-h",i+"px"),this.div.style.setProperty("--icon-w",t+"px"),this}size(t){return this.div.style.setProperty("--icon-x",t),this}highlight(t){if(t==-1&&(t=!this._enable),!!this._enable)return this._highlight=t,this.div.classList.toggle("highlight",t),this}static(t=!0){return this._static=t,this.div.classList.toggle("interact",!t),this}set label(t){const i=t.length>0;this.dLabel.innerText=i?t:"",this.dLabel.classList.toggle("label",i)}target(t){return this._target=typeof t=="string"?window[t]:t,this._target.onclick=this.execute.bind(this),t!=this.div&&(this.div.style.pointerEvents="none"),this}enabled(){return this._enable}}class tt extends I{constructor(t,i){super(t);a(this,"_class");a(this,"_anim");a(this,"_count",0);a(this,"_duration",0);a(this,"_delay",0);a(this,"onAnimEnd");this.link(i)}async act(t=!0){const i=this._class!=null?"act_"+this._class:"act";if(this.div.classList.contains(i)&&(this.div.classList.remove(i),await this.delay()),this.div.classList.toggle(i,t),t){const n="tna_Icon_"+(this._anim!=null?"act_"+this._anim:"act");this.div.onanimationend=o=>{`${this.id}`,o.animationName==n&&this.div.classList.remove(i),this.div.onanimationend=void 0,this.onAnimEnd!=null&&this.onAnimEnd(this)}}else this.div.onanimationend=void 0;return this}choreo(t,i){return this._anim=t,this._class=t+(i==null?"":"_"+i),this}timing(t,i=this._dur,n=0){this._count=t=Number(t),this._dur=i=Number(i),this._delay=n=Number(n);const o="--icon-act_"+this._anim;return this.setProp(o+"-n",t==0?"infinite":t),this.setProp(o+"-t",i+"ms"),this.setProp(o+"-d",n+"ms"),this}property(t,i){this.dWrap.style.setProperty("--icon-act-"+t,i)}}const pt=[];let _t;function Ci(s,e){const t=window[s];if(t==null)return console.log(`panel.add() FAIL, cannot find ${s}`);t.dataset.index=pt.length,pt.push({id:s,title:e,panel:t})}function Pi(){if(_t!=null)return pt[_t].panel}function Oi(){return _t}function Mi(){return _t!=null?pt[_t].id:void 0}function Ie(s,e=!1){s<0||(_t=s,pt.forEach((t,i)=>{const n=t.panel,o=s==i;e||(n.classList.toggle("show",o),n.children[0].classList.toggle("show",o)),o&&n._tna_begin!=null&&n._tna_begin()}))}function Fi(s,e=!1){const t=pt.findIndex(i=>i.id==s);return t!=null&&Ie(t,e),t}function Ri(s){return new URLSearchParams(s).get("panel")}var St={add:Ci,current:Pi,currentID:Mi,currentIndex:Oi,index:Ie,setByID:Fi,inject:Ri};class Yt extends z{constructor(t,i){super(t,"div");a(this,"_static",!1);a(this,"_index");a(this,"_label");a(this,"_html");a(this,"_target");a(this,"control");a(this,"bClick");if(i!=null){this.control=i,this.div.classList.add("menu_item"),this.dLabel=this.getDiv("label"),this.bClick=this.click.bind(this);let n=this.div.querySelector("._click");n==null&&(n=this.div),n._tna_target=this.div,this._target=n}else this.div.classList.add("menu_static"),this._target=this.div,this.static();this.enable()}click(t){let i=t.target._tna_target;i==null&&(i=this.parent(t.target,"_item")),this.execute(i),t.preventDefault(),t.stopImmediatePropagation()}async execute(t){this.control.click(this),this.div.classList.remove("hover"),this.div.classList.add("action"),await this.delay(360),this.control.view(!1),await this.delay(300),this.div.classList.remove("action"),this.control.execute(this)}enable(t=!0){return this.enabled=t,this.control!=null&&this.div.classList.toggle("hover",t&&this.control._hover),this.div.classList.toggle("enable",t),this._target.onclick=t&&!this._static?this.bClick:null,this._target.style.pointerEvents=t&&!this._static?"":"none",this}highlight(t=!0){return this.div.classList.toggle("highlight",t),this.enable(!t),this}set label(t){this.dLabel.innerText=this._label=t}get label(){return this._label}set html(t){this.dLabel.innerHTML=this._html=t}static(t=!0){return this._static=t,this._target.onclick=this.enabled&&!this._static?this.bClick:null,this._target.style.pointerEvents=t?"none":"",this}}const Ai=`<div id="region" class="region">
    <div id="bg" class="bg"></div>
    <div id="panel" class="panel"></div>
  </div>`,Ni=`<div>
    <div id="label" class="label"></div>
  </div>`;class Hi extends z{constructor(t,i=Ai){super(t);a(this,"_enable",!1);a(this,"_index");a(this,"_highlight",!1);a(this,"_hover",!0);a(this,"_static_high",!0);a(this,"_wipe",!1);a(this,"_tm_open");a(this,"_tm_close");a(this,"_block_tm_open");a(this,"_block_tm_close");a(this,"_block_opacity");a(this,"_itemT");a(this,"_staticT");a(this,"_itemN",0);a(this,"_staticN",0);a(this,"pool",[]);a(this,"list",[]);a(this,"last");a(this,"onBegin");a(this,"onEndPrime");a(this,"onEnd");a(this,"onPrime");a(this,"onExecute");a(this,"onResize");this._itemT=Ni,this.div.insertAdjacentHTML("afterbegin",i),this.div.classList.add("tna_Menu"),this.dRegion=this.getDiv("region"),this.dBg=this.getDiv("bg"),this.dPanel=this.getDiv("panel"),this.getDiv("banner"),this.blocked=this.div.dataset.block!=null,this.blocked&&(this.dBlock=document.createElement("div"),this.dBlock.id="block",this.div.insertAdjacentElement("afterbegin",this.dBlock),this.getDiv("block"),this.dBlock.classList.add("block"),this.dBlock.onmousedown=this.dBlock.ontouchstart=this.escape.bind(this)),this._highlight=this.div.dataset.highlight!=null,this.enable(this.div.dataset.enable!=null),this._block_opacity=this.getProp("--menu-block-a"),this.itemH=this.getDataAttr("menuIH","pixel",""),this.staticH=this.getDataAttr("menuStaticH","pixel",""),this.merge()}merge(){let t,i;const n=this.div.childElementCount-this.blocked;for(let o=1;o<n;o++)i=this.div.children[1+this.blocked],i.classList.contains("menu_item")?(t=this.add(),t.link=i.dataset.link,t.label=i.innerHTML,i.dataset.highlight!=null&&(this._index=t._index)):i.classList.contains("menu_static")&&(t=this.add("static")),t.view(!0),i.remove();this._index!=null&&this.index(this._index),n>1&&this.update()}add(t="item"){let i,n;switch(t){case"static":if(this._staticT!=null){const o=document.createElement("template");o.innerHTML=this._staticT,n=o.content.firstElementChild.cloneNode(!0)}else n=document.createElement("div");this.last=this.createStatic(n);break;default:if(this._itemT!=null){const o=document.createElement("template");o.innerHTML=this._itemT,n=o.content.firstElementChild.cloneNode(!0)}else n=document.createElement("div");this.last=this.createItem(n);break}return i=this.dPanel.appendChild(n),this.pool.push(i),this.last}createItem(t){const i=new Yt(t,this),n=`${this.id}_item_${this._itemN}`;return t.id=i.id=n,i._index=this._itemN,i.link=this._itemN,i.height=this.itemH,this.list.push(t),this._itemN++,i}createStatic(t){const i=new Yt(t).static(),n=`${this.id}_static_${this._itemN}`;return t.id=i.id=n,i.height=this.staticH,this._staticN++,i}index(t){this._index=t;for(let i in this.pool)this.pool[i].tna.highlight(!1);return t>=0&&this.list[t].tna.highlight(),this.setStatic(t),super.set(t),this}setStatic(t){if(!this._static_high)return;let i;if(this.pool.find((n,o)=>{const l=n==this.list[t];return l&&(i=o),l}),i!=null){const n=i-1,o=i+1;n>=0&&this.pool[n].tna.highlight(),o<this.pool.length-1&&this.pool[o].tna.highlight()}}update(){let t=0;return this.pool.forEach((i,n)=>{t+=i.tna.height*i.tna._view}),this.height=t,t}clear(){this.list.forEach(t=>{t.tna=void 0,t.remove()}),this.list=[],this.pool=[],this._itemN=this._staticN=0,this.update()}click(t){this.last=t,this._wipe&&this.index(-1),this.setStatic(t._index),this.onPrime!=null&&this.onPrime(t,t.link)}execute(t){this._highlight&&(t.enable(!1),this.index(t._index)),this.onExecute!=null&&this.onExecute(this,t.link)&&this.end()}async escape(t){t!=null&&(t.stopImmediatePropagation(),t.preventDefault()),this.view(!1),this.transBlock(this._block_tm_close),this.onEnd!=null&&this.onEnd(this)}begin(){this.transRegion(this._tm_open,"ease-out"),this.transBlock(this._block_tm_open,"ease"),this.onBegin!=null&&this.onBegin(this,!0)}endPrime(){this.transRegion(this._tm_close,"ease-in"),this.onEndPrime!=null&&this.onEndPrime(this)}end(){this.transBlock(),this.onEnd!=null&&this.onEnd(this)}render(t=this._view){super.render(t),this.div.classList.toggle("open",t),t?this.begin():this.endPrime()}find(t){return this.list.find(n=>n.tna.label==t)}wipe(t=!0){return this._wipe=t,this}hover(t=!0){return this._hover=t,this}set height(t){this._height=t,this.div.style.setProperty("--menu-h",t+"px"),this.onResize!=null&&this.onResize(this)}get height(){return this._height}get count(){return Object.keys(this.list).length}get next(){if(this.last._index<this.count)return this.list[this.last._index+1]}get previous(){if(this.last._index>0)return this.list[this.last._index-1]}set template(t){this._itemT=t}set templateStatic(t){this._staticT=t}staticHigh(t=!0){return this._static_high=t,this}timing(t,i){return this._tm_open=t,this._tm_close=i,this}timingBlock(t,i){return this._block_tm_open=t,this._block_tm_close=i,this}transRegion(t=0,i=""){const n=t+"ms";return this.dRegion.style.transitionDuration=n,this.dRegion.style.transitionTimingFunction=i,this}transBlock(t=0,i=""){const n=t+"ms",o=this._view?this._block_opacity:0;return this.dBlock.style.transitionDuration=n,this.dBlock.style.transitionTimingFunction=i,this.dBlock.style.opacity=o,this.dBlock.style.visibility="visible",t==0?this.transBlockEnd():this.dBlock.ontransitionend=this.transBlockEnd.bind(this),this}transBlockEnd(){this._view||(this.dBlock.style.visibility="hidden"),this.dBlock.ontransitionend=void 0}}var zi={control:Hi,item:Yt};const Bi=`<g stroke-width="6.7">
    <polygon
      points="89.5 72.8 50 95.6 10.5 72.8 10.5 27.2 50 4.4 89.5 27.2 89.5 72.8"
    />
    <polyline id="badge_N" points="28.4 62 28.4 38 71.6 62 71.6 38" />
  </g>`,ji=`<div id="region" class="region">
    <div id="bg" class="bg"></div>
    <div id="banner" class="banner">
      <div class="banner_wrap">
        <div>C</div><div>u</div><div>b</div><div>e</div>
        <div>C</div><div>o</div><div>r</div><div>e</div></div></div>
    <div id="panel" class="panel"></div>
    </div>
  </div>`;const $t={},Zt=[];let L,O,vt,Wt,Se=!1,Dt=!1;function Vi(){if($t.badge=O=new tt("badge").show(),O.div.classList.add("connect"),O.add=Bi,O.value=!1,O.def(),O.ext_onExecute=e=>{e.choreo("3D_flip").timing(1,250).act(),L.view(!L._view),L._view||L.escape()},Ce(!x.prop.modeExt),$t.dot=vt=new I("badge_dot"),vt.add='<circle cx="50" cy="50" r="50" />',vt.static().prime().def(),vt.onRender=e=>vt.div.classList.toggle("orbit",e._view),window.menu!=null){$t.menu=L=new zi.control("menu",ji).wipe(),Wt=L._index,L.timing(250,250).timingBlock(500,250),L.onExecute=(t,i)=>{t.last.index==0;const n=$e(i);return n&&(Wt=t._index),s(),n},L.onBegin=L.onEnd=t=>{O.highlight(t._view);const i=t._view?"blur(3px)":"",n=t._view?t._block_tm_open:t._block_tm_close;fe(n,"ease",i),Dt=!1},ce("Admin");const e=ce("R/Con","rc");e.html='R<span style="padding-left: 2px; font-size: 130%; position: relative; top: 1.5px;">/</span>Con'}const s=async()=>{Dt=!0,await F.delay(2e3),Dt&&(O.highlight(!1),L.index(Wt),L.transBlock(),fe(),Dt=!1)}}function ce(s,e){const t=L.find(s);if(t==null){let i=L.add("static").enable();return Zt.push(i),i=L.add().enable(),Zt.push(i),i.label=s,i.link=`/${e!=null?e:s.toLowerCase()}/`,Se=!0,i}else return t.tna}function fe(s=0,e="",t=""){const i=s+"ms",n=window.fit!=null?St.current():window.page;if(n==null)return console.warn("nav menuBG FAIL");n.style.filter=t,n.style.transitionProperty="filter",n.style.transitionDuration=`${i}`,n.style.transitionTimingFunction=e}function $e(s){console.log(`hyper -> "${s}"`);const e=St.currentIndex(),t=new URL(s,"http://x"),i=t.pathname==document.location.pathname;if(i){const n=St.inject(t.search);St.setByID(n)}else!x.prop.local&&s.length>1&&s.slice(-1)=="/"&&(s=s.slice(0,-1)),window.location=s,L.index(e);return i}function Wi(s){!Se||(Zt.forEach(e=>e.view(s)),L.update())}function Ce(s=!0){O.div.classList.toggle("static",!s),O.div.classList.toggle("dim",!s),O.onExecute=s?O.ext_onExecute:void 0,O.enable(s)}var st={tna:$t,init:Vi,enable:Ce,hyper:$e,access:Wi};class A extends X{constructor(t,i=void 0,n="info"){super(t,i);a(this,"onChange");this.link(n)}}const G={cast:"border-radius: 9px; padding: 1px 7px 0; font-style: italic; font-weight: bold",test:"border: 0.25px solid gray; border-style: solid solid solid none; border-radius: 0 9px 9px 0; padding: 1px 7px 0 0; font-style: italic; font-weight: bold",gray:"border: 0.25px solid gray; background: gray; color: white;",black:"border: 0.25px solid black; background: black; color: white;",red:"border: 0.25px solid red; background: red; color: white;",gold:"border: 0.25px solid gray; background: gold; color: black;"},et=["fail","cache","cache_end","tear","touch","normal","warn","error","alert","bold"],Kt={},nt={},U={};let Ct,Pt,Qt=0;function Xi(){Ct=r.callID.indexOf("call_console"),Kt.rc=new A("call_console","object","call"),Kt.rc.onChange=(s,e)=>{switch(e.v){case 0:U.fail!=null?U.fail():V("fail","Access Not Authorized");break;case 1:e.n==1&&(Pt=0);const t=JSON.stringify(e);console.groupCollapsed("cache n:%o, count:%o",e.n,e.z.length),console.log(t),console.groupEnd(),e.z.length&&e.z.forEach(i=>{nt.last_format=et[i.f],nt.last_msg=i.m,V(Qt?et[i.f]:"tear",i.m),Qt++}),Pt+=e.z.length;break;case 2:console.warn("cache EOL chunks:%o count:%o",e.n,Pt),e.c!=null&&(nt.capacity=e.c),e.f!=null&&(nt.full=e.f),U.cache!=null&&U.cache();break;default:nt.last_format=et[e.v],nt.last_msg=e.x,U.msg!=null&&U.msg(),V(et[e.v],e.x);break}}}function Gi(){Qt=Pt=0}function V(s,e){if(U.output!=null)return U.output(s,e);switch(s){case"normal":console.log("%cRC",G.gray+G.cast,e);break;case"warn":const t="border: 0.25px black solid;";console.log("%cRC",t+G.gold+G.cast+t,e);break;case"error":console.log("%cRC%c %s",G.red+G.cast,"color: red",e);break;case"bold":console.log("%cRC%c %s",G.black+G.cast,"font-weight: bold",e);break}}function Ui(){x.prop.preflight||qi()}function qi(){const s=new CustomEvent("meh"),e="rc.test format:",t={a:r.actionID.indexOf("call"),t:[{i:Ct,v:et.indexOf("normal"),x:e+"normal"},{i:Ct,v:et.indexOf("warn"),x:e+"warn"},{i:Ct,v:et.indexOf("error"),x:e+"error"}]};s.data=JSON.stringify(t),m.parse(s)}function Ji(s){V("normal",s)}function Yi(s){V("warn",s)}function Zi(s){V("error",s)}function Ki(s){V("tear",s)}function Qi(s){V("alert",s)}function ts(s){V("bold",s)}var it={formatID:et,style:G,tna:Kt,prop:nt,upon:U,init:Xi,prime:Ui,reset:Gi,log:Ji,warn:Yi,error:Zi,tear:Ki,alert:Qi,bold:ts};const es=1,is=2;class ss extends z{constructor(){super("tron","object");a(this,"_enable",!0);a(this,"state",!1);a(this,"STAGE",Object.freeze({BEGIN:1,END:0}));a(this,"holdTime");a(this,"delayTime");a(this,"showTimeout");a(this,"hideTimeout");a(this,"onWrite");this.setHold().setDelay()}assign(t){const i=window[t];return i==null?console.warn("tron assign FAIL: %o",t):(i.classList.add("tna_Tron"),this.div=i,this)}enable(t=!0){if(this.div!=null&&t!=this._enable)return this.div.classList.toggle("disable",!t),this._enable=t,this}async write(t,i=this.holdTime){this.div!=null&&(clearTimeout(this.hideTimeout),this.div.innerText=t,this.div.classList.add("show","prime"),this.state=!0,this.hideTimeout=setTimeout(this.writeEnd.bind(this),i*1e3),this.onPrime!=null&&this.onWrite(this,STAGE.BEGIN))}async writeEnd(){this.state=!1,this.hideTimeout=void 0,this.div.classList.remove("show"),this.div.ontransitionend=()=>{this.div.classList.remove("prime"),this.onPrime!=null&&this.onWrite(this,STAGE.END),this.div.ontransitionend=void 0}}writeDelay(t,i=this.holdTime,n=this.delayTime){this.div!=null&&(clearTimeout(this.showTimeout),this.state?(this.div.innerText=t,this.write(t,i)):this.showTimeout=setTimeout(this.write.bind(this),n*1e3,t,i))}cancel(){clearTimeout(this.showTimeout)}kill(){this.cancel(),this.writeEnd()}add(t){return t.onTron=i=>this.write(i),this}setHold(t=es){return this.holdTime=t,this}setDelay(t=is){return this.delayTime=t,this}}var ns=new ss;class as extends X{constructor(){r.prefID.indexOf("ux_index")<0&&console.warn("tna_UX constructor FAIL, cannot find prefID");super("ux_index","object");a(this,"_lastIndex");a(this,"_lastDialog");a(this,"_nextDialog");a(this,"_currentDialog");this.link("pref")}set(t){const i=t.v;if(this._lastIndex!=i&&(this._nextDialog=r.getDialogByIndex(i),this._lastDialog=r.getDialogByIndex(this._lastIndex),this._nextDialog!=null)){this.tron&&this._lastDialog!=null&&`${this._lastDialog.id}`,this._lastDialog!=null&&this.last.exit(),this._nextDialog.begin(),this._lastIndex=this._val=i,this._currentDialog=this._nextDialog,super.set(t);return}}get last(){return this._lastDialog!=null?this._lastDialog:{id:"NULL"}}get lastID(){return this._lastDialog!=null?this._lastDialog.id:void 0}get next(){return this._nextDialog}get current(){return this._currentDialog}get currentID(){return this._currentDialog!=null?this._currentDialog.id:void 0}}const os='<div id="region" class="region"></div>',rs=`
    <svg id="svg" viewBox="0 0 12 13.8" class="digit">
      <g id="a" class="seg">
        <polygon points="9.76 0 10.03 0.31 8.66 1.5 4.33 1.5 3.31 0.34 3.7 0 9.76 0"/>
      </g>
      <g id="b" class="seg">
        <polygon points="10.63 1 9.96 5.77 9.07 6.55 8.44 5.82 8.99 1.88 10.36 0.69 10.63 1"/>
      </g>
      <g id="c" class="seg">
        <polygon points="7.57 11.97 8.13 8.03 9.02 7.25 9.65 7.98 8.97 12.8 8.58 13.14 7.57 11.97"/>
      </g>
      <g id="d" class="seg">
        <polygon points="2.86 12.3 7.19 12.3 8.21 13.46 7.82 13.8 1.76 13.8 1.49 13.49 2.86 12.3"/>
      </g>
      <g id="e" class="seg">
        <polygon points="0.89 12.8 1.56 8.03 2.45 7.25 3.08 7.98 2.53 11.92 1.16 13.11 0.89 12.8"/>
      </g>
      <g id="f" class="seg">
        <polygon points="2.5 6.55 1.87 5.82 2.55 1 2.94 0.66 3.95 1.83 3.39 5.77 2.5 6.55"/>
      </g>
      <g id="g" class="seg">
        <polygon points="8.06 6.15 8.69 6.88 7.8 7.65 3.46 7.65 2.83 6.92 3.72 6.15 8.06 6.15"/>
      </g>
      <g id="dp" class="seg"><circle cx="10.77" cy="13.05" r="0.75" /></g>
    </svg>`,ls=`<svg id="svg" viewBox="0 0 12.47 13.8" class="colon">
    <g class="seg" transform="translate(0.2 0)">
      <circle cx="1.72" cy="3.45" r="0.75" />
      <circle cx="0.75" cy="10.35" r="0.75" />
    </g>
  </svg>`;var Xt={HTML:os,DIGIT:rs,COLON:ls};class ds extends X{constructor(t){super(t);a(this,"_primeD",!1);a(this,"_primeN",0);a(this,"_bright",0);a(this,"digits",[]);a(this,"onPrime");this.fuse(),this.link("info"),this.div.insertAdjacentHTML("beforeend",Xt.HTML),this.div.classList.add("tna_Retro7"),this.dRegion=this.getDiv("region");for(let n=0;n<4;n++){this.dRegion.insertAdjacentHTML("beforeend",Xt.DIGIT);const o=this.dRegion.querySelector("#svg");o.id=`svg_${this.digits.length}_${this.id}`,o.style.setProperty("--retro-i",n),this.digits.push(o)}this.dRegion.insertAdjacentHTML("beforeend",Xt.COLON);const i=this.dRegion.querySelector("#svg");i.id=`colon_${this.id}`,this.divColon=i.children[0]}print(t){for(let i=0;i<4;i++)this.digitRaw(i,t[i])}digitRaw(t,i){let n=this.digits[t].children;for(let o=0;o<8;o++){const l=i>>o&1;n[o].classList.toggle("show",l)}}colon(t=2){this.divColon.classList.toggle("show",t==2)}clear(){this.print([0,0,0,0]),this.colon(!1),this.onChange!=null&&this.onChange(this,this._val)}async reset(){this._primeD=!1,this._primeN=0,this.view(!1),await this.delay(500),this.clear(),this.prime(!1)}async set(t){if(this._val=t.v,!this._primeD&&(this.onBegin!=null?this.onBegin(this):this.show(),this._primeN<2)){let i=0;for(let n=0;n<t.v.length;n++)i+=t.v[n];i>0&&this._primeN++,this._primeN=Math.min(this._primeN,2),this._primeN>1&&this.onPrime!=null&&this.onPrime(this)}this.print(t.v),this.colon(t.v[4]),this.onChange!=null&&this.onChange(this,t)}bright(t=0){return this._bright=t,this.div.classList.toggle("dim",t==0),this}}const Pe="3.1.05",Oe={}.VITE_PREFLIGHT==="true",hs={}.VITE_EXT_SERVE==="true";Oe||console.warn("core PREFLIGHT: %o",!1);const S={},R={preflight:Oe,modeExt:hs,modeAP:!1,prime_local:!1},q={},yt={},ct={},Z={};let Tt,Me,N,B,Rt,j,te=!1;function cs(){ns.assign("tron_output"),ps(),us(),S.title=N=new z("head_title"),N.div.classList.add("click"),N.div.onclick=()=>{let e=yt.title!=null?yt.title():!1;e=e==null?!1:e,e||console.log("core title click default")},N.fuse().shy(!(R.modeExt||!Rt)).view(),fs(),window.diag_client.innerText=F.versionString(Pe);const s=String(document.location);R.local=s.includes("host:")||s.includes("local:"),Tt=new A("developFPO","object"),Tt.onDefault=()=>R.prime_local=!0,F.initStorage("develop",Tt),R.develop=Tt.value,S.ux=Me=new as().tron(),st.init()}function fs(){window.socket!=null&&(j=new I("socket").prime().show().enable(),j.symbol("x").symbol("o"),j.value=!0,j.index=1,j.onExecute=s=>{s.toggle(),s.index=s.value,m.monitor(s.value),s.value?m.init():m.kill()},S.socket_button=j)}function us(){R.modeExt||(Rt=window.info_display!=null,Rt&&(S.retro=B=new ds("info_display"),B.ext_no_prime=!0,B.ext_view=void 0,B.onBegin=s=>{},B.onRender=(s,e)=>{const t=e!=null?e:s._view;s.ext_view!=t&&(s.ext_view=t,s.div.classList.toggle("click",t),s._view&&s.shy(!1))},B.div.onclick=gs))}function gs(){let s=yt.retro!=null?yt.retro():!1;s=s==null?!1:s,s||(console.log("RD click default, ux:",Me.currentID),m.send("save","clock_disp",-1))}function ps(){if(window.rc_ind==null||R.user==0)return;const s=new A("info_rc","object");it.upon.msg=(e=it.prop.last_format)=>{const t=R.user!=null?R.user:0;S.rc_ind.view(e!=it.formatID.indexOf("touch")&&t)},s.onChange=(e,t)=>{it.upon.msg(t.v)},S.rc_ind=new tt("rc_ind").symbol("dot").def(),S.rc_ind.onExecute=async e=>{e.choreo("blink","hot").timing(3,150).act(),e.onAnimEnd=()=>st.hyper("/rc/")}}let ue=!1;async function le(){for(const[s,e]of Object.entries(S))e.ext_no_prime==null&&e.prime();if(Rt)N.shy(!1);else return le=!0;ue||await F.delay(1250),N.view(!1),N.div.classList.add("slide"),window.head.classList.add("gradient"),S.retro.prime(),S.retro.shy(!1),await F.delay(250),S.retro.view(),N.shy(),N.div.classList.remove("slide"),ue=!0,Re()}function Fe(){te=!1,st.tna.badge.div.classList.add("connect","prime"),st.tna.dot.viewStaged(!1),j!=null&&(j.index=1),q.open!=null&&q.open()}async function ee(){te||(te=!0,st.tna.badge.div.classList.add("prime"),st.tna.badge.div.classList.remove("connect"),st.tna.dot.view(!0),window.head.classList.remove("gradient"),await F.delay(250),B!=null&&B.reset(),j!=null&&j.def(),q.close!=null&&q.close(),N.shy(!1),await F.delay(250),N.view())}function _s(){m.onOpen(Fe),m.onClose(ee),new A("info_install","object").onChange=(t,i)=>{t.ext_prime==null&&(ct.display=(i.v&r.hwMask.display)>>r.hwOffset.display,ct.piezo=(i.v&r.hwMask.piezo)>>r.hwOffset.piezo,ct.xpio=(i.v&r.hwMask.xpio)>>r.hwOffset.xpio,ct.gps=(i.v&r.hwMask.gps)>>r.hwOffset.gps,i.z,Z.display=(i.z&r.hwMask.display)>>r.hwOffset.display,Z.piezo=(i.z&r.hwMask.piezo)>>r.hwOffset.piezo,Z.xpio=(i.z&r.hwMask.xpio)>>r.hwOffset.xpio,Z.gps=(i.z&r.hwMask.gps)>>r.hwOffset.gps,Object.keys(Z).forEach(function(n,o){Z[n]||document.querySelectorAll("._"+n).forEach(c=>c.style.display="none")}))},new A("call_prime","object","call").onChange=t=>{le(),t.ext_prime==null&&(q.prime!=null&&q.prime(ct,Z),t.ext_prime=!0)},S.user=new A("info_user","object"),S.user.onChange=t=>{R.user=t.data.v,st.access(R.user),q.user!=null&&q.user(t.data)};let s=new A("call_restart","object","call");s.onChange=async t=>{it.bold("system ESP restart"),ee(),await t.delay(1e3),m.send("ping")};let e=new A("call_warn","object","call");if(e.onChange=(t,i)=>{let n=parseInt(i.v);n=n<r.warnID.length?n:-1;let o;n>=0&&(o=r.warnID[n]),o!=null&&console.error(`system warning ${o}`)},B!=null&&r.getControlByID("ui_bright")==null){const t=new A("ui_bright","object","pref");t.onChange=(i,n)=>B.bright(n.v),S[t.id]=t}}function Re(s=R.user){let e=document.querySelectorAll("._admin");e.forEach(t=>t.style.display=s?"":"none"),e=document.querySelectorAll("._admin_alt"),e.forEach(t=>t.style.display=s?"none":"inherit")}var x={tna:S,prop:R,upon:q,click:yt,version:Pe,install:ct,activate:Z,init:cs,prime:le,open:Fe,close:ee,patch:_s,admin:Re};let At=!1,lt=!1,Ae=!1,rt,Ne,ie,se;const vs=`ws://${window.location.hostname}/ws`;let J,wt=!1;function de(){At||(At=!0,J=new WebSocket(vs),J.onopen=bs,J.onclose=ys,J.onmessage=Ne,lt=!1,rt=clearTimeout(rt))}function ms(s){s!=wt&&(console.log(`socket monitor b:${s} state:${lt}`),wt=s,s&&(!lt&&rt==null?de():rt=clearTimeout(rt)))}function He(){return lt=(J!=null?J.readyState:ge.closed)==ge.connected,lt}function bs(){console.warn("socket open"),lt=!0,ie!=null&&ie()}function ys(){console.error(`socket close, squelch:${Ae} check:${wt}`),At=!1,lt=!1,se!=null&&se(),wt&&(clearInterval(rt),rt=setTimeout(de,1e3))}function ws(){console.warn("socket kill"),J&&J.close(),Ae=!0,At=!1}function ze(s){Ne=s}function xs(s){ie=s}function ks(s){se=s}const ge=Object.freeze({connecting:0,connected:1,closing:2,closed:3});let W=!1;var m={onOpen:xs,onClose:ks,onParse:ze,check:wt,init:de,ready:He,monitor:ms,kill:ws,parse:Ht,sendUX:Ss,sendTune:$s,sendObject:Be,send:je,fakeMessage:Ps,fakeObject:Cs,transmit:Lt,fill:Os,tron:Ls};ze(Ht);function Ls(s=!0){W=s}function Es(s){let e;for(let t in s)e=r.getControlByIndex("info",s[t].i),e!=null?(s.length>1&&(W?console.log(`<< info #${t} %o ${s[t].v}`,e.id):e.id!="info_display"&&W&&console.log(`<< info %o ${s[t].v}`,e.id)),e.set(s[t])):W&&console.log(`parseInfo #${t} no object id %o`,r.infoID[s[t].i])}function Ds(s){for(let e in s){const t=s[e].i,i=r.getControlByIndex(t<r.prefBase?"admin":"pref",t);i!=null?(W&&(s.length>1?console.log(`<< pref #${e} ${i.id} ${s[e].v}`):console.log(`<< pref ${i.id} ${s[e].v}`)),i.sync(s[e])):W&&console.log(`parseSync #${e} no object id %o`,t)}}function Ts(s){for(let e in s){const t=r.getControlByIndex("call",s[e].i);t!=null&&t.set(s[e])}}function Is(s){for(let e in s){const t=s[e],i=r.getControlByIndex("ux",t.i);if(i!=null){if(t.s<0)return console.warn("parseUX FAIL bad stage value %o",r.stageID[t.v]);i.parse(t)}else W&&console.log("parsUX no object %o",r.infoID[t.i])}}function Ht(s){let e=JSON.parse(s.data),t=r.actionID[e.a],i=e.t;switch(t){case"call":Ts(i);break;case"ux":Is(i);break;case"info":Es(i);break;case"sync":Ds(i);break}}function Ss(s,e,t){const i="ux",n=r.uxID.indexOf(s);if(n<0)return console.warn("sendUX FAIL no dialog %o",s);const o={i:n},l=r.stageID.indexOf(e);l>=0&&(o.v=l),t!=null&&(o.x=t);const c={a:r.actionID.indexOf(i),t:[o]};Lt(c,`${i} >>`)}function $s(s="default"){const e="call",t=r.tuneID.indexOf(s);if(t<0)return console.warn("sendTune FAIL no melody %o",s);r.callID.indexOf("call_tune");const i={a:r.actionID.indexOf(e),t:[{i:r.callID.indexOf("call_tune"),v:t}]};Lt(i,`${e} >>`)}function Be(s,e,t){const i=r.actionID.indexOf(s);if(i<0)return console.log("sendObject FAIL no action %o",s);let n={a:i,t:[]},o={i:r.getPrefID(e)};return Object.assign(o,t),n.t.push(o),Lt(n,`${s} >>`),n}function Cs(s,e,t){const i=Be(s,e,t);if(typeof i=="object"){const n=new CustomEvent("meh");n.data=JSON.stringify(i),Ht(n)}}function je(s,e,t){let i=r.actionID.indexOf(s);if(i<0){W&&console.log("send FAIL no action %o",s);return}let n={a:i,t:[]},o=-1;switch(s){case"push":case"save":case"sync":o=r.getPrefID(e);break;case"call":o=r.callID.indexOf(e);break;case"ping":o=t=0}if(o<0){W&&console.log("send FAIL no id %o in action %o",e,s);return}return n.t.push({i:o,v:t|0}),Lt(n,`${s} >>`),n}function Ps(s,e,t){const i=je(s,e,t);if(typeof i=="object"){const n=new CustomEvent("meh");n.data=JSON.stringify(i),Ht(n)}}function Lt(s,e){const t=JSON.stringify(s);W&&console.log(`${e} ${t}`),He()&&J.send(t)}async function Os(s,e,t){let i={};if(x.prop.preflight)try{const n=await fetch(e,{method:"GET"});if(n.status===200)i=await n.json();else throw new Error(`${e} FAIL fetch code:${n.status}`)}catch(n){console.warn(`${e} FAIL, use test data`,n),Object.assign(i,t)}else console.warn(`${e} !preflight, use test data`),Object.assign(i,t);console.groupCollapsed(`comm fill ${e}`),console.log(i),console.groupEnd(),Object.assign(s,i)}const Ot=Math.floor(new Date().getTime()/1e3);r.actionID.indexOf("info"),r.infoID.indexOf("info_hardware"),r.infoID.indexOf("info_mfg"),r.infoID.indexOf("info_reg");const Ms={a:r.actionID.indexOf("info"),t:[{i:r.infoID.indexOf("info_rc"),v:4},{i:r.infoID.indexOf("info_install"),v:r.hwMask.display+r.hwMask.piezo+r.hwMask.xpio+r.hwMask.gps+0,z:r.hwMask.display+r.hwMask.piezo+r.hwMask.xpio+r.hwMask.gps+0},{i:r.infoID.indexOf("info_user"),v:1},{i:r.infoID.indexOf("info_firmware"),v:"8.8.88"},{i:r.infoID.indexOf("info_uptime"),v:Ot-3600*24*99},{i:r.infoID.indexOf("info_net"),v:"expresso",p:"8C:CE:4E:D5:36:9D",q:"192.168.2.100"},{i:r.infoID.indexOf("info_rssi"),v:"-78"},{i:r.infoID.indexOf("info_status"),v:r.serviceID.indexOf("GPS"),g:1,n:1},{i:r.infoID.indexOf("info_tap"),v:4,m:884,c:4},{i:r.infoID.indexOf("info_gps"),t:Ot,d:1200,v:13,max:12,min:12,rec:22},{i:r.infoID.indexOf("info_ntp"),v:0,s:Ot,f:28,p:64,e:0,r:60*30},{i:r.infoID.indexOf("info_display"),v:[0,0,0,0,0]}]},Fs={a:r.actionID.indexOf("sync"),t:[{i:r.getPrefID("net_alert"),v:1},{i:r.getPrefID("ui_bright"),v:0,x:5},{i:r.getPrefID("ui_sound"),v:1},{i:r.getPrefID("tap_mode"),v:0},{i:r.getPrefID("tap_tilt"),v:1},{i:r.getPrefID("tap_alert"),v:0},{i:r.getPrefID("tap"),v:7,t:1023},{i:r.getPrefID("gps_alert"),v:0},{i:r.getPrefID("gps_log_int"),v:1200},{i:r.getPrefID("clock_static"),v:1},{i:r.getPrefID("clock_disp"),v:r.clockID.indexOf("CLOCK_HHMM")},{i:r.getPrefID("clock_24h"),v:0},{i:r.getPrefID("clock_tz"),v:-6},{i:r.getPrefID("clock_dst"),v:1},{i:r.getPrefID("clock_pps"),v:0},{i:r.getPrefID("daily"),v:1,h:9,m:32},{i:r.getPrefID("daily_vol"),v:1},{i:r.getPrefID("daily_ind"),v:1},{i:r.getPrefID("daily_snooze"),v:1},{i:r.getPrefID("ux_index"),v:r.uxID.indexOf("clock_static")}]},Rs={i:r.infoID.indexOf("info_gps_log"),t:Ot-200,d:1200,n:53,max:[13,12,13,15,15,13,13,16,16,16,15,14,15,17,14,15,14,13,14,13,13,13,14,13,14,13,13,14,12,14,14,14,13,13,14,16,17,17,16,16,15,15,16,16,16,15,14,14,13,12,12,11,10],min:[7,8,8,7,8,8,8,10,9,9,10,10,9,10,9,8,7,7,8,9,7,9,10,9,7,7,6,5,7,6,8,8,8,9,9,10,12,13,11,9,8,9,10,10,9,11,9,8,6,5,0,7,6]},As={a:r.actionID.indexOf("info"),t:[{i:r.infoID.indexOf("info_display"),v:[127,127,127,127,2]}]},Ns={a:r.actionID.indexOf("info"),t:[{i:r.infoID.indexOf("info_display"),v:[120,121,109,120,0]}]},Hs={a:r.actionID.indexOf("call"),t:[{i:r.callID.indexOf("call_prime"),v:0}]};function zs(){const s=x.prop.local?500:75;setTimeout(async()=>{if(m.ready())return;x.open(),console.log("%ccomm test",it.style.test,"info + sync");const e=new CustomEvent("meh");e.data=JSON.stringify(Ms),m.parse(e),e.data=JSON.stringify(Fs),m.parse(e),await F.delay(75),e.data=JSON.stringify(Hs),m.parse(e)},s),setTimeout(()=>{if(m.ready())return;console.log("%ccomm test",it.style.test,"display");const e=new CustomEvent("meh");e.data=JSON.stringify(As),m.parse(e)},s*2),setTimeout(()=>{if(m.ready())return;const e=new CustomEvent("meh");e.data=JSON.stringify(Ns),m.parse(e)},s*3)}var Bs={init:zs};let bt;function js(){document.body.insertAdjacentHTML("beforeend",'<svg height="0" width="0" style="visibility: hidden"></svg>'),bt=document.body.lastChild}function Vs(s,e){bt.insertAdjacentHTML("beforeend",'<symbol id="" viewBox="0 0 100 100"></symbol>'),bt.lastChild.id="sym_"+s,bt.lastChild.innerHTML=e}function Ws(s){bt.insertAdjacentHTML("beforeend",s)}js();var p={add:Vs,def:Ws};function Xs(){p.add("warn_ui",`<g stroke-width="12" stroke-linecap="round" stroke-linejoin="round" >  
      <polygon stroke="var(--icon-fg)" fill="var(--icon-fg)" points="50 12.69 7.5 86.31 92.5 86.31 50 12.69" />
      <g>
        <polyline stroke="var(--icon-bg)" fill="none" points="50 55 50 32" />
        <circle fill="var(--icon-bg)" stroke="none" cx="50" cy="78" r="7" />
      </g>    
    </g>`),p.add("warn_text",`<g stroke="var(--icon-fg)" fill="none">
      <path stroke-width="6px" stroke-linejoin="round" d="M66,91.39H90.59A6.2,6.2,0,0,0,96,82.08L55.37,11.78a6.2,6.2,0,0,0-10.74,0L4,82.08a6.2,6.2,0,0,0,5.37,9.31H34" />    
      <polyline stroke-width="14px" points="50 73 50 55.5 50 38" />
      <polyline stroke-width="14px" points="50 94.5 50 80.5" />
    </g>`),p.add("hit",`<defs>
      <radialGradient id="grad">
        <stop offset="0%" stop-color="rgb(0,0,0,1)" />
        <stop offset="33%" stop-color="rgb(0,0,0,0.3)" />
        <stop offset="90%" stop-color="transparent" />
      </radialGradient>
    </defs>
    <g transform="translate(50 50)">
      <circle fill="url('#grad')" stroke-width="4px" stroke="var(--icon-bg)" cx="0" cy="0" r="48" />
    </g>`),p.add("halo",`<g transform="translate(50 50)">
      <circle fill="none" stroke-width="4px" stroke="var(--icon-fg)" cx="0" cy="0" r="48" />
    </g>`),p.add("show",`<g fill="var(--icon-fg)">
      <path d="M100,50C89.32,65.16,69,78,50,78S10.68,65.16,0,50C10.68,34.84,31,22,50,22S89.32,34.84,100,50ZM50,31A19,19,0,1,0,69,50,19,19,0,0,0,50,31Zm0,9A10,10,0,1,0,60,50,10,10,0,0,0,50,40Z" />
    </g>`),p.add("hide",`<g fill="var(--icon-fg)" stroke="none">
      <path d="M100,50C89.32,65.16,69,78,50,78S10.68,65.16,0,50C10.68,34.84,31,22,50,22S89.32,34.84,100,50ZM89.82,50C79.39,38.17,63.45,30,50,30S20.62,38.17,10.19,50C20.62,61.83,36.55,70,50,70S79.39,61.83,89.82,50Z" />
      <circle cx="50" cy="50" r="14" />
    </g>
    <g stroke-linecap="butt" transform="translate(50 50) rotate(45)">
      <line stroke="var(--icon-bg)" stroke-width="16" x1="-40" y1="0" x2="40" y2="0" />
      <line stroke="var(--icon-fav)" stroke-width="5" x1="-50" y1="0" x2="50" y2="0" />
    </g>`),p.add("wifi_def",`<g fill="none">
      <circle stroke="var(--icon-fg)" stroke-width="16" cx="0" cy="0" r="8"></circle>
      <circle stroke="var(--icon-fg)" stroke-width="8" cx="0" cy="0" r="32"></circle>
      <circle stroke="var(--icon-fg)" stroke-width="8" cx="0" cy="0" r="52"></circle>
   </g>`),p.add("wifi",`<g transform="translate(50, 84) rotate(-135) scale(1.25)">
      <use href="#sym_wifi_def" />
    </g>`),p.add("info",`<g stroke="var(--icon-fg)" fill="none">
      <circle stroke-width="5" cx="50" cy="50" r="47.5"></circle>
      <g stroke-width="16" transform="translate(11) skewX(-12)">
        <line x1="50" y1="82" x2="50" y2="44" />
        <line x1="50" y1="34" x2="50" y2="18" />
      </g>
    </g>`),p.add("help",`<g transform="translate(50 50)" stroke="none">
      <path d="M8.6,33.2H-8.6V23.6H8.6Zm12-60.4H-20.6c-5,0-10.3,3.6-10.3,8.3v8.8h16.5v-10H14.4v18H.7c-5.6,0-9.3,3.5-9.3,9.4v9.1H8.6V7.9c0-2.7,1-3.3,3.7-3.3h8.3C25.2,4.6,30.9.8,30.9-4V-18.9C30.9-23.6,25.6-27.2,20.6-27.2Z" /> 
    </g>`),p.add("help_button",`<g>
      <use href="#sym_halo" />
      <use href="#sym_help" />
    </g>`),p.add("tap",`<g>
      <polygon fill="var(--icon-fg)" stroke="none" points="86.76 0 66.96 0 49.87 17.09 32.84 0 13.08 0 49.85 36.91 86.76 0" />
      <g stroke="var(--icon-fg)">
        <line stroke-width="14px" y1="50" x2="100" y2="50" />
        <g stroke-width="10px" >
          <line class="cls-3" x1="50" y1="100" x2="50" y2="77" />
          <line class="cls-3" x1="14.64" y1="85.36" x2="30.91" y2="69.09" />
          <line class="cls-3" x1="85.36" y1="85.36" x2="69.09" y2="69.09" />
        </g>
      </g>
    </g>`),p.add("twirl",`<g fill="var(--icon-fg)" stroke="none">
    <polygon points="0,88 100,88 50,0"/>
  </g>`),p.add("refresh",`<g stroke="var(--icon-fg)" transform="translate(50 50)" fill="none" style="stroke-miterlimit:10;">
      <polyline points="3.536 52.75 19.036 37.25 34.536 52.75" transform="translate(-49.75 -48)" />
      <path d="M0-31A31,31,0,0,1,31,0,31,31,0,0,1,0,31,31,31,0,0,1-31,0a31.041,31.041,0,0,1,1.206-8.593" />
    </g>`),p.add("refresh_run",`<g stroke="var(--icon-fg)" transform="translate(50 50)" fill="none" style="stroke-miterlimit:10;">
      <path d="M0-31A31,31,0,0,1,31,0,31,31,0,0,1,0,31,31,31,0,0,1-31,0a31.041,31.041,0,0,1,1.206-8.593" />
    </g>`),p.add("undo",`<g transform="scale(-1 1) translate(-100 0)" stroke="var(--icon-fg)" stroke-width="8" fill="none">
      <polyline points="46.21 53.21 30 37 46.21 20.79" />
      <path d="M33,79H60.48a21,21,0,1,0,0-42H30" />
      <line x1="18" y1="18" x2="18" y2="56" />
    </g>`),p.add("dot",`<g transform="translate(50, 50)">
      <circle fill="var(--icon-fg)" cx="0" cy="0" r="50"></circle>
    </g>`),p.add("o",`<g transform="translate(50, 50)">
      <circle stroke="var(--icon-fg)" stroke-width="22" fill="none" cx="0" cy="0" r="39"></circle>
    </g>`),p.add("x",`<g stroke="var(--icon-fg)" stroke-width="22">
        <line x1="12" y1="12" x2="88" y2="88"></line>
        <line x1="12" y1="88" x2="88" y2="12"></line>
    </g>`),p.add("bar_1",`<g transform="translate(0, 0)">
      <line stroke="var(--icon-fg)" stroke-width="22" x1="50" y1="0" x2="50" y2="100"></line>
    </g>`),p.add("bar_2",`<g stroke="var(--icon-fg)" stroke-width="22" transform="translate(0, 0)">
      <line x1="20" y1="0" x2="20" y2="100"></line>
      <line x1="80" y1="0" x2="80" y2="100"></line>
    </g>`),p.add("vol_wave_0",`<g transform="translate(0, 0)">
      <g transform="scale(0.5) translate(100, 50)">
        <use href="#sym_x" />
      </g>
    </g>`),p.add("vol_wave_1",`<g transform="translate(0, 0)">
      <path stroke="var(--icon-fg)" stroke-width="10" fill="none" d="M62.7,31.63a28.5,28.5,0,0,1-.45,36.29"/>
     </g>`),p.add("vol_wave_2",`<g transform="translate(0, 0)">
      <use href="#sym_vol_wave_1" />
      <path stroke="var(--icon-fg)" stroke-width="12" fill="none" d="M80.21,14.44a52.94,52.94,0,0,1-.06,71.07"/>
     </g >`),p.add("lock",`<g>
      <path transform="translate(62 55)" stroke-width="12" stroke="var(--icon-fg)" fill="none" d="M-20,0V-22c0-12.15,8.954-22,20-22H0c11.046,0,20,9.85,20,22V0"/>
      <rect fill="var(--icon-fg)" stroke="none" x="25" y="50" width="75" height="50" />
      </g>`),p.add("unlock",`<g>
      <path transform="translate(25 50)" stroke-width="12" stroke="var(--icon-fg)" fill="none" d="M-20,0V-22c0-12.15,8.954-22,20-22H0c11.046,0,20,9.85,20,22V0"/>
      <rect fill="var(--icon-fg)" stroke="none" x="25" y="50" width="75" height="50" />
    </g>`),p.add("bell",`<g transform="translate(5 10)" stroke-width="10" stroke="var(--icon-fg)" fill="none">
      <g transform="translate(-7 -9.73)">
        <path d="M60.59,74a11,11,0,1,1-21.18,0Z" />
        <path d="M79,73,68.5,33.16C67.31,29,63.94,26,59.7,26H40.63a9.42,9.42,0,0,0-8.8,7.12L21.33,73" />
      </g>
      <line x1="43" y1="19.31" x2="43" />
      <line y1="63.27" x2="86" y2="63.27" />
    </g>`),p.add("tna_hex",`<g stroke="var(--icon-fg)" fill="none">
        <polygon points="88.97 72.5 50 95 11.03 72.5 11.03 27.5 50 5 88.97 27.5 88.97 72.5" />
    </g>`),p.add("tna_n",`<g stroke="var(--icon-fg)" fill="none">
        <polyline stroke-linecap="round" stroke-linejoin="round" points="28.71 61.84 28.71 38.16 71.29 61.84 71.29 38.16" />
    </g>`),p.add("tna",`<g>
      <use href="#sym_tna_hex" />
      <use href="#sym_tna_n" />
    </g>`),p.add("warn_tna",`<g fill="var(--icon-fg)" stroke="none" transform="translate(50, 50)">
      <path d="M-17-25.7l-8.2-14.2,4.7-2.7h41l4.7,2.7L17-25.7l16.5,9.5,8.2-14.2L50-25.6l-24.8,43H9.5v-30h-19v30H-25.2L-50-25.6l8.3-4.8,8.2,14.2Zm22.5,52h-11l-9.4,16.3H14.9Z"/>
    </g>`)}Xs();function Gs(){p.add("save_dis",`<radialGradient id="save_dis_grad" >
      <stop offset="0.6" stop-color="var(--G-force-g1)" />
      <stop offset="1" stop-color="var(--G-force-g2)" />
    </radialGradient>
    <g transform="translate(50 50) scale(0.74)">
      <circle fill="url('#save_dis_grad')" cx="0" cy="00" r="48" />
    </g>`),p.add("save",`<g stroke="var(--icon-fg)" stroke-width="8" fill="none">
      <polyline points="44.29 35.29 59 50 44.29 64.71" />
      <line x1="59" y1="50" x2="19" y2="50" />
      <path d="M28.08,71.92a31,31,0,1,0,0-43.84" />
      <path d="M50,50" />
    </g>`),p.add("restart",`<g stroke="var(--icon-fg)" stroke-width="8" fill="none">
      <polyline points="3.52 44.18 23.37 32.72 34.83 52.57" />
      <path d="M50,48V16" />
      <path d="M24.58,32.25" />
      <path d="M65.19,23a31,31,0,1,1-40.61,9.28" />
    </g>`)}Gs();const Us=`<div id="region" class="region">
    <div id="bg" class="bg">
      <div id="action" class="action"></div>
    </div>
    <div id="label_wrap" class="label_wrap">
      <div id="label" class="label"></div>
    </div>
    <div id="status_wrap" class="status_wrap">
      <div id="status" class="status"></div>
      <div id="status_icon" class="status_icon"></div>
    </div>
  </div>`;class ne extends X{constructor(t,i="pref"){super(t);a(this,"_label");a(this,"_status");a(this,"iStatus");a(this,"onExecute");this.link(i),this.div.insertAdjacentHTML("beforeend",Us),this.div.classList.add("tna_Button","disable"),this.dRegion=this.getDiv("region"),this.dBg=this.getDiv("bg"),this.dAction=this.getDiv("action"),this.dLabel=this.getDiv("label_wrap"),this.dLabelVal=this.getDiv("label"),this.dStatusW=this.getDiv("status_wrap"),this.dStatus=this.getDiv("status"),this.dIconStatus=this.getDiv("status_icon"),this.label=this.getDataAttr("label","string",""),this.enable(this.div.dataset.enable!=null)}icon(){this.dStatus.classList.add("alt");const t=new tt(this.dIconStatus).static().prime();return this.iStatus=t,this}enable(t=!0){if(t!=this._enable)return this._enable=t,this.enablePrime(),this}async enablePrime(){this._enable||(this.div.onclick=null);const t=500;this.div.classList.toggle("disable",!this._enable),this.dRegion.style.transition=t+"ms",await this.delay(t),this.dRegion.style="",this._enable&&(this.div.onclick=this.execute.bind(this))}execute(t){t.preventDefault(),t.stopImmediatePropagation();let i;this.onExecute!=null&&(i=this.onExecute(this)),i=i==null?!0:i,i&&this.confirm()}confirm(){this.div.classList.add("confirm"),this.dAction.onanimationend=this.confirmEnd.bind(this)}confirmEnd(t){this.div.classList.remove("confirm"),this.dAction.onanimationend=void 0}shuffleIcon(t=!0){const i=t?"beforeend":"afterbegin";return this.dStatusW.insertAdjacentElement(i,this.dIconStatus),this.dStatus.classList.toggle("alt",t),this}displayIcon(t=!0){return this.iStatus.display(t),this.dStatus.classList.toggle("alt",t),this}set label(t){this._label=t,this.dLabelVal.innerHTML=t}set status(t){this._status=t,this.dStatus.innerHTML=t}}const qs=`<div id="region" class="region">
    <div id="thumb" class="thumb"></div>
  </div>`;class C extends X{constructor(t,i="pref"){super(t);a(this,"_invert",!1);a(this,"onExecute");a(this,"onChange");a(this,"onTron");this.link(i),this.div.insertAdjacentHTML("beforeend",qs),this.div.classList.add("tna_Toggle","disable"),this.dRegion=this.getDiv("region"),this.dThumb=this.getDiv("thumb");let n=parseInt(this.div.dataset.checked);this._val=isNaN(n)?0:n;const o=this.div.dataset.value;o!=null&&(console.log(`${this.id} construct data-value:${o}`),this.value=parseInt(o)),this.enable(this.div.dataset.enable!=null),this.draw()}enable(t=!0){return this._enable=t,t?(this.draw(),this.div.onclick=this.execute.bind(this),this.div.classList.remove("disable")):(this.div.onclick=void 0,this.div.classList.add("disable")),this}draw(t=this._val){t=t>0,t^=this._invert,this.div.classList.toggle("check",t)}execute(t){this.toggle(),this.onTron!=null&&this.onTron(`${this.div.id} > end`),this.onExecute!=null?this.onExecute(this,this.value):this.save()}toggle(){return this.set(!this.value),this}set(t){return typeof t!="object"&&(this.value=t),super.set(t),this}set invert(t){this._invert=t}get invert(){return this._invert}}const Js=`<div class="region">
    <div id="label" class="label">X</div>
  </div>`;class Ve extends z{constructor(t,i,n=Js){super(t,"div");a(this,"_index");a(this,"_label");a(this,"_target");a(this,"control");a(this,"bClick");this.control=i,this.div.id=this.id=`${i.id}_item_${i.itemN}`,this._label=this.div.innerHTML,this.div.innerText="",this.div.insertAdjacentHTML("afterbegin",n),this.div.classList.add("tna_Radio_item"),this.dLabel=this.getDiv("label"),this.label=this._label;let o=this.div.querySelector("._click");o==null&&(o=this.div),o._tna_target=this.div,this._target=o,this.bClick=this.click.bind(this),this.enable()}click(t){let i=t.target._tna_target;i==null&&(i=this.parent(t.target,"_item")),this.execute(i),t.preventDefault(),t.stopImmediatePropagation()}execute(t){this.control.last=this,this.control.execute(this),this.control.view(!1)}enable(t=!0){return this.enabled=t,this.div.classList.toggle("enable",t),this._target.onclick=t&&!this._static?this.bClick:null,this._target.style.pointerEvents=t&&!this._static?"":"none",this}highlight(t=!0){this.div.classList.toggle("act",t);const i=t&&this._index==0&&!this.control.attrOff;return this.div.classList.toggle("off",i),this.enable(!t||this.control._persist),this}set label(t){this.dLabel.innerText=t}}const Ys=`<div id="region" class="region">
    <div id="bg" class="bg"></div>
    <div id="rule" class="rule"></div>
    <div id="cursor" class="cursor"></div>
    <div id="panel" class="panel"></div>
  </div>`;class xt extends X{constructor(t){super(t);a(this,"_primed",!1);a(this,"_persist",!1);a(this,"_rule");a(this,"_ruleLimit");a(this,"_itemN",0);a(this,"_defP");a(this,"_itemDef",Ve);a(this,"list",[]);a(this,"listR",[]);a(this,"last");a(this,"onChange");a(this,"onExecute");this.link("pref"),this.div.insertAdjacentHTML("afterbegin",Ys),this.div.classList.add("tna_Radio"),this.dRegion=this.getDiv("region"),this.dBg=this.getDiv("bg"),this.dRule=this.getDiv("rule"),this.dCursor=this.getDiv("cursor"),this.dPanel=this.getDiv("panel"),this._defP=this.getPropVal("--radio-p"),this._rule=this.div.dataset.rule!=null,this._ruleLimit=this.div.dataset.ruleLimit!=null,this.attrOff=this.div.dataset.radioOff!=null,this.enable(this.div.dataset.enable!=null),this.dCursor.style.left=0}init(t){for(let i=0;i<t;i++){const n=document.createElement("div");this.div.appendChild(n)}return this.merge(),this}prime(){return this._primed=!0,this}merge(){const t=this.div.childElementCount;this.setProp("--radio-n",t-1);for(let i=1;i<t;i++){const n=this.div.children[1];this.create(n).touchPrime(),this.dPanel.insertAdjacentElement("beforeend",n)}return this.rule(),this}create(t){const i=new this._itemDef(t,this),n=`${this.id}_item_${this._itemN}`;return t.id=i.id=n,i._index=this._itemN,this.list.push(i),this._itemN++,i}rule(t=this._rule){if(t)for(let i=0;i<=this._itemN;i++){const n=document.createElement("div");this.dRule.appendChild(n),this.listR.push(n),this.dRule.classList.toggle("limit",this._ruleLimit)}return this}index(t){if(this.list.forEach(i=>i.highlight(!1)),t>=0&&this.list[t].highlight(),this._primed&&(this.dCursor.style.transition="left 0.25s"),this.dCursor.style.left=`calc(${this._defP}px + ${t/this._itemN*100}%)`,this.dCursor.style.opacity=1,this._val=t,this.dCursor.classList.toggle("solid",t!=0||this.attrOff),this._rule)for(let i=0;i<=this._itemN;i++){const n=t==i||t+1==i;this.listR[i].classList.toggle("show",!n)}return this}execute(t){this.index(t._index),this.onChange!=null&&this.onChange(this),this.onExecute!=null&&this.onExecute(this),this.push()}set(t=this._val){return this.index(this._val),super.set(this._val),this}enable(t=!0){if(t!=this._enable)return this._enable=t,this.div.classList.toggle("disable",!t),this}persist(t=!0){return this._persist=t,this}label(t){return this.list[t].dLabel}}const Zs=`<div id="region" class="region">
    <div id="strip" class="strip">
      <div id="fade" class="fadeW">
        <div class="fade"></div>
        <div class="fade R"></div>
      </div>
      <div id="ruler" class="ruler"></div>
      <div id="fill" class="fill"></div>
    </div>
    <div id="hit" class="hit"></div>
    <div id="thumb" class="thumb">
      <div id="divot" class="divot"></div>
      <div id="thumb_fill" class="fill"></div>
    </div>
  </div>`;class K extends X{constructor(t){super(t);a(this,"dLabel");a(this,"_minVal");a(this,"_maxVal");a(this,"_range");a(this,"rulePrime");a(this,"x0");a(this,"val0");a(this,"valTrack");a(this,"lastDraw");a(this,"endDelay",0);a(this,"endTimeout");a(this,"onBegin");a(this,"onEnd");a(this,"onChange");a(this,"onEnable");a(this,"onTron");this.link("pref"),this.div.insertAdjacentHTML("beforeend",Zs),this.div.classList.add("tna_Slide"),this.dThumb=this.getDiv("thumb"),this.dThumbFill=this.getDiv("thumb_fill"),this.dRegion=this.getDiv("region"),this.dHit=this.getDiv("hit"),this.divStrip=this.getDiv("strip"),this.dFill=this.getDiv("fill"),this.dDivot=this.getDiv("divot"),this.dFade=this.getDiv("fade"),this.dRuler=this.getDiv("ruler"),this._attrFill=this.div.dataset.slideFill!=null,this._attrFade=this.div.dataset.slideFade!=null,this._attrRule=this.div.dataset.slideRule!=null,this._attrOff=this.div.dataset.slideOff!=null,this._attrOn=this.div.dataset.slideOn!=null,this.attrFill(),this.attrFade(),this.defH=this.getDataAttr("slideH","pixel"),this.defB=this.getPropVal("--slide-b"),this.thumbW=this.getDataAttr("slideThumbW","pixel"),this.bClick=this.click.bind(this),this.bDragStart=this.dragStart.bind(this),this.bDragEnd=this.dragEnd.bind(this),this.bTrack=this.track.bind(this),this.observer=new ResizeObserver(i=>{const n=i[0].contentRect.width;this.resize(n)}),this.observer.observe(this.div),this.enable(this.div.dataset.enable!=null)}init(t){return this._val=t,this.draw(),this.set(t),this}enable(t=!0){return this._enable=t,t?(this.draw(!0),this.dThumbFill.onmousedown=this.dThumbFill.ontouchstart=this.bDragStart,this.dHit.onclick=this.bClick):(this.draw(!1),this.dThumbFill.onmousedown=this.dThumbFill.ontouchstart=null,this.dHit.onclick=this.bClick,this.dFill.style.width="0px"),this.div.classList.toggle("disable",!t),this.onEnable!=null&&this.onEnable(this),this}resize(t=this.stripW){t!=null&&(this.stripW=t,this.locMax=this.stripW-this.thumbW,this.draw(!0))}draw(t=!1){if(this.lastDraw!=this._val||t){const i=(this._val-this._minVal)*(this.locMax/this._range);this.dThumb.style.left=i+(this.defH-this.thumbW)/2+"px",this._attrFill&&(this.dFill.style.width=i+"px"),this.div.classList.toggle("on",this._attrFill&&!this._attrOff||this._attrOff&&this._attrOn&&this.value!=this._minVal),this.div.classList.toggle("min",this._attrOff&&this.value==this._minVal),this.div.classList.toggle("max",this._attrOn&&this.value==this._maxVal),this.lastDraw=this._val}}click(t){this.incr(t),this.draw(),this.push(),this.onChange!=null&&this.onChange(this),t.preventDefault()}incr(t){const i=isNaN(t.pageX)?t.changedTouches[0].pageX:t.pageX;this.val0=this._val;const n=this.dThumb.getBoundingClientRect();i-n.left>0?this._val++:this._val--,this._val=this._val>this._maxVal?this._maxVal:this._val,this._val=this._val<this._minVal?this._minVal:this._val}start(t){this.primed=!0,this.x0=isNaN(t.pageX)?t.changedTouches[0].pageX:t.pageX,this.lastTime=t.timeStamp,this.val0=this._val,this.valTrack=this._val,this.dThumbFill.classList.add("highlight"),document.addEventListener("mousemove",this.bTrack),document.addEventListener("touchmove",this.bTrack),this.onBegin!=null&&this.onBegin(this),t.preventDefault()}dragStart(t){this.start(t),document.addEventListener("mouseup",this.bDragEnd),document.addEventListener("touchend",this.bDragEnd),this.dThumbFill.style.cursor="grab",t.preventDefault()}track(t){if(!this.primed)return;const n=(isNaN(t.pageX)?t.changedTouches[0].pageX:t.pageX)-this.x0,o=Math.round(n/(this.locMax/this._range));let l=this.val0-this._minVal+o;l=l>this._range?this._range:l,l=l<0?0:l,this._val=l+this._minVal,this.draw(),this.valTrack!=this._val&&(this.valTrack=this._val,this.push(),this.onChange!=null&&this.onChange(this)),t.preventDefault()}dragEnd(t){this.dThumb.onmouseup=this.dThumb.ontouchend=null,document.removeEventListener("mousemove",this.bTrack),document.removeEventListener("touchmove",this.bTrack),document.removeEventListener("mouseup",this.bDragEnd),document.removeEventListener("touchend",this.bDragEnd),this.end(),t.preventDefault()}end(){this.dThumbFill.classList.remove("highlight"),this.dThumb.style.cursor=null,this.dThumbFill.onmousedown=this.dThumbFill.ontouchstart=this.bDragStart,this.primed=!1,this.onTron!=null&&this.onTron(`${this.div.id} > end`),this.onEnd!=null&&(this.endDelay>0?this.endTimeout=setTimeout(this.onEnd,this.endDelay,this):this.onEnd(this)),this.push(),this.jumpFlag=!1}set(t){this.draw(),this.onChange!=null&&this.onChange(this,t),!(this.primed||this.onEnd==null)&&(this.endDelay>0?this.endTimeout=setTimeout(this.onEnd,this.endDelay,this):this.onEnd(this))}range(t,i){this._minVal=t,this._maxVal=i,this._range=i-t;let n=this._val;return n=n>this._maxVal?i:n,n=n<this._minVal?t:n,this._val=n,this.attrRule(),this}attrRule(t=this._attrRule){if(this._attrRule=t,this.dRuler.style.display=t?"":"none",t&&!this.rulePrime){const i=this._range+1;for(let n=1;n<=i;n++){let o=document.createElement("div");this.dRuler.appendChild(o),o.classList.add("mark")}this.rulePrime=!0}return this}attrFill(t=this._attrFill){return this._attrFill=t,this.dFill.classList.toggle("show",t),this}attrFade(t=this._attrFade){return this._attrFade=t,this.dFade.classList.toggle("show",t),this}}const Ks=`<g class="shape" transform="translate(-50 -50)">
    <polyline points="25,100 75,50 25,0" />
  </g>`;class Qs extends I{constructor(t){super(t);a(this,"_duration");a(this,"_count",0);this.div.classList.add("tna_Tread"),this.duration=this.getPropVal("--tread-t"),this.count=this.getPropVal("--tread-n"),this.getProp("--tread-fade").indexOf("in")>=0&&this.div.classList.add("fadeIn"),this.value=0}set count(t){this.clear();for(let i=0;i<t;i++){this.add=Ks;const n=this.list[this.list.length-1],o=-(i/t)*this._duration;n.style.animationDelay=o+"s",n._tna_id=i,n.onanimationiteration=this.iterate.bind(this)}this.translate(50,50),this.scale(.88),this.update()}set duration(t){this._duration=t,this.div.style.setProperty("--tread-t",t+"s")}show(t=!1){this._val=!0,t&&(this.dWrap.onanimationend=void 0,this.div.classList.remove("hide")),this.div.classList.add("show","run")}hide(){this._val=!1,this.div.classList.remove("show"),this.div.classList.add("hide"),this.dWrap.onanimationend=t=>{t.animationName=="tna_Tread_hide"&&this.div.classList.remove("run","hide"),this.dWrap.onanimationend=void 0}}toggle(t){this._val=t==null?!this._val:t,this._val?this.show():this.hide()}iterate(t){t.animationName=="tna_Tread_move"&&this._count++}}const tn=`<div id="region" class="region">
    <div id="bg" class="bg"></div>
    <div id="strip" class="strip"></div>
    <div id="fill" class="fill"></div>
    <div class="flex left">
      <div id="status" class="status"></div>
      <div id="value_wrap" class="value_wrap">
        <div id="value" class="value"></div>
      </div>
    </div>
    <div class="flex right">
      <div style="flex:1"></div>
      <div id="tread" class="tread"></div>
      <div id="prompt" class="prompt"></div>
    </div>
    <div id="thumb" class="thumb">
      <svg id="chevron" class="chevron" viewBox="0 0 100 100">
        <g transform="translate(0 6) scale(.88)">
          <polyline stroke-width="24" points="25 100 75 50 25 0" />
        </g>
      </svg>
    </div>
  </div>`;class en extends X{constructor(t,i="ux"){super(t);a(this,"_ready",!1);a(this,"sticky",!1);a(this,"autoReset",!0);a(this,"committed",!1);a(this,"expired",!1);a(this,"textStatus","");a(this,"textPrompt");a(this,"x0");a(this,"loc");a(this,"locMax");a(this,"locNorm");a(this,"delta");a(this,"defH");a(this,"thumbW");a(this,"promptW");a(this,"treadPersist",!1);a(this,"treadPrompt",!1);a(this,"cancelDelay",75);a(this,"commitDelay",0);a(this,"timeout");a(this,"tread");a(this,"animThumb");a(this,"onBegin");a(this,"onReady");a(this,"onPrime");a(this,"onCommit");a(this,"onEnd");a(this,"onCancel");a(this,"onExpire");a(this,"onChange");this.link(i),this.div.insertAdjacentHTML("beforeend",tn),this.div.classList.add("tna_SafeSlide","disable"),this.dRegion=this.getDiv("region"),this.dBg=this.getDiv("bg"),this.dStrip=this.getDiv("strip"),this.dFill=this.getDiv("fill"),this.dPrompt=this.getDiv("prompt"),this.dStatus=this.getDiv("status"),this.dValueW=this.getDiv("value_wrap"),this.dValue=this.getDiv("value"),this.dThumb=this.getDiv("thumb"),this.divChevron=this.getDiv("chevron"),this.divTread=this.getDiv("tread"),this.treadPrompt=this.div.dataset.safeTread!=null,this.treadPersist=this.div.dataset.safeTreadPersist!=null,this.treadIcon=this.treadPrompt||this.treadPersist,this.treadIcon&&(this.tread=new Qs(this.divTread.id)),this.dPrompt.innerText=this.textPrompt=this.getDataAttr("safePrompt","string",""),this.dStatus.innerText=this.textStatus=this.getDataAttr("safeStatus","string",""),this.defH=this.getPropVal("--safe-h"),this.defP=this.getPropVal("--safe-p"),this.getDataAttr("safeThumbW","percent"),this.bEnableEnd=this.enableEnd.bind(this),this.bStart=this.start.bind(this),this.bTrack=this.track.bind(this),this.bStop=this.stop.bind(this),this.bResetEnd=this.resetEnd.bind(this),this.bCommitEnd=this.commitEnd.bind(this),this.observer=new ResizeObserver(n=>{n[0].contentRect.width,this.resize()}),this.observer.observe(this.div),this.resize(),this.sticky=this.div.dataset.sticky!=null,this._enable=this.div.dataset.enable!=null,this._enable==1&&this.enable()}resize(){const t=this.thumbW;if(this.calcThumb(),this.thumbW==t)return;const i=this.locNorm*this.locMax;this.dThumb.style.left=this.defP+i+"px",this.dFill.style.left=this.defP+i-this.width+"px",this.calcPrompt();let n,o;const l=this.div.dataset.safeGradStart;if(l!=null){const c=parseFloat(l);isNaN(c)?n=50:(o=l.indexOf("px"),n=o>0?(this.thumbW+c)/this.width*100:((this.width-this.thumbW)*c/100+this.thumbW)/this.width*100),this.div.style.setProperty("--safe-grad-start",n+"%")}}enable(t=!0){if(t==this._enable)return;if(this._enable=t,this.loc=this.locNorm=0,this.primed&&!t)return this.committed=!0,this.commitPrime(),this;this.div.classList.toggle("disable",!t),this.divChevron.classList.toggle("show",t);let i=500;return t?this.animThumb=this.dThumb.animate([{opacity:0,width:this.defH+"px"},{opacity:1,width:this.thumbW/3+"px",offset:.33},{opacity:1,width:this.thumbW+"px"}],{duration:i,easing:"ease-out",fill:"backwards"}):(this.dThumb.onmousedown=this.dThumb.ontouchstart=null,this.dPrompt.classList.remove("show"),this.treadPersist&&this.tread.hide(),this.animThumb=this.dThumb.animate([{opacity:1,left:this.defP+"px"},{opacity:0,left:this.width-this.thumbW+"px"}],{duration:i,easing:"ease-in"})),this.animThumb.addEventListener("finish",this.bEnableEnd),this}enableEnd(){this.animThumb.removeEventListener("finish",this.bEnableEnd),this.div.classList.toggle("disable",!this._enable),this.dThumb.onmousedown=this.dThumb.ontouchstart=this._enable?this.bStart:null,this._enable&&(this.dPrompt.classList.add("show"),this.treadPersist&&(this.tread.prime(),this.tread.show()))}parse(t){const i=t.v;if(i<0)return console.warn(`${this.id} safeSlide parse FAIL no stage value`);switch(r.stageID[i]){case"ready":this.ready(t);break;case"run":this.update(t);break;case"commit":this.commit(t);break;case"expire":this.expire(t);break}}start(t){t.preventDefault(),t.stopImmediatePropagation(),this.primed=!0,this._ready=this.expired=this.committed=!1,clearTimeout(this.timeout),this.dThumb.style.cursor="grab",document.addEventListener("mousemove",this.bTrack),document.addEventListener("touchmove",this.bTrack),document.addEventListener("mouseup",this.bStop),document.addEventListener("touchend",this.bStop),this.x0=isNaN(t.pageX)?t.changedTouches[0].pageX:t.pageX,this.delta=0,this.calcThumb(),this.div.classList.add("active"),this.dPrompt.classList.add("active"),this.onTron!=null&&this.onTron(`${this.div.id} > start`),this.onBegin!=null&&this.onBegin(this),this.dPrompt.style.transition="none",this.treadIcon&&(this.tread.prime(!1),this.tread.show(!0),this.tread.div.style.transition="none")}track(t){if(!this.primed)return;const i=isNaN(t.pageX)?t.changedTouches[0].pageX:t.pageX;this.loc=Math.round(i-this.x0),this.loc=this.loc<this.locMax?this.loc:this.locMax,this.delta=this.loc=Math.max(this.loc,0),this.onTron!=null&&this.onTron(`${this.div.id} track ${Math.round(this.delta)}`),this.locNorm=this.loc/this.locMax,this.dThumb.style.left=this.defP+this.loc+"px",this.dFill.style.left=this.defP+this.loc-this.width+"px";const n=(this.loc-(this.locMax-(1-this.promptStart)*this.promptW))/((this.promptEnd-this.promptStart)*this.promptW);this.dPrompt.style.opacity=1-n,this.tread.div.style.opacity=1-n*2,this.loc>=this.locMax?(this.dPrompt.classList.remove("show"),!this.expired&&this._ready&&this.execute()):this.dPrompt.classList.add("show"),t.preventDefault()}execute(){document.removeEventListener("mousemove",this.bTrack),document.removeEventListener("touchmove",this.bTrack),this.treadIcon&&this.tread.hide(),this.div.classList.add("hold"),this.sticky?(this.onTron!=null&&this.onTron(`${this.div.id} > prime sticky`),document.removeEventListener("mouseup",this.bStop),document.removeEventListener("touchend",this.bStop),this.dThumb.style.pointerEvents="none",this.dThumb.onmousedown=this.dThumb.ontouchstart=null):this.onTron!=null&&this.onTron(`${this.div.id} > prime`),this.onPrime!=null?this.onPrime(this):this.dRegion.classList.add("confirm")}ready(){this._ready=!0,this.onReady!=null&&this.onReady()}async commit(t){!this.primed||(this.committed=!0,this.sticky||(document.removeEventListener("mouseup",this.bStop),document.removeEventListener("touchend",this.bStop),this.dThumb.style.pointerEvents="none",this.dValueW.classList.remove("show","blink"),this.dValue.innerText=""),this.onTron!=null&&this.onTron(`${this.div.id} > commit`),this.onCommit!=null&&this.onCommit(this,t),this.autoReset?this.commitDelay>0?this.timeout=setTimeout(this.resetPrime.bind(this),this.commitDelay):this.resetPrime():this.commitDelay>0?this.timeout=setTimeout(this.commitPrime.bind(this),this.commitDelay):this.commitPrime())}async commitPrime(){if(!this.committed)return;this.primed=!1;const t=500;this.dStrip.style.opacity=0,this.dStrip.style.transition=t+"ms",await this.delay(t/2),this.dPrompt.style="",this.dPrompt.classList.remove("show"),this.tread.div.style.opacity="",this.tread.div.style.transition="",this.dFill.style.opacity=0,this.dFill.style.transition=t+"ms",this.dThumb.style.left=this.width-this.defP-this.defH+"px",this.dThumb.style.width=this.defH+"px",this.dThumb.style.opacity=0,this.dThumb.style.transition=`${t}ms ease-in`,this.drawStatus(!1),this.dThumb.addEventListener("transitionend",this.bCommitEnd),this.dBg.classList.add("disable")}commitEnd(){this.dThumb.removeEventListener("transitionend",this.bCommitEnd),this.onEnd!=null&&this.onEnd(this),this.dThumb.style="",this.div.classList.remove("active","hold"),this.dThumb.onmousedown=this.dThumb.ontouchstart=null,this.dStrip.style="",this.dStrip.classList.remove("show"),this.dFill.style="",this.status="",this.value="",this.dRegion.classList.remove("confirm"),this.dBg.classList.remove("disable"),this.div.classList.add("disable"),this._enable=!1,this.loc=this.locNorm=0}expire(t){if(console.warn(`${this.id} safeSlide expire, primed:${this.primed}`),!this.primed)return;this.expired=!0;const i=this.onExpire!=null?this.onExpire(this,t):void 0;this.endMouse(i)}stop(t){this.endMouse(),t.preventDefault(),t.stopImmediatePropagation()}endMouse(t=!0){document.removeEventListener("mousemove",this.bTrack),document.removeEventListener("touchmove",this.bTrack),document.removeEventListener("mouseup",this.bStop),document.removeEventListener("touchend",this.bStop),t&&this.resetPrime()}async resetPrime(){if(!this.primed)return;this.primed=!1,this.onTron!==void 0&&this.onTron(`${this.div.id} > endPrime`),this.drawStatus(!1);let t=this.delta/this.locMax*200;t=t>50?t:50,this.committed&&await this.delay(t),this.delta!=0?(this.dThumb.addEventListener("transitionend",this.bResetEnd),this.loc=this.locNorm=0,this.dThumb.style.left=this.defP+"px",this.dThumb.style.transition=`${t}ms ease-in`,this.dFill.style.left=-this.width+"px",this.dFill.style.transition=`${t}ms ease-in`):this.resetEnd(),this.dStrip.classList.remove("show"),this.dPrompt.classList.remove("active"),this.dPrompt.style.opacity="",this.tread.div.style.opacity="",this.tread.div.style.transition="",this.treadPrompt&&!this.treadPersist&&(this.tread.prime(),this.tread.hide()),this.dRegion.classList.remove("confirm")}resetEnd(){this.dThumb.removeEventListener("transitionend",this.bResetEnd),this.onTron!=null&&this.onTron(`${this.div.id} > end`),!this.committed&&this.onCancel!=null&&(this.cancelDelay>0?this.timeout=setTimeout(this.onCancel,this.cancelDelay,this):this.onCancel(this)),this.committed=!1,this.div.classList.remove("confirm"),this.dThumb.style="",this.div.classList.remove("active","hold"),this.dThumb.onmousedown=this.dThumb.ontouchstart=this.bStart,this.dFill.style="",this.dPrompt.classList.add("show"),this.dPrompt.innerText=this.textPrompt,this.dPrompt.style="",this.dValue.innerText="",this.treadPersist&&this.tread.show()}reset(t=0){this.committed&&(t>0?this.timeout=setTimeout(this.expire.bind(this),t):this.expire())}update(t){!this.primed||(this.onChange!=null&&this.onChange(this,t),this.drawStrip())}drawStrip(t=!0){this.dStrip.classList.toggle("show",t)}drawStatus(t=!0){this.dStatus.classList.toggle("show",t),this.dValueW.classList.toggle("show",t),t||this.dValueW.classList.remove("blink")}drawValue(t=!0){this.dValueW.classList.toggle("show",t)}blink(t=.14){this.div.style.setProperty("--blink-rate",t+"s"),this.dValueW.classList.add("blink"),this.dValueW.onanimationend=this.blinkEnd.bind(this)}blinkEnd(t){this.dValueW.classList.remove("blink"),this.dValueW.onanimationend=void 0}calcThumb(){const t=this.div.offsetWidth;t!=this.width&&(this.width=t,this.thumbW=this.dThumb.offsetWidth,this.locMax=this.width-this.thumbW-this.defP*2)}calcPrompt(){let t,i;this.promptW=this.dPrompt.offsetWidth;let n=this.div.dataset.safePromptStart,o=this.div.dataset.safePromptEnd;n=n!=null?n:"0",o=o!=null?o:"50%";const l=parseFloat(n),c=parseFloat(o);isNaN(l)?t=0:(i=n.indexOf("px"),t=i>0?l/this.promptW:l/100),this.promptStart=t,isNaN(c)||(i=o.indexOf("px"),t=i>0?c/this.promptW:c/100),this.promptEnd=t}set value(t){this.dValue.innerText=this._val=t}get value(){return this._val}set prompt(t){this.textPrompt=this.dPrompt.innerText=t,this.calcPrompt()}set status(t){this.textStatus=this.dStatus.innerText=t,this.dStatus.classList.toggle("nil",t=="")}}const sn=`<div id="region" class="region">
    <div id="bg" class="bg"></div>
    <div id="shadow" class="shadow"></div>
    <form class="flex">
      <input
        id="entry"
        class="field entry"
        type="text"
        autocomplete="new-password"
        autocapitalize="none"
        autocorrect="off"
      />
    </form>
    <div class="flex inert">
      <div id="mirror" class="field mirror"></div>
    </div>
    <div id="label" class="label inert __dmm"></div>
    <div id="warn" class="__dmm"></div>
    <div id="reset" class="__dmm"></div>
    <div id="eye" class="__dmm"></div>
    <div id="erase" class="__dmm"></div>
  </div>`,nn=`<g fill="var(--icon-fg)">
    <path
      d="M100,50C89.32,65.16,69,78,50,78S10.68,65.16,0,50C10.68,34.84,31,22,50,22S89.32,34.84,100,50ZM50,31A19,19,0,1,0,69,50,19,19,0,0,0,50,31Zm0,9A10,10,0,1,0,60,50,10,10,0,0,0,50,40Z"
    />
  </g>`,an=`<g stroke="var(--icon-fg)" stroke-width="12">
    <line x1="12" y1="12" x2="88" y2="88"></line>
    <line x1="12" y1="88" x2="88" y2="12"></line>
  </g>`,on=`<g fill="var(--icon-fg)">
    <path d="M100,50A50,50,0,1,1,50,0,50,50,0,0,1,100,50ZM87.5,41h-75V59h75Z" />
  </g>`,rn=`<g stroke-width="12" stroke-linejoin="round" stroke-linecap="round">
    <polygon
      stroke="var(--icon-fg)"
      fill="var(--icon-fg)"
      points="50 12.69 7.5 86.31 92.5 86.31 50 12.69"
    />
    <g>
      <polyline stroke="var(--icon-bg)" fill="none" points="50 55 50 32" />
      <circle fill="var(--icon-bg)" stroke="none" cx="50" cy="76" r="7" />
    </g>
  </g>`;var mt={html:sn,eye:nn,erase:an,reset:on,warn:rn};class w extends X{constructor(t,i="pref"){super(t);a(this,"_type","text");a(this,"_suffix");a(this,"_regexChars");a(this,"_regexFormat");a(this,"_min",0);a(this,"_max",64);a(this,"_fill","");a(this,"_preLen",-1);a(this,"_censor",!1);a(this,"_bullet",!1);a(this,"_focus",!1);a(this,"_hold",!1);a(this,"icon");a(this,"edit",!1);a(this,"valid",!1);a(this,"error");a(this,"validFormat",!1);a(this,"validChars",!0);a(this,"validLength",!1);a(this,"labelAbbr");a(this,"onValidate");a(this,"onFocus");a(this,"onBlur");a(this,"onErase");a(this,"onReset");a(this,"onError");this.link(i);const n="tna_Field";this.div.insertAdjacentHTML("beforeend",mt.html),this.div.classList.add(n),this.getDiv("region"),this.dEntry=this.getDiv("entry"),this.dMirror=this.getDiv("mirror"),this.dBg=this.getDiv("bg"),this.getDiv("shadow"),this.dLabel=this.getDiv("label"),this.dErase=this.getDiv("erase"),this.dErase.classList.add(n+"_erase"),this.dErase.addEventListener("mousedown",this.erase.bind(this)),this.iErase=new tt(this.dErase),this.iErase.addCenter=mt.erase,this.iErase.scaleCenter(.7).def(),this.dEye=this.getDiv("eye"),this.dEye.classList.add(n+"_eye"),this.iEye=new tt(this.dEye),this.iEye.addCenter=mt.eye,this.iEye.scaleCenter(.85).def(),this.iEye.onExecute=this.eye.bind(this),this.dUndo=this.getDiv("reset"),this.dUndo.classList.add(n+"_reset"),this.iUndo=new tt(this.dUndo),this.iUndo.addCenter=mt.reset,this.iUndo.scaleCenter(.8).def(),this.iUndo.onExecute=this.reset.bind(this),this.dWarn=this.getDiv("warn"),this.dWarn.classList.add(n+"_warn"),this.iWarn=new tt(this.dWarn),this.iWarn.addCenter=mt.warn,this.iWarn.scaleCenter(.85).def(),this.iWarn.onExecute=this.clean.bind(this),this.iWarn.onShow=o=>o.choreo("blink").timing(3,140,500).act(),this.icons={erase:this.iErase,undo:this.iUndo,eye:this.iEye,warn:this.iWarn},this.dLabel.innerText=this.getDataAttr("label","string",""),this.value=this.div.dataset.value==null?"":this.div.dataset.value,this.type(this.getDataAttr("type","string","")),this._suffix=this.getDataAttr("suffix","string",""),this.preset(this.value,this.div.dataset.valueLength),this.div.dataset.prime!=null&&this.prime(),this.dEntry.oninput=this.input.bind(this),this.dEntry.onkeypress=this.key.bind(this),this.dEntry.onfocus=this.focus.bind(this),this.dEntry.onblur=this.blur.bind(this)}setIcon(t="none"){const i=this.icons[t];if(i!=this.icon)return this.icon!=null&&(this.icon.enable(!1),this.icon.view(!1)),i!=null&&(i.enable(),i.view(),i.div.style.zIndex=0),this.icon=i,i}preset(t,i,n){return this._fill=t!=null?t:this.dEntry.value,this._preLen=i==null?this._fill.length:i,this.dEntry.value=this._fill,n==null&&this.input(),this.edit=!1,this}set(t){return this.dEntry.value=t,this.input(),this.edit=!1,this}censor(t=!0){return t?(this.type("password"),this._bullet=!0,this.dEntry.value="xxxxxxxx",this.valid=!0,this.dLabel.classList.add("stick"),this.div.classList.remove("warn"),this):this}input(t=!0){this.error=void 0;const i=this.dEntry.value;this.dMirror.innerHTML=this.checkFormat(i),this._val=i.replace(/^\s+|\s+$/g,""),this.checkLength(this._val),this.edit=i!=this._fill||i.length!=this._preLen,this.valid=this.validChars&&this.validLength&&this.validFormat,this.div.classList.toggle("warn",!this.valid),this.div.classList.toggle("valid",this.valid),this.dLabel.classList.toggle("stick",i.length>0);let n=!this.valid||this._suffix.length>0;this.dMirror.classList.toggle("show",n);let o=!1,l;this._type!="password"?(this.valid&&!this.edit&&this._focus&&i.length!=0&&(l="erase",o=!0),o||(this.validChars&&this.validFormat?this.edit&&(l="undo"):this._censor||(l="warn"))):i.length!=0&&(l="eye"),this.setIcon(l),t&&this.onValidate!=null&&this.onValidate(this)}focus(){this._focus=!0,this.div.classList.add("focus"),this.dEntry.classList.add("show"),this._bullet&&(this._bullet=!1,this.dEntry.value="",this.dLabel.classList.remove("stick"));let t=this.valid&&this._type!="password"&&!this.edit;t=t&&this.dEntry.value.length!=0,t&&this.setIcon("erase"),this.onFocus!=null&&this.onFocus(this)}async blur(){if(this._focus=!1,this.div.classList.remove("focus"),this._censor&&this.dEntry.value.length==0&&this._preLen>0&&(this._bullet=!0,this.dLabel.classList.add("stick"),await this.delay(250),this.type("password"),this.dEntry.value="xxxxxxxx"),this._hold){this._hold=!1;return}this.icon==this.iErase&&this.setIcon(),this.onBlur!=null&&this.onBlur(this)}commit(){this.setIcon(),this.dEntry.blur()}async erase(t){t!=null&&(t.preventDefault(),t.stopImmediatePropagation()),this.dEntry.value="",this.onValidate!=null&&this.onValidate(this),this.onErase!=null&&this.onErase(this),await this.delay(100),this.input(),this.focus(),this.dEntry.focus(),this.setIcon("undo")}eye(){this.type("text"),this._hold=!0,this.dEntry.focus(),this.input(),this._hold=!0}async reset(){return this.onValidate!=null&&this.onValidate(this),this.iUndo.choreo("spin_out").timing(1,750).act(),this.error="reset",this.onError!=null&&this.onError(this),this.onReset!=null&&this.onReset(this),this._censor?this._preLen>0?(this._bullet=!0,await this.delay(500),this.dEntry.value="",this.dLabel.classList.add("stick"),await this.delay(250),this.type("password"),this.dEntry.value="xxxxxxxx"):(await this.delay(250),this.dLabel.classList.remove("stick"),this.dEntry.value=""):(this.dEntry.value.length==0&&this.dLabel.classList.toggle("stick",this._fill.length>0),this.dEntry.value="",this.dMirror.classList.remove("show"),this.dEntry.classList.remove("show"),await this.delay(250),this.dEntry.value=this._fill,await this.delay(500)),this.div.classList.remove("focus"),this.input(),this}async clean(){let t="",i=[];const n=this._val;if(this._regexChars!=null){const l=new RegExp(this._regexChars,"g");let c;for(;(c=l.exec(n))!==null;)i.push(c)}this.validFormat||(i.length?i[0].index!=0&&i.unshift({index:0}):i.push({index:0}));let o=0;for(let l=0;l<i.length;l++)t+=n.slice(o,i[l].index),o=i[l].index+1;t+=n.slice(o,n.length),this._val=this.dMirror.innerHTML=this.dEntry.value=t,this.input(),this._hold=!0,this.dEntry.focus()}checkFormat(t){const i="\u02FD",n=t.match(/^(\s*)/)[1].length;let o=i.repeat(n);t=t.replace(/^\s+/g,"");let l=[];if(this._regexFormat!=null){const u=new RegExp(this._regexFormat);this.validFormat=u.test(t)}else this.validFormat=!0;if(this._regexChars!=null){const u=new RegExp(this._regexChars,"g");let b;for(;(b=u.exec(t))!==null;)l.push(b)}this.validFormat||(l.length&&l[0].index!=0&&l.unshift({index:0}),this.error="format");let c=0,_=0;for(let u=0;u<l.length;u++){o+=t.slice(c,l[u].index).split(" ").join(i);const b=t.slice(l[u].index,l[u].index+1).split(" ").join(i);o+="<span class='highlight'>"+b+"</span>",c=l[u].index+1,_++}return o+=t.slice(c,t.length).split(" ").join(i),l.length==0&&(o=t),o+="<span class='_suffix'>"+this._suffix+"</span>",this.validChars=!(l.length>0),_>0&&this.validFormat&&(this.error="char"),o}checkLength(t){const i=new RegExp(`^.{${this._min},${this._max}}$`);this.validLength=i.test(t),!this.validLength&&this.validChars&&this.validFormat&&(this.error="length")}key(t){t.key=="Enter"&&(this.blur(),this.dEntry.blur(),t.preventDefault())}validSize(t,i){return this._min=t,this._max=i,this}regexChar(t){return this._regexChars=t,this}regexFormat(t){return this._regexFormat=t,this}get length(){return this.dEntry.value.length}type(t){return this._type=t,this._censor=t=="password",this.dEntry.setAttribute("type",t),this}label(t){return this.dLabel.innerText=t,this}}class Gt extends I{constructor(e,t){super(e),this.link(t),this.div.classList.add("tna_Twirl"),this.add='<polygon points="0,88 100,88 50,0"/>',this.def()}draw(){this.div.classList.toggle("open",this.value)}}const ln=`
  <g id="padlock_offset" transform="translate(34 0)">
    <rect fill-opacity="0" transform="translate(50 0)" x="0" y="0" width="100" height="100" fill="blue" stroke="none"></rect>
    <g id="shackle_wrap">
      <g id="shackle" stroke-miterlimit="1" stroke="var(--icon-fg)" fill="none">
        <path transform="translate(50 -5)" vector-effect="non-scaling-stroke" d="M28,74 L28,39 C28,26.8497355 37.8497355,17 50,17 C62.1502645,17 72,26.8497355 72,39 L72,59 L72,59"></path>
      </g>
    </g>
    <rect transform="translate(50 0)" x="10" y="50" width="80" height="50" fill="var(--icon-fg)" stroke="none"></rect>
  </g>`;class dn extends tt{constructor(e,t){super(e),this.link(t),this.div.classList.add("tna_Padlock"),this.add=ln,this.scale(.9).translate(5,10).def(),this.div.querySelector("#padlock_offset").classList.add("padlock_offset"),this.div.querySelector("#shackle_wrap").classList.add("shackle_move"),this.div.querySelector("#shackle").classList.add("shackle_swing")}draw(){this.div.classList.toggle("open",this.value),this.div.classList.toggle("lock",!this.value)}size(e){return this.sizeXY(e*2,e),this.div.style.setProperty("--padlock-h",e+"px"),this}}const hn=`<div class="region">
    <div id="bg" class="bg">
      <div class="folder"></div>
    </div>
    <div id="label" class="label">X</div>
  </div>`;class cn extends Ve{constructor(t,i){super(t,i,hn);a(this,"_ind",!1);this.id=`${i.id}_${i._itemN}`,this.dBg=this.getDiv("bg",this.id)}highlight(t=!0){return super.highlight(t),this.div.classList.toggle("ind",t?this._ind:!1),this}indicate(t=!0){return this._ind=t,this.div.classList.toggle("ind",t),this}}class fn extends xt{constructor(t){super(t);a(this,"_itemDef",cn);this.div.classList.add("tna_Tab"),this.merge()}}function We(s){return{days:Math.floor(s/(3600*24)),hours:Math.floor(s%(3600*24)/3600),minutes:Math.floor(s%3600/60),seconds:Math.floor(s%60)}}function un(s){const e=We(s);return sprintf("%ih%02im%02is",e.hours,e.minutes,e.seconds)}function Xe(s,e=!0){let t={};return s>=3600?(t.v=`${Math.round(s/3600)}`,t.u=e?"h":"hr"):s>60?(t.v=`${Math.round(s/60)}`,t.u=e?"m":"min"):(t.v=`${s}`,t.u=e?"s":"sec"),t}function gn(s){return Xe(s,!1)}function he(s){const e=s!=null?new Date(s*1e3):new Date,t=String(e.getFullYear()).slice(-2);return sprintf("%s.%02i.%02i",t,e.getMonth()+1,e.getDate())}function Ge(s){const e=s!=null?new Date(s*1e3):new Date;return sprintf("%02i:%02i:%02i",e.getHours(),e.getMinutes(),e.getSeconds())}function Ue(s){const e=s!=null?new Date(s*1e3):new Date,t=e.getHours(),i=t%12,n=t<=11||t==0?"A":"P";return sprintf("%2i:%02i%s",i,e.getMinutes(),n)}function pn(s){return`${he(s)} ${Ge(s)}`}function _n(s){return`${he(s)} ${Ue(s)}`}const vn=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],mn=["January","February","March","April","May","June","July","August","September","October","November","December"];function It(s,e=!0){let t;if(e){const i=s.getHours()%12;t=sprintf("%u:%02u ",i==0?12:i,s.getMinutes()),t+=s.getHours()>=12?"PM":"AM"}else t=sprintf("%u:%02u ",s.getHours(),s.getMinutes());return t}function bn(s,e=!1){const t=s!=null?new Date(s*1e3):new Date,i=new Date,n=mn[t.getMonth()].slice(0,e?3:void 0),o=vn[t.getDay()].slice(0,e?3:void 0),c=i.toLocaleTimeString().match(/AM|PM|am|pm|a.m.|p.m./),_=c!=null?c.length>0:!1,u=new Date;u.setHours(-24*6,0,0,0);const b=new Date;b.setHours(-24,0,0,0);const h=new Date;h.setHours(0,0,0,0);let E="unset";const k=t.getTime();return k>h.getTime()?E="Today at "+It(t,_):k>b.getTime()?E="Yesterday at "+It(t,_):k>u.getTime()?E=`${o}, ${It(t,_)}`:(E=`${n} ${t.getDate()}, `,E+=t.getFullYear()==i.getFullYear()?It(t,_):t.getFullYear()),E}var ft={durationObject:We,durationString:un,durationFormat:Xe,durationFormatLong:gn,dateString:he,timeString:Ge,timeString12h:Ue,timeStringLong:pn,timeStringLong12h:_n,relative:bn};const yn=[{val:"_",text:"None"},{val:"W",text:"White"},{val:"R",text:"Red"},{val:"G",text:"Green"},{val:"B",text:"Blue"}],wn=[{val:15},{val:20},{val:30},{val:60},{val:90}],xn=[{val:1},{val:2},{val:5},{val:10},{val:15},{val:20},{val:30},{val:60}],kn=[{val:-10,text:"US Hawaii"},{val:-8,text:"US Pacific"},{val:-7,text:"US Mountain"},{val:-6,text:"US Central"},{val:-5,text:"US Eastern"},{val:0,text:"GMT"},{val:1,text:"EU Central"}],Ln=[{text:"OFF"},{text:"LOW"},{text:"2"},{text:"3"},{text:"4"},{text:"5"},{text:"6"},{text:"7"},{text:"8"},{text:"HIGH"}],En=[{text:"OFF"},{text:"LOW"},{text:"2"},{text:"3"},{text:"4"},{text:"5"},{text:"6"},{text:"7"},{text:"8"},{text:"HIGH"}],Dn=[{text:"Time"},{text:"Date"},{text:"Seconds"}];var ht={color:yn,ntp_int:wn,gps_log_int:xn,bright:Ln,tap:En,clock:Dn,tz:kn};const d={};let v,D,T,pe;const _e=/^\d\d([- /.])(0[1-9]|1[012])\1(0[1-9]|[12][0-9]|3[01])$/;function Tn(){d.user.set(x.prop.user).enable();for(const[s,e]of Object.entries(y.prop))if(d.hasOwnProperty(s)&&d[s].hasTag("data"))switch(Object.getPrototypeOf(d[s])){case w.prototype:d[s].preset(e);break;case C.prototype:d[s].set(e),d[s].enable();break;case xt.prototype:case K.prototype:d[s].value=e,d[s].set();break}d.def_pass.preset("",y.prop.def_pass).censor(y.prop.def_pass>0)}function In(){for(const[s,e]of Object.entries(d))e.hasTag("field")&&e.preset()}function Sn(){d.mfg_product=new w("mfg_product").tag("data","field").validSize(0,32),d.mfg_version=new w("mfg_version").tag("data","field").validSize(0,16),d.mfg_serial=new w("mfg_serial").tag("data","field").validSize(0,16),d.mfg_date=new w("mfg_date").tag("data","field").validSize(0,16).regexFormat(_e),d.mfg_logic=new w("mfg_logic").tag("data","field").validSize(0,32),d.mfg_color_insert=new M("mfg_color_insert"),v=d.mfg_color=new xt("mfg_color").tag("data").valRef(ht.color).valIO().init(5),v.onChange=s=>s.div.classList.toggle("pick",s._val),v.onExecute=s=>{s._val||(d.mfg_color_insert.close(),d.mfg_display.erase())},D=v.label(0).createDivFirst("color_icon_0"),T=new I(D).static().show(),T.symbol("o").def().size(12),D=v.label(1).createDivFirst("color_icon_1"),T=new I(D).static().show(),T.symbol("dot").def().size(6),D=v.label(2).createDivFirst("color_icon_2"),T=new I(D).static().show(),T.symbol("dot").def().size(6),D=v.label(3).createDivFirst("color_icon_3"),T=new I(D).static().show(),T.symbol("dot").def().size(6),D=v.label(4).createDivFirst("color_icon_4"),T=new I(D).static().show(),T.symbol("dot").def().size(6),v=d.mfg_display=new w("mfg_display").tag("data","field").validSize(0,32),v.onValidate=s=>{d.mfg_color_insert.toggle(s.length);const e=d.mfg_color;e.enable(s.length),s.length||(e.value=y.prop.mfg_color="_",e.set())},d.mfg_note=new w("mfg_note").tag("data","field").validSize(0,32),d.user=new C("reg_user","info").tag("data"),d.user_consent=new C("user_consent","info").tag("data"),d.reg_date=new w("reg_date").tag("data","field").validSize(0,32).regexFormat(_e),d.reg_name_1=new w("reg_name_1").tag("data","field").validSize(0,32),d.reg_name_2=new w("reg_name_2").tag("data","field").validSize(0,32),d.def_gift=new C("def_gift").tag("data").enable(),d.reg_gp_1=new w("reg_gp_1").tag("data","field").validSize(0,32),d.reg_gp_2=new w("reg_gp_2").tag("data","field").validSize(0,32),d.def_device=new w("def_device").tag("data","field").validSize(0,32).regexFormat(/^[a-zA-Z ]+/).regexChar(/[^\w- ]/),d.def_ssid=new w("def_ssid").tag("data","field").validSize(0,32).regexChar(/[\?\"\$\[\]\/\+]/),d.def_ssid.onReset=async s=>{y.prop.def_ssid.length==0&&await s.delay(500),d.def_pass.preset("",y.prop.def_pass,"hold"),d.def_pass.reset()},d.def_ssid.onErase=s=>{d.def_pass.preset("",0,"hold").reset()},d.def_pass=new w("def_pass").tag("data").validSize(0,32),d.def_alert=new C("def_alert").tag("data").enable().set(y.prop.def_alert),v=d.def_bright=new K("def_bright").range(0,9).tag("data").valRef(ht.bright).enable(),v.onChange=s=>window.def_bright_value.innerText=s._valRef[s._val].text,v=d.def_sound=new xt("def_sound").tag("data").init(3),D=v.label(0).createDivFirst("radio_icon_0"),T=new I(D).static().show(),T.symbol("o").def().size(12),D=v.label(1).createDivFirst("radio_icon_1"),T=new I(D).static().show(),T.symbol("bar_1").def().size(12),D=v.label(2).createDivFirst("radio_icon_2"),T=new I(D).static().show(),T.symbol("bar_2").def().size(12),d.tap_insert=new M("tap_insert"),d.tap_twirl=new Gt("tap_twirl").target("tap_button").show(),d.tap_twirl.onExecute=async s=>{s.toggle(),d.tap_insert.toggle(s.value),d.tap_foot.toggle(s.value)},d.tap_foot=new M("tap_foot"),v=d.def_tap_act=new C("def_tap_act").tag("data").enable(),v.onChange=s=>{d.def_tap.enable(s.value),d.def_tilt.enable(s.value)},v=d.def_tap=new K("def_tap").range(0,9).tag("data").valRef(ht.tap).enable(),v.onChange=s=>{d.def_tap_act&&(window.def_tap_value.innerText=s._valRef[s._val].text)},v.onEnable=s=>window.def_tap_value.innerText=s._enable?s._valRef[s._val].text:"",d.def_tilt=new C("def_tilt").tag("data").enable(),d.ntp_insert=new M("ntp_insert"),d.ntp_twirl=new Gt("ntp_twirl").target("ntp_button").show(),d.ntp_twirl.onExecute=async s=>{s.toggle(),d.ntp_insert.toggle(s.value),window.ntp_hr.classList.toggle("show",!s.value)},d.def_ntp_url=new w("def_ntp_url").tag("data","field").latchClass("_dmm").validSize(0,32),v=d.def_ntp_int=new K("def_ntp_int").range(0,4).tag("data").enable().valRef(ht.ntp_int).valIO(),v.onChange=s=>{const e=ft.durationObject(s._valRef[s._val].val*60),t=window.def_ntp_int_value;t.innerText=sprintf("%ih%02i",e.hours,e.minutes)},d.gps_insert=new M("gps_insert"),d.gps_twirl=new Gt("gps_twirl").target("gps_button").show(),d.gps_twirl.onExecute=async s=>{s.toggle(),d.gps_insert.toggle(s.value),window.gps_hr.classList.toggle("show",!s.value)},d.def_gps_alert=new C("def_gps_alert").tag("data").enable(),v=d.def_gps_log_i=new K("def_gps_log_i").range(0,7).tag("data").enable().valRef(ht.gps_log_int).valIO(),v.onChange=s=>{pe=s._valRef[s._val].val*60;const e=ft.durationObject(pe);window.def_gps_log_i_value.innerText=sprintf("%ih%02i",e.hours,e.minutes),d.def_gps_log_x.onChange(d.def_gps_log_x)},v=d.def_gps_log_x=new K("def_gps_log_x").range(1,30).tag("data").enable(),v.onChange=s=>{const e=ft.durationObject(s.value*10);window.def_gps_log_x_value.innerText=sprintf("%im%02i",e.minutes,e.seconds)},v=d.def_tz=new K("def_tz").range(0,6).tag("data").valRef(ht.tz).valIO().enable(),v.dLabel=window.def_tz_value,v.onChange=s=>{window.def_tz_label.innerText=s._valRef[s._val].text;const e=s._valRef[s._val].val,t=e==0?"":e>0?"+":"\u2212";s.dLabel.innerText=t+Math.abs(e)},d.def_dst=new C("def_dst").tag("data").enable(),d.def_24h=new C("def_24h").tag("data").enable(),d.def_pps=new C("def_pps").tag("data").enable(),d.sys_output=new C("sys_output").tag("data").enable(),d.sys_console=new C("sys_console").tag("data").enable()}function $n(){for(const[s,e]of Object.entries(d))e.prime()}var H={tna:d,init:Sn,prime:$n,fill:Tn,reset:In};const f={},ot=[];let ve;function Cn(){f.toolbar=new M("toolbar"),f.toolbar_wrap=new z("toolbar_wrap").fuse(),f.strip=new M("strip").open(),f.strip_fill=new z("strip_fill").fuse(),f.lock=new dn("lock").translate(25,25).scale(.6).show(),f.lock.value=!1,f.lock.onExecute=async(i,n)=>{n!=null&&(i.value=n),i.toggle(),i.value||(f.pass.reset(),f.submit.enable(!1)),f.strip.toggle(i.value),f.strip_fill.view(i.value),i.value&&await i.delay(250),f.toolbar.toggle(i.value),f.toolbar_wrap.view(i.value),window.tab_item.classList.toggle("shift",i.value),i.value&&await i.delay(500),f.strip.toggle(!i.value)},f.force_bg=new I("force_bg").size(38).show().enable(),f.force_bg.symbol("save_dis").def(),f.force=new I("force").size(38).enable(),f.force.symbol("save").symbol("restart").def(),f.force.onExecute=i=>{Jt(!0,!i.value),i.value?m.sendTune("toggle_on"):m.sendTune("toggle_off")},f.force.value=!1;let s;f.pass=new w("pass").validSize(0,16),f.pass.onValidate=i=>{clearTimeout(s);const n=i.valid&&i.edit?1e3:100;s=setTimeout(()=>{const l=f.pass.valid&&f.pass.edit;f.submit.enable(l),Jt(l)},n)},f.submit=new en("reset_user");const e=f.submit.dValueW.createDivFirst("submit_value_icon"),t=new I(e).static().show().size(17);t.symbol("warn_ui").def(),f.submit.prompt=qe,f.submit.onBegin=i=>{t.div.style.display="none",f.force.value?m.sendUX("reset_user","begin"):(m.sendTune(),i._ready=!0)},f.submit.onCancel=()=>f.force.value?m.sendUX("reset_user","cancel"):0,f.submit.onExpire=()=>!1,f.submit.onCommit=async i=>{f.force.value&&(i.value="",await i.delay(1100),i.status="RESTARTING",x.close())},f.submit.onChange=(i,n)=>{if(n==null)return;const o=n.x;i.value=`0:0${o}`,i.drawValue(),o==0&&i.blink(),i.status="RESTART"},f.submit.onPrime=async i=>{ve=performance.now(),f.pass.commit(),i.status="SENDING",i.drawStatus(),i.drawValue(!1),i.update();const n=await y.send();let o=!1;switch(n){case 200:if(o=!0,H.reset(),!f.force.value){const l=500-(performance.now()-ve);l>0&&await i.delay(l),i.status="DONE",await i.delay(1500),i.commit()}break;case 404:i.status="SEND";break;case 401:i.status="LOGIN";break}o||(f.force.value&&m.sendUX("reset_user","cancel"),t.div.style.display="",i.value="",i.drawValue(),i.blink(.28),await i.delay(1500),i.committed=!0,i.enable(!1),f.pass.reset(),await i.delay(500),Jt(!1)),i.commitDelay=f.force.value?5600:0},f.tab=new fn("tab"),f.tab.onExecute=i=>me(i.value),ot.push(new M("mfg_insert")),ot.push(new M("reg_insert")),ot.push(new M("net_insert")),ot.push(new M("def_insert")),ot.push(new M("tron_insert")),me(0)}function Pn(){for(const[s,e]of Object.entries(f))e.prime();ot.forEach((s,e)=>s.prime())}function me(s){ot.forEach((e,t)=>e.toggle(t==s)),f.tab.set(s)}const qe="save";let Ut=!1,qt=!1;async function Jt(s=Ut,e=f.force.index){if(qt)return;let t=!1;const i=f.force,n=f.force_bg;e!=i.index&&(i.index=i.value=i.index=e,f.submit.prompt=e?"force":qe),s!=Ut&&(Ut=s,n.view(!s),i.enable(s).view(s),t=!0),t&&(qt=!0,await n.delay(500),qt=!1)}async function On(){!f.lock.value||(await F.delay(1500),f.lock.onExecute(f.lock,!0))}var kt={tna:f,init:Cn,prime:Pn,close:On};const Mn={version:x.version,device:"cubeCore XX-XX",mac:"XX:XX:XX:XX:XX:XX",ip:"10.0.0.1",sys_console:1,sys_output:0,mfg_product:"Nude Pro",mfg_version:"2.0",mfg_date:"22.12.31",mfg_serial:"0000",mfg_logic:"1.90r1C-iU/22.00.00",mfg_display:"1.20r4C",mfg_color:"W",mfg_note:"841AR",reg_date:"22.12.31",reg_name_1:"Noel",reg_name_2:"Rubin",user_consent:0,def_device:"CubeCore",def_ssid:"expresso",def_pass:8,def_alert:1,def_bright:4,def_sound:1,def_tap_act:1,def_tap:7,def_tilt:1,def_ntp_url:"time.apple.com",def_ntp_int:30,def_gps_log_i:30,def_gps_log_x:24,def_gps_alert:1,def_tz:-7,def_dst:1,def_24h:0,def_pps:0},ae={};async function Fn(){await m.fill(ae,"/admin-fill",Mn),window.diag_firmware.innerText=F.versionString(ae.version),window.diag_firmware.innerHTML!=window.diag_client.innerHTML?window.diag_client.classList.add("show"):window.diag_firmware.dataset.prefix="",window.diag_firmware.classList.add("show")}async function Rn(){const s=H.tna,e={};for(const[u,b]of Object.entries(s))b.hasTag("data")&&(e[u]=b);const t=(u,b=!1)=>{if(!b&&u.edit!=null&&!u.edit||u.value==null)return"";const h=typeof u.value=="boolean"?Number(u.value):u.value;return i.append(u.id,h),`${u.id}:`+(typeof u.value=="string"?`'${h}' `:`${h} `)},i=new FormData;let n="{ ";i.append("pass",kt.tna.pass.value);const o=Number(kt.tna.force.value);i.append("force",o);for(const[u,b]of Object.entries(e))b.hasTag("data","field")&&(n+=t(b));e.def_ssid.value==""&&(n+=t(e.def_pass,!0));let l;s.def_ssid.value.length>0?s.def_pass.edit&&(l=s.def_pass.value):l="",l&&(i.append(s.def_pass.id,l),n+=`${s.def+pass.id}:${l.length>0?"***":"''"}`),n+="}",console.groupCollapsed(`admin send force:${o}`),console.log(n),console.groupEnd();let c,_;try{if(c=await fetch("/admin",{method:"POST",body:i}),_=await c.text(),_!=="OK")throw new Error("bad response")}catch{return console.groupCollapsed("admin send FAIL"),console.log(c.status),console.log(_),console.groupEnd(),404}return c.status}var y={prop:ae,fill:Fn,send:Rn};async function Je(s){if(await F.delay(250),navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(s);{const e=Ye(s);return new Promise((t,i)=>{document.execCommand("copy")?t("ok"):i("copy"),Ze(e)})}}async function An(){if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.readText();{const s=Ye();return new Promise((e,t)=>{console.warn("write() shitty method"),document.execCommand("paste")?e(s.value):t("paste"),Ze(s)})}}function Ye(s){const e=document.createElement("textarea");return document.body.appendChild(e),e.id="copy_offText",e.value=s||"",e.focus(),e.select(),e}function Ze(s){s.remove(),s=void 0}let Mt,Ft;function Nn(){Mt=new ne("read_btn").enable(),Mt.label="Read",Mt.onExecute=()=>{const s={};for(const[t,i]of Object.entries(H.tna))i.hasTag("data","data_manual")&&(s[i.id]=y.prop[i.id]);s.reg_user=H.tna.user.value,s.def_pass="";const e=Ke("profile")+zn(s);console.log(e),Je(e)},Ft=new ne("write_btn").enable(),Ft.label="Write",Ft.onExecute=async()=>{let s,e;try{s=await An();const t=s.slice(s.indexOf("{"));console.warn(t),e=JSON.parse(t)}catch(t){return console.warn("write button FAIL: "+t)}for(const[t,i]of Object.entries(H.tna))if(e.hasOwnProperty(i.id)&&i.hasTag("data"))switch(Object.getPrototypeOf(i)){case C.prototype:case w.prototype:i.value!=e[i.id]&&(console.log(`write ${i.id}:${e[i.id]}`),i.set(e[i.id]),i.edit=!0);break;case xt.prototype:case K.prototype:i.value!=e[i.id]&&(console.log(`write ${i.id}:${e[i.id]}`),i.value=e[i.id],i.set());break}e.hasOwnProperty("def_pass")&&H.tna.def_pass.set(e.def_pass)}}function Hn(){Mt.prime(),Ft.prime()}function Ke(s){let e=`http://${y.prop.device.replace(/ /g,"-").toLowerCase()}.local`;return s&&s.length&&(e+=`  ${s}`),e+=`

`,y.prop.mfg_product&&y.prop.mfg_product.length&&(e+=`'${y.prop.mfg_product}'`),y.prop.mfg_version&&y.prop.mfg_version.length&&(e+=` v${y.prop.mfg_version}`),y.prop.mfg_color.length&&(e+=` '${H.tna.mfg_color._valRef[H.tna.mfg_color._val].text}'
`),e+=` F:${y.prop.version} C:${x.version}
`,e+=` ${y.prop.mac}  ${y.prop.ip}
`,e+=` ${ft.timeStringLong12h()}

`,e}function zn(s){const e=JSON.stringify(s).replace(/,/g,`,
`).slice(1,-1);return`{
`+e+`
}`}var Qe={init:Nn,prime:Hn};const oe="GPS";let be,Q,re,at;function Bn(){new A("info_status","object").onChange=(s,e)=>{be=r.serviceID[e.v]=="GPS",document.querySelectorAll("._gps").forEach(n=>n.tna.toggle(be))},re=new A("info_gps_log","object"),re.onChange=async(s,e)=>{typeof e=="object"&&(at=e,Q.label=oe,Q.status=`<b>${e.n}</b> samples`)},Q=new ne("gps_copy").enable().icon().shuffleIcon(!1),Q.label=oe,Q.iStatus.symbol("dot").size(6).def(),Q.onExecute=s=>{if(at==null)return m.send("call","call_gps_log"),!1;s.iStatus.view().choreo("blink","hal_hot").timing(3,150*3).act();let e=Ke("gps_log");const t=new Date/1e3-at.t;if(at.t!=null){const i=ft.durationString(t),n=ft.timeStringLong12h(at.t);e+=` gps -> ${i}
 ${n}

`}return e+=JSON.stringify(at),console.log(e),Je(e),!0}}async function jn(){Q.prime(),window.gps_copy_item.tna.prime(),window.gps_copy_section.tna.prime(),!x.prop.preflight&&(await F.delay(250),re.set(Rs),console.log("%ccomm test",it.style.test,"gps log"))}function Vn(){m.send("call","call_gps_log")}function Wn(){at=void 0,Q.label=oe}var zt={init:Bn,prime:jn,open:Vn,close:Wn};async function Xn(){document.title=window.location.hostname.split(".")[0]+" \u2022 Admin",ui.init(),x.init(),kt.init(),H.init(),Qe.init(),zt.init(),x.patch(),m.monitor(x.prop.preflight),!x.prop.preflight&&Bs.init()}x.upon.prime=async s=>{await y.fill(),H.fill(),await F.delay(100),kt.prime(),H.prime(),Qe.prime(),zt.prime(),x.prime(),window.page.classList.add("show"),window.tab_item.classList.remove("shy");const e=s.display||!s.display&&(s.piezo||s.xpio);window.def_insert_head.classList.toggle("clear",!e);const t=!s.display&&!s.xpio&&!s.piezo&&!s.gps;window.def_ntp_url.classList.toggle("pad_section",!t),Object.keys(s).forEach(function(i){s[i]&&document.querySelectorAll("._"+i).forEach(o=>o.style.display="")})};x.upon.open=async()=>{zt.open()};x.upon.close=()=>{zt.close(),kt.close()};window.addEventListener("load",Xn);
