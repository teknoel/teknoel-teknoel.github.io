var cs=Object.defineProperty;var us=(s,e,t)=>e in s?cs(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var a=(s,e,t)=>(us(s,typeof e!="symbol"?e+"":e,t),t);const fs=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}};fs();Element.prototype.createDiv=function(s){const e=document.createElement("div");return e.id=s,this.appendChild(e),e};Element.prototype.createDivFirst=function(s){const e=document.createElement("div");return s!=null&&(e.id=s),this.insertAdjacentElement("afterbegin",e),e};function _s(s,e){const t=document.createElement("div"),i=s.id;return s.insertAdjacentElement("afterend",t),t.appendChild(s),i.length!=0&&(t.id=i),t.classList.value=s.classList.value,s.classList.value="",s.removeAttribute("id"),e!=null&&s.classList.add(e),t}var ps={nest:_s};class O{constructor(e,t){a(this,"_id");a(this,"_tags",[]);a(this,"_valRef");a(this,"_valIO",!1);a(this,"_val");a(this,"_valLast");a(this,"_tron",!1);a(this,"_view",!1);a(this,"_height",0);a(this,"div");a(this,"data");a(this,"onChange");a(this,"onRender");switch(t=e.nodeType!=null?"div":t,t){case"object":case"obj":this.id=e;break;case"div":this.div=e,this.div.tna=this,this.id=e.id;break;case"id":default:this.div=document.getElementById(e),this.div!=null?this.div.tna=this:console.error(`tna construct no element for ${e}`),this.id=this.div==null?e:this.div.id;break}this.bRenderEnd=this.renderEnd.bind(this)}fuse(){return this.div==null?console.warn(`${this.id} fuse no div`):(this.div.classList.add("_tna"),this)}shy(e=!0){return this.div.classList.toggle("shy",e),this}prime(e=!0){if(this.div!=null)return this.div.classList.toggle("prime",e),this}touchPrime(){return this.div.ontouchstart=()=>{},this}show(){return this.render(!0),this}hide(){return this.render(!1),this}view(e=!0,t=!1){return this.render(e,t),this}viewStaged(e){return this.view(e,!0)}render(e=this._view,t=!1){this._view=e,this.div.classList.toggle("show",e),t?this.div.addEventListener("transitionend",this.bRenderEnd):this.callRender()}draw(){}renderEnd(){this.div.removeEventListener("transitionend",this.bRenderEnd),this.div.style.transition="",this.callRender()}callRender(){this.onRender!=null?this.onRender(this):this._view&&(this.onShow!=null?this.onShow(this):this.onHide!=null&&this.onHide(this))}display(e=!0){return console.log(`${this.id} display b:%o`,e),this.div.style.display=e?"":"none",this}getDiv(e,t){const i=this.div.querySelector(`#${e}`);if(i==null){console.warn(`${this.id} getDiv FAIL for "${e}"`);return}const n=t==null?this.div.id:t;return i.id=`${e}_${n}`,i}setProp(e,t){this.div.style.setProperty(e,t)}getProp(e){return getComputedStyle(this.div).getPropertyValue(e)}getPropVal(e){return parseFloat(this.getProp(e))}getDataAttr(e,t,i){const n=this.div.dataset[e],o=`--${e.camelKabob()}`,l=this.getProp(o);let d,u="";switch(t){case"pixel":u="px";case"integer":d=parseInt(n);break;case"percent":u="%";case"number":case"float":d=parseFloat(n);break;case"s":d=parseFloat(n)*1e3;break;case"string":return n==null?l.length>0?l:i:(d=n,d);default:d=parseFloat(n),n.indexOf("%")>0&&(u="%"),n.indexOf("px")>0&&(u="px");break}return isNaN(d)&&(d=parseInt(l),l.indexOf("%")>0&&(u="%"),l.indexOf("px")>0&&(u="px")),isNaN(d)&&d!=null&&(d=i),this.div.style.setProperty(o,d+u),d}parent(e,t){for(;!(e.id.indexOf(t)!=-1||e.parentElement==null);)e=e.parentElement;return e}async delay(e=1){return new Promise(t=>{setTimeout(()=>{t()},e)})}set(e){return this.data=e,e!=this._valLast&&(this.draw(),this.onChange!=null&&this.onChange(this,e),this._valLast=e),this}enable(e=!0){return this._enable=e,this}tag(...e){for(const t of e)this._tags.push(t);return this}hasTag(...e){let t=!1;for(const i of e)t=t||this._tags.find(n=>n==i);return t}latchClass(e){return this.div.querySelectorAll("._"+e).forEach(i=>i.classList.add(e)),this}set id(e){this._id=e}get id(){return this._id}valRef(e){return this._valRef=e,this}valIO(){return this._valIO=!0,this}set value(e){if(this._valIO&&this._valRef!=null&&this._valRef[0].val!=null){let t=this._valRef.findIndex(i=>i.val==e);t==-1&&(t=0,console.warn(`${this.id} set value(${e}) FAIL not in valRef, using _val:0`)),e=t}this._val=e}get value(){let e=this._val;return this._valIO&&this._valRef!=null&&this._valRef[0].val!=null&&(e=this._valRef[e].val),e}set height(e){this._height=e}get height(){return this._height}tron(e=!0){return this._tron=e,this}clamp(e,t,i){return Math.min(Math.max(e,t),i)}easeLinear(e,t,i,n){return i*e/n+t}easeInQuad(e,t,i,n){return i*(e/=n)*e+t}easeOutQuad(e,t,i,n){return-i*(e/=n)*(e-2)+t}easeInOutQuad(e,t,i,n){return(e/=n/2)<1?i/2*e*e+t:-i/2*(--e*(e-2)-1)+t}easeInSine(e,t,i,n){return-i*Math.cos(e/n*(Math.PI/2))+i+t}easeOutSine(e,t,i,n){return i*Math.sin(e/n*(Math.PI/2))+t}easeInOutSine(e,t,i,n){return-i/2*(Math.cos(Math.PI*e/n)-1)+t}easeInCubic(e,t,i,n){return i*(e/=n)*e*e+t}easeOutCubic(e,t,i,n){return i*((e=e/n-1)*e*e+1)+t}easeInOutCubic(e,t,i,n){return(e/=n/2)<1?i/2*e*e*e+t:i/2*((e-=2)*e*e+2)+t}easeOutElastic(e,t,i,n){let o,l=0,d=i;return e==0?t:(e/=n)==1?t+i:(l||(l=n*.3),d<Math.abs(i)?o=l/4:o=l/(2*Math.PI)*Math.asin(i/d),d*Math.pow(2,-10*e)*Math.sin((e*n-o)*(2*Math.PI)/l)+i+t)}}class dt extends O{constructor(t){super(t);a(this,"_enable",!1);a(this,"_dynamic",!1);a(this,"_val",!1);a(this,"onChange");this.div.classList.add("tna_Accord"),this.div.dataset.dynamic!=null&&this.dynamic(),this.div.dataset.open!=null&&this.open(),this.div.dataset.prime!=null&&this.prime(),this._spill=this.div.dataset.spill!=null,this.bSpill=this.spill.bind(this)}prime(){return this.div.classList.add("prime"),this}resize(){const t=this.div.classList.contains("prime");this.div.classList.remove("prime"),this.div.classList.add("open"),this.div.style.setProperty("--accord-h","");const i=this.div.offsetHeight;this.div.style.setProperty("--accord-h",i+"px"),this.div.classList.toggle("open",this._val),this.div.classList.toggle("prime",t)}toggle(t){return this._val=t==null?!this._val:t,this._val?this.open():this.close(),this}open(){return this._val=!0,this.div.classList.add("open"),this._spill&&this.div.addEventListener("transitionend",this.bSpill),this.onChange!=null&&this.onChange(this),this}close(){return this._val=!1,this.div.classList.remove("open","spill"),this.onChange!=null&&this.onChange(this),this}spill(){return console.log(`${this.id} spill`),this.div.classList.add("spill"),this.div.removeEventListener("transitionend",this.bSpill),this}dynamic(t=!0){return t&&!this._dynamic?window.addEventListener("resize",this.resize.bind(this)):window.removeEventListener("resize",this.resize.bind(this)),this.resize(),this._dynamic=t,this}}const gs=`<div id="region" class="region">
    <div id="bg" class="bg"></div>
    <div id="label" class="label"></div>
  </div>`;class vs extends O{constructor(t){super(t);a(this,"_label");this._label=this.div.innerHTML,this.div.innerText="",this.div.insertAdjacentHTML("beforeend",gs),this.div.classList.add("tna_RetroT"),this.dRegion=this.getDiv("region"),this.dLabel=this.getDiv("label"),this.dBg=this.getDiv("bg"),this.dLabel.innerText=this._label}}const Ei={};function ms(){bs(),xs(),Te()}async function ws(){for(const[s,e]of Object.entries(Ei))e.prime()}function bs(){document.querySelectorAll("._tna_Accord").forEach((e,t)=>{e.id.length==0&&(e.id=`accord_${t}`);const i=e.id.length!=0?e.id:t;Ei[i]=new dt(e.id)})}function xs(){document.querySelectorAll("._hr").forEach((e,t)=>{e.id.length==0&&(e.id=`hr_${t}`);const i=e.id.length!=0?e.id:t;Ei[i]=new O(e.id).fuse(),e.classList.add("hr_wrap");const n=document.createElement("hr");e.insertAdjacentElement("afterbegin",n)})}function Te(){let s;s=document.querySelectorAll(".tna_RetroT"),s.forEach((e,t)=>{e.id.length==0&&(e.id=`retro_text_${t}`),new vs(e.id)})}var Mt={init:ms,prime:ws,items:Ei,retro:Te},et={};(function(s){(function(){var e={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function t(d){return n(l(d),arguments)}function i(d,u){return t.apply(null,[d].concat(u||[]))}function n(d,u){var c=1,m=d.length,h,L="",w,b,_,si,$i,Si,Pi,yt;for(w=0;w<m;w++)if(typeof d[w]=="string")L+=d[w];else if(typeof d[w]=="object"){if(_=d[w],_.keys)for(h=u[c],b=0;b<_.keys.length;b++){if(h==null)throw new Error(t('[sprintf] Cannot access property "%s" of undefined value "%s"',_.keys[b],_.keys[b-1]));h=h[_.keys[b]]}else _.param_no?h=u[_.param_no]:h=u[c++];if(e.not_type.test(_.type)&&e.not_primitive.test(_.type)&&h instanceof Function&&(h=h()),e.numeric_arg.test(_.type)&&typeof h!="number"&&isNaN(h))throw new TypeError(t("[sprintf] expecting number but found %T",h));switch(e.number.test(_.type)&&(Pi=h>=0),_.type){case"b":h=parseInt(h,10).toString(2);break;case"c":h=String.fromCharCode(parseInt(h,10));break;case"d":case"i":h=parseInt(h,10);break;case"j":h=JSON.stringify(h,null,_.width?parseInt(_.width):0);break;case"e":h=_.precision?parseFloat(h).toExponential(_.precision):parseFloat(h).toExponential();break;case"f":h=_.precision?parseFloat(h).toFixed(_.precision):parseFloat(h);break;case"g":h=_.precision?String(Number(h.toPrecision(_.precision))):parseFloat(h);break;case"o":h=(parseInt(h,10)>>>0).toString(8);break;case"s":h=String(h),h=_.precision?h.substring(0,_.precision):h;break;case"t":h=String(!!h),h=_.precision?h.substring(0,_.precision):h;break;case"T":h=Object.prototype.toString.call(h).slice(8,-1).toLowerCase(),h=_.precision?h.substring(0,_.precision):h;break;case"u":h=parseInt(h,10)>>>0;break;case"v":h=h.valueOf(),h=_.precision?h.substring(0,_.precision):h;break;case"x":h=(parseInt(h,10)>>>0).toString(16);break;case"X":h=(parseInt(h,10)>>>0).toString(16).toUpperCase();break}e.json.test(_.type)?L+=h:(e.number.test(_.type)&&(!Pi||_.sign)?(yt=Pi?"+":"-",h=h.toString().replace(e.sign,"")):yt="",$i=_.pad_char?_.pad_char==="0"?"0":_.pad_char.charAt(1):" ",Si=_.width-(yt+h).length,si=_.width&&Si>0?$i.repeat(Si):"",L+=_.align?yt+h+si:$i==="0"?yt+si+h:si+yt+h)}return L}var o=Object.create(null);function l(d){if(o[d])return o[d];for(var u=d,c,m=[],h=0;u;){if((c=e.text.exec(u))!==null)m.push(c[0]);else if((c=e.modulo.exec(u))!==null)m.push("%");else if((c=e.placeholder.exec(u))!==null){if(c[2]){h|=1;var L=[],w=c[2],b=[];if((b=e.key.exec(w))!==null)for(L.push(b[1]);(w=w.substring(b[0].length))!=="";)if((b=e.key_access.exec(w))!==null)L.push(b[1]);else if((b=e.index_access.exec(w))!==null)L.push(b[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");c[2]=L}else h|=2;if(h===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");m.push({placeholder:c[0],param_no:c[1],keys:c[2],sign:c[3],pad_char:c[4],align:c[5],width:c[6],precision:c[7],type:c[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");u=u.substring(c[0].length)}return o[d]=m}s.sprintf=t,s.vsprintf=i,typeof window!="undefined"&&(window.sprintf=t,window.vsprintf=i)})()})(et);function ys(s){return new Promise(e=>{setTimeout(()=>{e()},s)})}String.prototype.camelKabob=function(){let s="";return this.split("").map(e=>{s+=e.toUpperCase()==e?`-${e.toLowerCase()}`:e}),s};String.prototype.kabobCamel=function(){return this.replace(/-./g,s=>s[1].toUpperCase())};function ks(s,e,t){if(e.value==null){console.warn(`initStorage FAIL name:${s} target:${e}`);return}const i=localStorage.getItem(s);if(i!=null)return e.value=parseFloat(i),console.log(`initStorage ${s}:${e.value} data:${parseFloat(i)}`),e.value;if(t==null)localStorage.setItem(s,Number(e.value)),console.warn(`initStorage none:${s}, target:${e.value}`),e.onDefault!=null&&e.onDefault();else return localStorage.setItem(s,Number(t)),console.warn(`initStorage none:${s}, default:${t}`),e.value=t,t}function Ls(s){const e=s.split(".");let t="";for(let i in e)t+=i!=1?e[i]:Number("0x"+e[1]),i<e.length-1&&(t+=".");return t}var S={delay:ys,initStorage:ks,versionString:Ls};const Ee=["ping","call","ux","info","push","save","sync"],Ie=["call_prime","call_console","call_tune","call_warn","call_restart","call_admin","call_photo","call_gps_log"],Ds=["none","default","notify","toggle_on","toggle_off","alarm","close_encounter","charge_fanfare","bonanza","guantanamera","rhythm_dancer"],Ts=["OK",'"index.html" served from FS'],$e=["null","sys_splash","sys_boot","sys_ap","sys_ota","sys_restart","sys_fail","reset_user","reset_admin","net_setup","net_menu","net_fail","set_bright","set_sound","tap_menu","tap_test","tap_notify","clock_static","clock_hide","clock_switch","clock_service","clock_tz","clock_dst","clock_24h","clock_pps","alarm_menu","alarm_set","alarm_notify","alarm_snooze","diag_info","diag_serial","diag_console","diag_net","diag_net_mac","diag_gps","diag_led","photo"],Se=["idle","init","begin","splash","prime","ready","run","update","wait","confirm","notify","commit","end","exit","cancel","expire","fail"],Pe=["info_rc","info_user","info_mfg","info_reg","info_hardware","info_firmware","info_install","info_uptime","info_net","info_rssi","info_display","info_status","info_tap","info_ntp","info_gps","info_gps_log"],Ce=["admin_sign","admin_fpo","ota_version","ota_version_fs","ota_time","ota_time_fs","ota_fpo","mfg_product","mfg_version","mfg_date","mfg_serial","mfg_logic","mfg_display","mfg_color","mfg_note","mfg_fpo","reg_date","reg_name_1","reg_name_2","reg_user","reg_gift","reg_gp_1","reg_gp_2","reg_fpo","sys_output","sys_console","sys_fpo","def_name","def_device","def_ssid","def_pass","def_alert","def_net_fpo","def_bright","def_sound","def_av_fpo","def_tap_act","def_tap","def_tilt","def_tap_fpo","def_ntp_serve","def_ntp_int","def_ntp_fpo","def_nts_fpo","def_gps_alert","def_gps_log_i","def_gps_log_x","def_gps_fpo","def_tz","def_dst","def_24h","def_pps","def_clock_fpo","def_alarm_ind"],Es=100,Me=["ux_boot","ux_index","ux_fpo","user_consent","user_fpo","net_name","net_device","net_ssid","net_pass","net_alert","net_fpo","ui_bright","ui_sound","ui_fpo","tap","tap_mode","tap_tilt","tap_alert","tap_fpo","ntp_server","ntp_interval","ntp_fpo","nts_fpo","gps_alert","gps_log_int","gps_log_ratio","gps_fpo","clock_static","clock_disp","clock_service","clock_tz","clock_dst","clock_24h","clock_pps","clock_fpo","alarm_tap","alarm_fpo","daily","daily_ind","daily_tone","daily_vol","daily_d","daily_h","daily_m","daily_snooze"],Is={display:0,piezo:1,xpio:2,gps:3},$s={display:1,piezo:2,xpio:4,gps:8},Ss=["CLOCK_HHMM","CLOCK_DATE","CLOCK_MMSS"],Ps=["NTP","GPS","pps","none"],Cs={action:Ee,call:Ie,ux:$e,info:Pe,admin:Ce,pref:Me,stage:Se};var M={master:Cs,hwOffset:Is,hwMask:$s,actionID:Ee,callID:Ie,tuneID:Ds,warnID:Ts,uxID:$e,stageID:Se,infoID:Pe,prefBase:Es,prefID:Me,adminID:Ce,clockID:Ss,serviceID:Ps};const It={},$t={};let st=!1;var r={...M,getPrefID:Fs,controls:It,linkControl:Ms,getControlByID:Ns,getControlByIndex:Os,dialogs:$t,linkDialog:Hs,printDialogs:Bs,getDialogByIndex:Rs,tron:As};function Ms(s){const e=M.master[s.linkType];if(e==null){st&&console.log(`linkControl FAIL id:${s.id}, bad type:${s.linkType}`);return}const t=e.indexOf(s.id),i=s.linkType=="pref"?M.prefBase:0;return t<0?(st&&console.log(`linkControl FAIL not found id:${s.id}`),!1):(s.linkID=t+i,It[s.id]={obj:s},!0)}function Ns(s){if(It.hasOwnProperty(s))return It[s].obj;st&&console.log(`map.getControlByID FAIL no table entry for ${s}`)}function Os(s,e){let t=0;switch(s){case"action":t=M.actionID[e];break;case"call":t=M.callID[e];break;case"ux":t=M.uxID[e];break;case"info":t=M.infoID[e];break;case"pref":t=M.prefID[e-M.prefBase];break;case"admin":t=M.adminID[e];break}if(t==0){st&&console.log(`map.getControlByIndex FAIL not registered ${typeID}: ${e}`);return}if(It.hasOwnProperty(t))return It[t].obj;st&&console.log(`map.getControlByIndex FAIL no object ${typeID}:${e}`)}function Fs(s){let e=M.prefID.indexOf(s);if(e!=-1)return e+M.prefBase;console.warn(`getPrefID FAIL ${s} not found`)}function As(s=!0){st=s}function Hs(s){const e=M.uxID.indexOf(s.id);switch(e){case-1:return st&&console.log(`map.linkDialog FAIL id:${s.id}`),!1;default:s.linkID=e,$t[s.id]={obj:s};break}return!0}function Rs(s){const e=M.uxID[s];if(e==null){st&&console.log(`map.getDialogByIndex FAIL ux not registered for ${s}`);return}if($t.hasOwnProperty(e))return $t[e].obj;st&&console.log(`map.getDialogByIndex FAIL no object for :${e}`)}function Bs(){console.warn("printDialogs");for(const s in $t)console.log(`  ${$t[s].obj.id}`)}class R extends O{constructor(t,i){super(t,i);a(this,"_enable",!1);a(this,"autoEnable",!0);a(this,"primed",!1);a(this,"synced");a(this,"linked");a(this,"linkType");a(this,"linkID");a(this,"valPush");a(this,"valSave");a(this,"lastTime");this._val=0}link(t){t!=null&&(this.linkType=t,this.linked=r.linkControl(this))}sync(t){const i=t.v;this.value=i,this.valPush=this.valSave=i,this.set(t),this.synced||(this.autoEnable&&this._enable!=null&&this.enable(),this.synced=!0)}push(){if(this.linked==!1)return;const t=this.value;t!=this.valPush&&(this.valPush=t,this.send("push",t))}save(){if(this.linked==!1)return;const t=this.value;t!=this.valSave&&(this.valSave=this.valPush=t,this.send("save",t))}send(t,i){const n={a:r.actionID.indexOf(t),t:[]};n.t.push({i:this.linkID,v:i|0}),this.linked!=null&&f.transmit(n,`${this.id} >>`)}}const zs=`<div id="region" class="region">
    <div id="wrap" class="wrap"></div>
    <div id="label"></div>
  </div>`;class H extends R{constructor(t,i){super(t);a(this,"_enable",!0);a(this,"_highlight",!1);a(this,"_static",!1);a(this,"_target");a(this,"_index");a(this,"_x0",0);a(this,"_y0",0);a(this,"_x1",100);a(this,"_y1",100);a(this,"_x",0);a(this,"_y",0);a(this,"_scaleX",1);a(this,"_scaleY",1);a(this,"list",[]);a(this,"onExecute");this.link(i),this.target(this.div),this.div.insertAdjacentHTML("beforeend",zs),this.div.classList.add("tna_Icon"),this.dRegion=this.getDiv("region"),this.dWrap=this.getDiv("wrap"),this.dLabel=this.getDiv("label"),isNaN(this.getPropVal("--icon-w"))&&this.setProp("--icon-w",this.getProp("--icon-h")),this._val=0,this.label=this.getDataAttr("label","string","")}set add(t){const i=`
      <svg class="svg" viewBox="${this._x0} ${this._y0} ${this._x1} ${this._y1}">
        <g><circle cx="0" cy="0" r="50" /></g>
      </svg>`;this.dWrap.insertAdjacentHTML("beforeend",i);const n=this.dWrap.lastChild,o=n.lastElementChild;o.innerHTML=t,this.list.push(n),this.update()}set addCenter(t){this.add=t,this.list.slice(-1)[0].lastElementChild.firstElementChild.setAttribute("transform","translate(-50 -50)")}symbol(t){return window["sym_"+t]==null?console.warn(`${this.id} addSymbol FAIL: ${t}`):this.add=`<use href="#sym_${t}"/>`,this}enable(t=!0){return t==this._enable?this:(this._enable=t,this.render(),this)}render(t=this._view,i){super.render(t,i),this.div.classList.toggle("interact",t&&this._enable&&!this._static),this.div.classList.toggle("disable",!this._enable&&this._view)}set index(t){if(t=Number(t),isNaN(t))return console.warn(`${this.id} set index NaN`);if(t==this._index)return;this._index!=null&&this.list[this._index].classList.remove("show"),this.list[t].classList.add("show"),this._index=t}get index(){return this._index}def(){return this.index=0,this}toggle(t){return this._val=t==null?!this._val:t,this.draw(t),this}cycle(){let t=this._index+1;return t=t>=this.list.length?0:t,this.index=t,this.draw(),this}clear(){this.list.forEach(t=>t.remove()),this.list=[]}update(){const t=`translate(${this._x} ${this._y}) scale(${this._scaleX} ${this._scaleY})`;for(let i in this.list)this.list[i].firstElementChild.setAttribute("transform",t)}execute(){this.onExecute!=null&&this.onExecute(this),this.onChange!=null&&this.onChange(this)}set(t){typeof t!="object"&&(this.value=t),t!=this.lastVal&&(this.index=this.value),super.set(t)}svgRef(t){return t>this.list.length-1?console.warn(`${this.id} svgRef FAIL, bad index`):this.list[t]}gRef(t){return t>this.list.length-1?console.warn(`${this.id} gRef FAIL, bad index`):this.list[t].firstElementChild}viewBox(t,i,n,o){return this._x0=t,this._y0=i,this._x1=n,this._y1=o,this}translate(t,i){return this._x=t,this._y=i,this.update(),this}center(){return this.translate(50,50),this}scaleXY(t,i){return this._scaleX=t,this._scaleY=i,this.update(),this}scale(t){return this._scaleX=this._scaleY=t,this.update(),this}scaleCenter(t){return this._scaleX=this._scaleY=t,this._x=50,this._y=50,this.update(),this}sizeXY(t,i){return this.div.style.setProperty("--icon-h",i+"px"),this.div.style.setProperty("--icon-w",t+"px"),this}size(t){return this.div.style.setProperty("--icon-x",t),this}highlight(t){if(t==-1&&(t=!this._enable),!!this._enable)return this._highlight=t,this.div.classList.toggle("highlight",t),this}static(t=!0){return this._static=t,this.div.classList.toggle("interact",!t),this}set label(t){const i=t.length>0;this.dLabel.innerText=i?t:"",this.dLabel.classList.toggle("label",i)}target(t){return this._target=typeof t=="string"?window[t]:t,this._target.onclick=this.execute.bind(this),t!=this.div&&(this.div.style.pointerEvents="none"),this}enabled(){return this._enable}}class nt extends H{constructor(t,i){super(t);a(this,"_class");a(this,"_anim");a(this,"_count",0);a(this,"_duration",0);a(this,"_delay",0);a(this,"onAnimEnd");this.link(i)}async act(t=!0){const i=this._class!=null?"act_"+this._class:"act";if(this.div.classList.contains(i)&&(this.div.classList.remove(i),await this.delay()),this.div.classList.toggle(i,t),t){const n="tna_Icon_"+(this._anim!=null?"act_"+this._anim:"act");this.div.onanimationend=o=>{`${this.id}`,o.animationName==n&&this.div.classList.remove(i),this.div.onanimationend=void 0,this.onAnimEnd!=null&&this.onAnimEnd(this)}}else this.div.onanimationend=void 0;return this}choreo(t,i){return this._anim=t,this._class=t+(i==null?"":"_"+i),this}timing(t,i=this._dur,n=0){this._count=t=Number(t),this._dur=i=Number(i),this._delay=n=Number(n);const o="--icon-act_"+this._anim;return this.setProp(o+"-n",t==0?"infinite":t),this.setProp(o+"-t",i+"ms"),this.setProp(o+"-d",n+"ms"),this}property(t,i){this.dWrap.style.setProperty("--icon-act-"+t,i)}}const Ws=`<g fill="var(--icon-fg)" transform="translate(-50, -50)">
      <use href="#sym_hit" />
    </g>
    <g fill="var(--icon-fg)" transform="translate(-50, -50)">
      <use href="#sym_help" />
    </g>`,Vs=`<circle fill="white" stroke="none" cx="0" cy="0" r="50" />
    <g fill="black" transform="translate(-50, -50)">
      <use href="#sym_help" />
    </g> `;var ee={help_1:Ws,help_2:Vs};const Ne={},ft={enable:!1},Nt={};let z;function Us(){js();let s;s=document.querySelectorAll("._help"),s.forEach(e=>ps.nest(e,"wrap")),s=document.querySelectorAll("._help"),s.forEach((e,t)=>{e.id.length==0&&(e.id=`help_${t}`);const i=e.id.length!=0?e.id:t;e.setAttribute("data-dynamic",""),Nt[i]=new dt(e.id)}),window.help!=null&&(Ne.button=z=new H("help").show(),z.add=ee.help_1,z.add=ee.help_2,z.translate(50,50).def(),z.onExecute=e=>{e.value^=!0},z.onChange=async e=>{e.index=e.value,e.value||(p.prop.prime_local=!1),localStorage.setItem("help",Number(e.value)),Oe()},S.initStorage("help",z,!0)),ft.flag=!1}function Xs(){z.onChange(z)}async function qs(){for(const[s,e]of Object.entries(Nt))e.prime()}function Gs(){return!!z.value}function Oe(s){ft.enable=!!z.value;for(const[e,t]of Object.entries(Nt))t.toggle(ft.enable);ft.onUpdate!=null&&ft.onUpdate(ft.enable)}function Ys(s){Nt[s.id]=s}function js(){let s;s=document.querySelectorAll("._help"),s.forEach((e,t)=>{e.id.length==0&&(e.id=`help_${t}`);const i=e.id.length!=0?e.id:t;Nt[i]=new dt(e.id)})}var I={tna:Ne,prop:ft,item:Nt,init:Us,prime:qs,stage:Xs,state:Gs,update:Oe,add:Ys};const St=[];let Pt;function Js(s,e){const t=window[s];if(t==null)return console.log(`panel.add() FAIL, cannot find ${s}`);t.dataset.index=St.length,St.push({id:s,title:e,panel:t})}function Zs(){if(Pt!=null)return St[Pt].panel}function Ks(){return Pt}function Qs(){return Pt!=null?St[Pt].id:void 0}function Fe(s,e=!1){s<0||(Pt=s,St.forEach((t,i)=>{const n=t.panel,o=s==i;e||(n.classList.toggle("show",o),n.children[0].classList.toggle("show",o)),o&&n._tna_begin!=null&&n._tna_begin()}))}function tn(s,e=!1){const t=St.findIndex(i=>i.id==s);return t!=null&&Fe(t,e),t}function en(s){return new URLSearchParams(s).get("panel")}var N={add:Js,current:Zs,currentID:Qs,currentIndex:Ks,index:Fe,setByID:tn,inject:en};class Oi extends O{constructor(t,i){super(t,"div");a(this,"_static",!1);a(this,"_index");a(this,"_label");a(this,"_html");a(this,"_target");a(this,"control");a(this,"bClick");if(i!=null){this.control=i,this.div.classList.add("menu_item"),this.dLabel=this.getDiv("label"),this.bClick=this.click.bind(this);let n=this.div.querySelector("._click");n==null&&(n=this.div),n._tna_target=this.div,this._target=n}else this.div.classList.add("menu_static"),this._target=this.div,this.static();this.enable()}click(t){let i=t.target._tna_target;i==null&&(i=this.parent(t.target,"_item")),this.execute(i),t.preventDefault(),t.stopImmediatePropagation()}async execute(t){this.control.click(this),this.div.classList.remove("hover"),this.div.classList.add("action"),await this.delay(360),this.control.view(!1),await this.delay(300),this.div.classList.remove("action"),this.control.execute(this)}enable(t=!0){return this.enabled=t,this.control!=null&&this.div.classList.toggle("hover",t&&this.control._hover),this.div.classList.toggle("enable",t),this._target.onclick=t&&!this._static?this.bClick:null,this._target.style.pointerEvents=t&&!this._static?"":"none",this}highlight(t=!0){return this.div.classList.toggle("highlight",t),this.enable(!t),this}set label(t){this.dLabel.innerText=this._label=t}get label(){return this._label}set html(t){this.dLabel.innerHTML=this._html=t}static(t=!0){return this._static=t,this._target.onclick=this.enabled&&!this._static?this.bClick:null,this._target.style.pointerEvents=t?"none":"",this}}const sn=`<div id="region" class="region">
    <div id="bg" class="bg"></div>
    <div id="panel" class="panel"></div>
  </div>`,nn=`<div>
    <div id="label" class="label"></div>
  </div>`;class an extends O{constructor(t,i=sn){super(t);a(this,"_enable",!1);a(this,"_index");a(this,"_highlight",!1);a(this,"_hover",!0);a(this,"_static_high",!0);a(this,"_wipe",!1);a(this,"_tm_open");a(this,"_tm_close");a(this,"_block_tm_open");a(this,"_block_tm_close");a(this,"_block_opacity");a(this,"_itemT");a(this,"_staticT");a(this,"_itemN",0);a(this,"_staticN",0);a(this,"pool",[]);a(this,"list",[]);a(this,"last");a(this,"onBegin");a(this,"onEndPrime");a(this,"onEnd");a(this,"onPrime");a(this,"onExecute");a(this,"onResize");this._itemT=nn,this.div.insertAdjacentHTML("afterbegin",i),this.div.classList.add("tna_Menu"),this.dRegion=this.getDiv("region"),this.dBg=this.getDiv("bg"),this.dPanel=this.getDiv("panel"),this.getDiv("banner"),this.blocked=this.div.dataset.block!=null,this.blocked&&(this.dBlock=document.createElement("div"),this.dBlock.id="block",this.div.insertAdjacentElement("afterbegin",this.dBlock),this.getDiv("block"),this.dBlock.classList.add("block"),this.dBlock.onmousedown=this.dBlock.ontouchstart=this.escape.bind(this)),this._highlight=this.div.dataset.highlight!=null,this.enable(this.div.dataset.enable!=null),this._block_opacity=this.getProp("--menu-block-a"),this.itemH=this.getDataAttr("menuIH","pixel",""),this.staticH=this.getDataAttr("menuStaticH","pixel",""),this.merge()}merge(){let t,i;const n=this.div.childElementCount-this.blocked;for(let o=1;o<n;o++)i=this.div.children[1+this.blocked],i.classList.contains("menu_item")?(t=this.add(),t.link=i.dataset.link,t.label=i.innerHTML,i.dataset.highlight!=null&&(this._index=t._index)):i.classList.contains("menu_static")&&(t=this.add("static")),t.view(!0),i.remove();this._index!=null&&this.index(this._index),n>1&&this.update()}add(t="item"){let i,n;switch(t){case"static":if(this._staticT!=null){const o=document.createElement("template");o.innerHTML=this._staticT,n=o.content.firstElementChild.cloneNode(!0)}else n=document.createElement("div");this.last=this.createStatic(n);break;default:if(this._itemT!=null){const o=document.createElement("template");o.innerHTML=this._itemT,n=o.content.firstElementChild.cloneNode(!0)}else n=document.createElement("div");this.last=this.createItem(n);break}return i=this.dPanel.appendChild(n),this.pool.push(i),this.last}createItem(t){const i=new Oi(t,this),n=`${this.id}_item_${this._itemN}`;return t.id=i.id=n,i._index=this._itemN,i.link=this._itemN,i.height=this.itemH,this.list.push(t),this._itemN++,i}createStatic(t){const i=new Oi(t).static(),n=`${this.id}_static_${this._itemN}`;return t.id=i.id=n,i.height=this.staticH,this._staticN++,i}index(t){this._index=t;for(let i in this.pool)this.pool[i].tna.highlight(!1);return t>=0&&this.list[t].tna.highlight(),this.setStatic(t),super.set(t),this}setStatic(t){if(!this._static_high)return;let i;if(this.pool.find((n,o)=>{const l=n==this.list[t];return l&&(i=o),l}),i!=null){const n=i-1,o=i+1;n>=0&&this.pool[n].tna.highlight(),o<this.pool.length-1&&this.pool[o].tna.highlight()}}update(){let t=0;return this.pool.forEach((i,n)=>{t+=i.tna.height*i.tna._view}),this.height=t,t}clear(){this.list.forEach(t=>{t.tna=void 0,t.remove()}),this.list=[],this.pool=[],this._itemN=this._staticN=0,this.update()}click(t){this.last=t,this._wipe&&this.index(-1),this.setStatic(t._index),this.onPrime!=null&&this.onPrime(t,t.link)}execute(t){this._highlight&&(t.enable(!1),this.index(t._index)),this.onExecute!=null&&this.onExecute(this,t.link)&&this.end()}async escape(t){t!=null&&(t.stopImmediatePropagation(),t.preventDefault()),this.view(!1),this.transBlock(this._block_tm_close),this.onEnd!=null&&this.onEnd(this)}begin(){this.transRegion(this._tm_open,"ease-out"),this.transBlock(this._block_tm_open,"ease"),this.onBegin!=null&&this.onBegin(this,!0)}endPrime(){this.transRegion(this._tm_close,"ease-in"),this.onEndPrime!=null&&this.onEndPrime(this)}end(){this.transBlock(),this.onEnd!=null&&this.onEnd(this)}render(t=this._view){super.render(t),this.div.classList.toggle("open",t),t?this.begin():this.endPrime()}find(t){return this.list.find(n=>n.tna.label==t)}wipe(t=!0){return this._wipe=t,this}hover(t=!0){return this._hover=t,this}set height(t){this._height=t,this.div.style.setProperty("--menu-h",t+"px"),this.onResize!=null&&this.onResize(this)}get height(){return this._height}get count(){return Object.keys(this.list).length}get next(){if(this.last._index<this.count)return this.list[this.last._index+1]}get previous(){if(this.last._index>0)return this.list[this.last._index-1]}set template(t){this._itemT=t}set templateStatic(t){this._staticT=t}staticHigh(t=!0){return this._static_high=t,this}timing(t,i){return this._tm_open=t,this._tm_close=i,this}timingBlock(t,i){return this._block_tm_open=t,this._block_tm_close=i,this}transRegion(t=0,i=""){const n=t+"ms";return this.dRegion.style.transitionDuration=n,this.dRegion.style.transitionTimingFunction=i,this}transBlock(t=0,i=""){const n=t+"ms",o=this._view?this._block_opacity:0;return this.dBlock.style.transitionDuration=n,this.dBlock.style.transitionTimingFunction=i,this.dBlock.style.opacity=o,this.dBlock.style.visibility="visible",t==0?this.transBlockEnd():this.dBlock.ontransitionend=this.transBlockEnd.bind(this),this}transBlockEnd(){this._view||(this.dBlock.style.visibility="hidden"),this.dBlock.ontransitionend=void 0}}var on={control:an,item:Oi};const ln=`<g stroke-width="6.7">
    <polygon
      points="89.5 72.8 50 95.6 10.5 72.8 10.5 27.2 50 4.4 89.5 27.2 89.5 72.8"
    />
    <polyline id="badge_N" points="28.4 62 28.4 38 71.6 62 71.6 38" />
  </g>`,rn=`<div id="region" class="region">
    <div id="bg" class="bg"></div>
    <div id="banner" class="banner">
      <div class="banner_wrap">
        <div>C</div><div>u</div><div>b</div><div>e</div>
        <div>C</div><div>o</div><div>r</div><div>e</div></div></div>
    <div id="panel" class="panel"></div>
    </div>
  </div>`;const ci={},Fi=[];let $,F,Ot,Ci,Ae=!1,ni=!1;function dn(){if(ci.badge=F=new nt("badge").show(),F.div.classList.add("connect"),F.add=ln,F.value=!1,F.def(),F.ext_onExecute=e=>{e.choreo("3D_flip").timing(1,250).act(),$.view(!$._view),$._view||$.escape()},Re(!p.prop.modeExt),ci.dot=Ot=new H("badge_dot"),Ot.add='<circle cx="50" cy="50" r="50" />',Ot.static().prime().def(),Ot.onRender=e=>Ot.div.classList.toggle("orbit",e._view),window.menu!=null){ci.menu=$=new on.control("menu",rn).wipe(),Ci=$._index,$.timing(250,250).timingBlock(500,250),$.onExecute=(t,i)=>{t.last.index==0;const n=He(i);return n&&(Ci=t._index),s(),n},$.onBegin=$.onEnd=t=>{F.highlight(t._view);const i=t._view?"blur(3px)":"",n=t._view?t._block_tm_open:t._block_tm_close;ne(n,"ease",i),ni=!1},se("Admin");const e=se("R/Con","rc");e.html='R<span style="padding-left: 2px; font-size: 130%; position: relative; top: 1.5px;">/</span>Con'}const s=async()=>{ni=!0,await S.delay(2e3),ni&&(F.highlight(!1),$.index(Ci),$.transBlock(),ne(),ni=!1)}}function se(s,e){const t=$.find(s);if(t==null){let i=$.add("static").enable();return Fi.push(i),i=$.add().enable(),Fi.push(i),i.label=s,i.link=`/${e!=null?e:s.toLowerCase()}/`,Ae=!0,i}else return t.tna}function ne(s=0,e="",t=""){const i=s+"ms",n=window.fit!=null?N.current():window.page;if(n==null)return console.warn("nav menuBG FAIL");n.style.filter=t,n.style.transitionProperty="filter",n.style.transitionDuration=`${i}`,n.style.transitionTimingFunction=e}function He(s){console.log(`hyper -> "${s}"`);const e=N.currentIndex(),t=new URL(s,"http://x"),i=t.pathname==document.location.pathname;if(i){const n=N.inject(t.search);N.setByID(n)}else!p.prop.local&&s.length>1&&s.slice(-1)=="/"&&(s=s.slice(0,-1)),window.location=s,$.index(e);return i}function hn(s){!Ae||(Fi.forEach(e=>e.view(s)),$.update())}function Re(s=!0){F.div.classList.toggle("static",!s),F.div.classList.toggle("dim",!s),F.onExecute=s?F.ext_onExecute:void 0,F.enable(s)}var it={tna:ci,init:dn,enable:Re,hyper:He,access:hn};class k extends R{constructor(t,i=void 0,n="info"){super(t,i);a(this,"onChange");this.link(n)}}const J={cast:"border-radius: 9px; padding: 1px 7px 0; font-style: italic; font-weight: bold",test:"border: 0.25px solid gray; border-style: solid solid solid none; border-radius: 0 9px 9px 0; padding: 1px 7px 0 0; font-style: italic; font-weight: bold",gray:"border: 0.25px solid gray; background: gray; color: white;",black:"border: 0.25px solid black; background: black; color: white;",red:"border: 0.25px solid red; background: red; color: white;",gold:"border: 0.25px solid gray; background: gold; color: black;"},rt=["fail","cache","cache_end","tear","touch","normal","warn","error","alert","bold"],Ai={},ct={},Z={};let ui,fi,Hi=0;function cn(){ui=r.callID.indexOf("call_console"),Ai.rc=new k("call_console","object","call"),Ai.rc.onChange=(s,e)=>{switch(e.v){case 0:Z.fail!=null?Z.fail():q("fail","Access Not Authorized");break;case 1:e.n==1&&(fi=0);const t=JSON.stringify(e);console.groupCollapsed("cache n:%o, count:%o",e.n,e.z.length),console.log(t),console.groupEnd(),e.z.length&&e.z.forEach(i=>{ct.last_format=rt[i.f],ct.last_msg=i.m,q(Hi?rt[i.f]:"tear",i.m),Hi++}),fi+=e.z.length;break;case 2:console.warn("cache EOL chunks:%o count:%o",e.n,fi),e.c!=null&&(ct.capacity=e.c),e.f!=null&&(ct.full=e.f),Z.cache!=null&&Z.cache();break;default:ct.last_format=rt[e.v],ct.last_msg=e.x,Z.msg!=null&&Z.msg(),q(rt[e.v],e.x);break}}}function un(){Hi=fi=0}function q(s,e){if(Z.output!=null)return Z.output(s,e);switch(s){case"normal":console.log("%cRC",J.gray+J.cast,e);break;case"warn":const t="border: 0.25px black solid;";console.log("%cRC",t+J.gold+J.cast+t,e);break;case"error":console.log("%cRC%c %s",J.red+J.cast,"color: red",e);break;case"bold":console.log("%cRC%c %s",J.black+J.cast,"font-weight: bold",e);break}}function fn(){p.prop.preflight||_n()}function _n(){const s=new CustomEvent("meh"),e="rc.test format:",t={a:r.actionID.indexOf("call"),t:[{i:ui,v:rt.indexOf("normal"),x:e+"normal"},{i:ui,v:rt.indexOf("warn"),x:e+"warn"},{i:ui,v:rt.indexOf("error"),x:e+"error"}]};s.data=JSON.stringify(t),f.parse(s)}function pn(s){q("normal",s)}function gn(s){q("warn",s)}function vn(s){q("error",s)}function mn(s){q("tear",s)}function wn(s){q("alert",s)}function bn(s){q("bold",s)}var G={formatID:rt,style:J,tna:Ai,prop:ct,upon:Z,init:cn,prime:fn,reset:un,log:pn,warn:gn,error:vn,tear:mn,alert:wn,bold:bn};const xn=1,yn=2;class kn extends O{constructor(){super("tron","object");a(this,"_enable",!0);a(this,"state",!1);a(this,"STAGE",Object.freeze({BEGIN:1,END:0}));a(this,"holdTime");a(this,"delayTime");a(this,"showTimeout");a(this,"hideTimeout");a(this,"onWrite");this.setHold().setDelay()}assign(t){const i=window[t];return i==null?console.warn("tron assign FAIL: %o",t):(i.classList.add("tna_Tron"),this.div=i,this)}enable(t=!0){if(this.div!=null&&t!=this._enable)return this.div.classList.toggle("disable",!t),this._enable=t,this}async write(t,i=this.holdTime){this.div!=null&&(clearTimeout(this.hideTimeout),this.div.innerText=t,this.div.classList.add("show","prime"),this.state=!0,this.hideTimeout=setTimeout(this.writeEnd.bind(this),i*1e3),this.onPrime!=null&&this.onWrite(this,STAGE.BEGIN))}async writeEnd(){this.state=!1,this.hideTimeout=void 0,this.div.classList.remove("show"),this.div.ontransitionend=()=>{this.div.classList.remove("prime"),this.onPrime!=null&&this.onWrite(this,STAGE.END),this.div.ontransitionend=void 0}}writeDelay(t,i=this.holdTime,n=this.delayTime){this.div!=null&&(clearTimeout(this.showTimeout),this.state?(this.div.innerText=t,this.write(t,i)):this.showTimeout=setTimeout(this.write.bind(this),n*1e3,t,i))}cancel(){clearTimeout(this.showTimeout)}kill(){this.cancel(),this.writeEnd()}add(t){return t.onTron=i=>this.write(i),this}setHold(t=xn){return this.holdTime=t,this}setDelay(t=yn){return this.delayTime=t,this}}var Be=new kn;class Ln extends R{constructor(){r.prefID.indexOf("ux_index")<0&&console.warn("tna_UX constructor FAIL, cannot find prefID");super("ux_index","object");a(this,"_lastIndex");a(this,"_lastDialog");a(this,"_nextDialog");a(this,"_currentDialog");this.link("pref")}set(t){const i=t.v;if(this._lastIndex!=i&&(this._nextDialog=r.getDialogByIndex(i),this._lastDialog=r.getDialogByIndex(this._lastIndex),this._nextDialog!=null)){this.tron&&this._lastDialog!=null&&`${this._lastDialog.id}`,this._lastDialog!=null&&this.last.exit(),this._nextDialog.begin(),this._lastIndex=this._val=i,this._currentDialog=this._nextDialog,super.set(t);return}}get last(){return this._lastDialog!=null?this._lastDialog:{id:"NULL"}}get lastID(){return this._lastDialog!=null?this._lastDialog.id:void 0}get next(){return this._nextDialog}get current(){return this._currentDialog}get currentID(){return this._currentDialog!=null?this._currentDialog.id:void 0}}const Dn='<div id="region" class="region"></div>',Tn=`
    <svg id="svg" viewBox="0 0 12 13.8" class="digit">
      <g id="a" class="seg">
        <polygon points="9.76 0 10.03 0.31 8.66 1.5 4.33 1.5 3.31 0.34 3.7 0 9.76 0"/>
      </g>
      <g id="b" class="seg">
        <polygon points="10.63 1 9.96 5.77 9.07 6.55 8.44 5.82 8.99 1.88 10.36 0.69 10.63 1"/>
      </g>
      <g id="c" class="seg">
        <polygon points="7.57 11.97 8.13 8.03 9.02 7.25 9.65 7.98 8.97 12.8 8.58 13.14 7.57 11.97"/>
      </g>
      <g id="d" class="seg">
        <polygon points="2.86 12.3 7.19 12.3 8.21 13.46 7.82 13.8 1.76 13.8 1.49 13.49 2.86 12.3"/>
      </g>
      <g id="e" class="seg">
        <polygon points="0.89 12.8 1.56 8.03 2.45 7.25 3.08 7.98 2.53 11.92 1.16 13.11 0.89 12.8"/>
      </g>
      <g id="f" class="seg">
        <polygon points="2.5 6.55 1.87 5.82 2.55 1 2.94 0.66 3.95 1.83 3.39 5.77 2.5 6.55"/>
      </g>
      <g id="g" class="seg">
        <polygon points="8.06 6.15 8.69 6.88 7.8 7.65 3.46 7.65 2.83 6.92 3.72 6.15 8.06 6.15"/>
      </g>
      <g id="dp" class="seg"><circle cx="10.77" cy="13.05" r="0.75" /></g>
    </svg>`,En=`<svg id="svg" viewBox="0 0 12.47 13.8" class="colon">
    <g class="seg" transform="translate(0.2 0)">
      <circle cx="1.72" cy="3.45" r="0.75" />
      <circle cx="0.75" cy="10.35" r="0.75" />
    </g>
  </svg>`;var Mi={HTML:Dn,DIGIT:Tn,COLON:En};class In extends R{constructor(t){super(t);a(this,"_primeD",!1);a(this,"_primeN",0);a(this,"_bright",0);a(this,"digits",[]);a(this,"onPrime");this.fuse(),this.link("info"),this.div.insertAdjacentHTML("beforeend",Mi.HTML),this.div.classList.add("tna_Retro7"),this.dRegion=this.getDiv("region");for(let n=0;n<4;n++){this.dRegion.insertAdjacentHTML("beforeend",Mi.DIGIT);const o=this.dRegion.querySelector("#svg");o.id=`svg_${this.digits.length}_${this.id}`,o.style.setProperty("--retro-i",n),this.digits.push(o)}this.dRegion.insertAdjacentHTML("beforeend",Mi.COLON);const i=this.dRegion.querySelector("#svg");i.id=`colon_${this.id}`,this.divColon=i.children[0]}print(t){for(let i=0;i<4;i++)this.digitRaw(i,t[i])}digitRaw(t,i){let n=this.digits[t].children;for(let o=0;o<8;o++){const l=i>>o&1;n[o].classList.toggle("show",l)}}colon(t=2){this.divColon.classList.toggle("show",t==2)}clear(){this.print([0,0,0,0]),this.colon(!1),this.onChange!=null&&this.onChange(this,this._val)}async reset(){this._primeD=!1,this._primeN=0,this.view(!1),await this.delay(500),this.clear(),this.prime(!1)}async set(t){if(this._val=t.v,!this._primeD&&(this.onBegin!=null?this.onBegin(this):this.show(),this._primeN<2)){let i=0;for(let n=0;n<t.v.length;n++)i+=t.v[n];i>0&&this._primeN++,this._primeN=Math.min(this._primeN,2),this._primeN>1&&this.onPrime!=null&&this.onPrime(this)}this.print(t.v),this.colon(t.v[4]),this.onChange!=null&&this.onChange(this,t)}bright(t=0){return this._bright=t,this.div.classList.toggle("dim",t==0),this}}const ze="3.1.05",We={}.VITE_PREFLIGHT==="true",$n={}.VITE_EXT_SERVE==="true";We||console.warn("core PREFLIGHT: %o",!1);const P={},A={preflight:We,modeExt:$n,modeAP:!1,prime_local:!1},Q={},Yt={},kt={},ot={};let ai,Ve,W,U,xi,X,Ri=!1;function Sn(){Be.assign("tron_output"),Nn(),Cn(),P.title=W=new O("head_title"),W.div.classList.add("click"),W.div.onclick=()=>{let e=Yt.title!=null?Yt.title():!1;e=e==null?!1:e,e||console.log("core title click default")},W.fuse().shy(!(A.modeExt||!xi)).view(),Pn(),window.diag_client.innerText=S.versionString(ze);const s=String(document.location);A.local=s.includes("host:")||s.includes("local:"),ai=new k("developFPO","object"),ai.onDefault=()=>A.prime_local=!0,S.initStorage("develop",ai),A.develop=ai.value,P.ux=Ve=new Ln().tron(),it.init()}function Pn(){window.socket!=null&&(X=new H("socket").prime().show().enable(),X.symbol("x").symbol("o"),X.value=!0,X.index=1,X.onExecute=s=>{s.toggle(),s.index=s.value,f.monitor(s.value),s.value?f.init():f.kill()},P.socket_button=X)}function Cn(){A.modeExt||(xi=window.info_display!=null,xi&&(P.retro=U=new In("info_display"),U.ext_no_prime=!0,U.ext_view=void 0,U.onBegin=s=>{},U.onRender=(s,e)=>{const t=e!=null?e:s._view;s.ext_view!=t&&(s.ext_view=t,s.div.classList.toggle("click",t),s._view&&s.shy(!1))},U.div.onclick=Mn))}function Mn(){let s=Yt.retro!=null?Yt.retro():!1;s=s==null?!1:s,s||(console.log("RD click default, ux:",Ve.currentID),f.send("save","clock_disp",-1))}function Nn(){if(window.rc_ind==null||A.user==0)return;const s=new k("info_rc","object");G.upon.msg=(e=G.prop.last_format)=>{const t=A.user!=null?A.user:0;P.rc_ind.view(e!=G.formatID.indexOf("touch")&&t)},s.onChange=(e,t)=>{G.upon.msg(t.v)},P.rc_ind=new nt("rc_ind").symbol("dot").def(),P.rc_ind.onExecute=async e=>{e.choreo("blink","hot").timing(3,150).act(),e.onAnimEnd=()=>it.hyper("/rc/")}}let ae=!1;async function Qi(){for(const[s,e]of Object.entries(P))e.ext_no_prime==null&&e.prime();if(xi)W.shy(!1);else return Qi=!0;ae||await S.delay(1250),W.view(!1),W.div.classList.add("slide"),window.head.classList.add("gradient"),P.retro.prime(),P.retro.shy(!1),await S.delay(250),P.retro.view(),W.shy(),W.div.classList.remove("slide"),ae=!0,Xe()}function Ue(){Ri=!1,it.tna.badge.div.classList.add("connect","prime"),it.tna.dot.viewStaged(!1),X!=null&&(X.index=1),Q.open!=null&&Q.open()}async function Bi(){Ri||(Ri=!0,it.tna.badge.div.classList.add("prime"),it.tna.badge.div.classList.remove("connect"),it.tna.dot.view(!0),window.head.classList.remove("gradient"),await S.delay(250),U!=null&&U.reset(),X!=null&&X.def(),Q.close!=null&&Q.close(),W.shy(!1),await S.delay(250),W.view())}function On(){f.onOpen(Ue),f.onClose(Bi),new k("info_install","object").onChange=(t,i)=>{t.ext_prime==null&&(kt.display=(i.v&r.hwMask.display)>>r.hwOffset.display,kt.piezo=(i.v&r.hwMask.piezo)>>r.hwOffset.piezo,kt.xpio=(i.v&r.hwMask.xpio)>>r.hwOffset.xpio,kt.gps=(i.v&r.hwMask.gps)>>r.hwOffset.gps,i.z,ot.display=(i.z&r.hwMask.display)>>r.hwOffset.display,ot.piezo=(i.z&r.hwMask.piezo)>>r.hwOffset.piezo,ot.xpio=(i.z&r.hwMask.xpio)>>r.hwOffset.xpio,ot.gps=(i.z&r.hwMask.gps)>>r.hwOffset.gps,Object.keys(ot).forEach(function(n,o){ot[n]||document.querySelectorAll("._"+n).forEach(d=>d.style.display="none")}))},new k("call_prime","object","call").onChange=t=>{Qi(),t.ext_prime==null&&(Q.prime!=null&&Q.prime(kt,ot),t.ext_prime=!0)},P.user=new k("info_user","object"),P.user.onChange=t=>{A.user=t.data.v,it.access(A.user),Q.user!=null&&Q.user(t.data)};let s=new k("call_restart","object","call");s.onChange=async t=>{G.bold("system ESP restart"),Bi(),await t.delay(1e3),f.send("ping")};let e=new k("call_warn","object","call");if(e.onChange=(t,i)=>{let n=parseInt(i.v);n=n<r.warnID.length?n:-1;let o;n>=0&&(o=r.warnID[n]),o!=null&&console.error(`system warning ${o}`)},U!=null&&r.getControlByID("ui_bright")==null){const t=new k("ui_bright","object","pref");t.onChange=(i,n)=>U.bright(n.v),P[t.id]=t}}function Xe(s=A.user){let e=document.querySelectorAll("._admin");e.forEach(t=>t.style.display=s?"":"none"),e=document.querySelectorAll("._admin_alt"),e.forEach(t=>t.style.display=s?"none":"inherit")}var p={tna:P,prop:A,upon:Q,click:Yt,version:ze,install:kt,activate:ot,init:Sn,prime:Qi,open:Ue,close:Bi,patch:On,admin:Xe};let yi=!1,wt=!1,qe=!1,vt,Ge,zi,Wi;const Fn=`ws://${window.location.hostname}/ws`;let tt,jt=!1;function te(){yi||(yi=!0,tt=new WebSocket(Fn),tt.onopen=Hn,tt.onclose=Rn,tt.onmessage=Ge,wt=!1,vt=clearTimeout(vt))}function An(s){s!=jt&&(console.log(`socket monitor b:${s} state:${wt}`),jt=s,s&&(!wt&&vt==null?te():vt=clearTimeout(vt)))}function Ye(){return wt=(tt!=null?tt.readyState:oe.closed)==oe.connected,wt}function Hn(){console.warn("socket open"),wt=!0,zi!=null&&zi()}function Rn(){console.error(`socket close, squelch:${qe} check:${jt}`),yi=!1,wt=!1,Wi!=null&&Wi(),jt&&(clearInterval(vt),vt=setTimeout(te,1e3))}function Bn(){console.warn("socket kill"),tt&&tt.close(),qe=!0,yi=!1}function je(s){Ge=s}function zn(s){zi=s}function Wn(s){Wi=s}const oe=Object.freeze({connecting:0,connected:1,closing:2,closed:3});let Y=!1;var f={onOpen:zn,onClose:Wn,onParse:je,check:jt,init:te,ready:Ye,monitor:An,kill:Bn,parse:Ii,sendUX:Yn,sendTune:jn,sendObject:Je,send:Ze,fakeMessage:Zn,fakeObject:Jn,transmit:ii,fill:Kn,tron:Vn};je(Ii);function Vn(s=!0){Y=s}function Un(s){let e;for(let t in s)e=r.getControlByIndex("info",s[t].i),e!=null?(s.length>1&&(Y?console.log(`<< info #${t} %o ${s[t].v}`,e.id):e.id!="info_display"&&Y&&console.log(`<< info %o ${s[t].v}`,e.id)),e.set(s[t])):Y&&console.log(`parseInfo #${t} no object id %o`,r.infoID[s[t].i])}function Xn(s){for(let e in s){const t=s[e].i,i=r.getControlByIndex(t<r.prefBase?"admin":"pref",t);i!=null?(Y&&(s.length>1?console.log(`<< pref #${e} ${i.id} ${s[e].v}`):console.log(`<< pref ${i.id} ${s[e].v}`)),i.sync(s[e])):Y&&console.log(`parseSync #${e} no object id %o`,t)}}function qn(s){for(let e in s){const t=r.getControlByIndex("call",s[e].i);t!=null&&t.set(s[e])}}function Gn(s){for(let e in s){const t=s[e],i=r.getControlByIndex("ux",t.i);if(i!=null){if(t.s<0)return console.warn("parseUX FAIL bad stage value %o",r.stageID[t.v]);i.parse(t)}else Y&&console.log("parsUX no object %o",r.infoID[t.i])}}function Ii(s){let e=JSON.parse(s.data),t=r.actionID[e.a],i=e.t;switch(t){case"call":qn(i);break;case"ux":Gn(i);break;case"info":Un(i);break;case"sync":Xn(i);break}}function Yn(s,e,t){const i="ux",n=r.uxID.indexOf(s);if(n<0)return console.warn("sendUX FAIL no dialog %o",s);const o={i:n},l=r.stageID.indexOf(e);l>=0&&(o.v=l),t!=null&&(o.x=t);const d={a:r.actionID.indexOf(i),t:[o]};ii(d,`${i} >>`)}function jn(s="default"){const e="call",t=r.tuneID.indexOf(s);if(t<0)return console.warn("sendTune FAIL no melody %o",s);r.callID.indexOf("call_tune");const i={a:r.actionID.indexOf(e),t:[{i:r.callID.indexOf("call_tune"),v:t}]};ii(i,`${e} >>`)}function Je(s,e,t){const i=r.actionID.indexOf(s);if(i<0)return console.log("sendObject FAIL no action %o",s);let n={a:i,t:[]},o={i:r.getPrefID(e)};return Object.assign(o,t),n.t.push(o),ii(n,`${s} >>`),n}function Jn(s,e,t){const i=Je(s,e,t);if(typeof i=="object"){const n=new CustomEvent("meh");n.data=JSON.stringify(i),Ii(n)}}function Ze(s,e,t){let i=r.actionID.indexOf(s);if(i<0){Y&&console.log("send FAIL no action %o",s);return}let n={a:i,t:[]},o=-1;switch(s){case"push":case"save":case"sync":o=r.getPrefID(e);break;case"call":o=r.callID.indexOf(e);break;case"ping":o=t=0}if(o<0){Y&&console.log("send FAIL no id %o in action %o",e,s);return}return n.t.push({i:o,v:t|0}),ii(n,`${s} >>`),n}function Zn(s,e,t){const i=Ze(s,e,t);if(typeof i=="object"){const n=new CustomEvent("meh");n.data=JSON.stringify(i),Ii(n)}}function ii(s,e){const t=JSON.stringify(s);Y&&console.log(`${e} ${t}`),Ye()&&tt.send(t)}async function Kn(s,e,t){let i={};if(p.prop.preflight)try{const n=await fetch(e,{method:"GET"});if(n.status===200)i=await n.json();else throw new Error(`${e} FAIL fetch code:${n.status}`)}catch(n){console.warn(`${e} FAIL, use test data`,n),Object.assign(i,t)}else console.warn(`${e} !preflight, use test data`),Object.assign(i,t);console.groupCollapsed(`comm fill ${e}`),console.log(i),console.groupEnd(),Object.assign(s,i)}const _i=Math.floor(new Date().getTime()/1e3),Qn={a:r.actionID.indexOf("info"),t:[{i:r.infoID.indexOf("info_hardware"),chip:"12345678"},{i:r.infoID.indexOf("info_mfg"),mfg_product:"CubeCore Pro",mfg_version:"Series II",mfg_date:"22.00.00",mfg_serial:"tna.0001",mfg_logic:"1.90r1C-iU/22.00.00",mfg_display:"1.20r4C",mfg_color:"W",mfg_note:"841AR"},{i:r.infoID.indexOf("info_reg"),reg_date:"22.01.22",reg_name_1:"Noel",reg_name_2:"Rubin"}]},ta={a:r.actionID.indexOf("info"),t:[{i:r.infoID.indexOf("info_rc"),v:4},{i:r.infoID.indexOf("info_install"),v:r.hwMask.display+r.hwMask.piezo+r.hwMask.xpio+r.hwMask.gps+0,z:r.hwMask.display+r.hwMask.piezo+r.hwMask.xpio+r.hwMask.gps+0},{i:r.infoID.indexOf("info_user"),v:1},{i:r.infoID.indexOf("info_firmware"),v:"8.8.88"},{i:r.infoID.indexOf("info_uptime"),v:_i-3600*24*99},{i:r.infoID.indexOf("info_net"),v:"expresso",p:"8C:CE:4E:D5:36:9D",q:"192.168.2.100"},{i:r.infoID.indexOf("info_rssi"),v:"-78"},{i:r.infoID.indexOf("info_status"),v:r.serviceID.indexOf("GPS"),g:1,n:1},{i:r.infoID.indexOf("info_tap"),v:4,m:884,c:4},{i:r.infoID.indexOf("info_gps"),t:_i,d:1200,v:13,max:12,min:12,rec:22},{i:r.infoID.indexOf("info_ntp"),v:0,s:_i,f:28,p:64,e:0,r:60*30},{i:r.infoID.indexOf("info_display"),v:[0,0,0,0,0]}]},ia={a:r.actionID.indexOf("sync"),t:[{i:r.getPrefID("net_alert"),v:1},{i:r.getPrefID("ui_bright"),v:0,x:5},{i:r.getPrefID("ui_sound"),v:1},{i:r.getPrefID("tap_mode"),v:0},{i:r.getPrefID("tap_tilt"),v:1},{i:r.getPrefID("tap_alert"),v:0},{i:r.getPrefID("tap"),v:7,t:1023},{i:r.getPrefID("gps_alert"),v:0},{i:r.getPrefID("gps_log_int"),v:1200},{i:r.getPrefID("clock_static"),v:1},{i:r.getPrefID("clock_disp"),v:r.clockID.indexOf("CLOCK_HHMM")},{i:r.getPrefID("clock_24h"),v:0},{i:r.getPrefID("clock_tz"),v:-6},{i:r.getPrefID("clock_dst"),v:1},{i:r.getPrefID("clock_pps"),v:0},{i:r.getPrefID("daily"),v:1,h:9,m:32},{i:r.getPrefID("daily_vol"),v:1},{i:r.getPrefID("daily_ind"),v:1},{i:r.getPrefID("daily_snooze"),v:1},{i:r.getPrefID("ux_index"),v:r.uxID.indexOf("clock_static")}]},ea={i:r.infoID.indexOf("info_gps_log"),t:_i-200,d:1200,n:53,max:[13,12,13,15,15,13,13,16,16,16,15,14,15,17,14,15,14,13,14,13,13,13,14,13,14,13,13,14,12,14,14,14,13,13,14,16,17,17,16,16,15,15,16,16,16,15,14,14,13,12,12,11,10],min:[7,8,8,7,8,8,8,10,9,9,10,10,9,10,9,8,7,7,8,9,7,9,10,9,7,7,6,5,7,6,8,8,8,9,9,10,12,13,11,9,8,9,10,10,9,11,9,8,6,5,0,7,6]},sa={a:r.actionID.indexOf("info"),t:[{i:r.infoID.indexOf("info_display"),v:[127,127,127,127,2]}]},na={a:r.actionID.indexOf("info"),t:[{i:r.infoID.indexOf("info_display"),v:[120,121,109,120,0]}]},aa={a:r.actionID.indexOf("call"),t:[{i:r.callID.indexOf("call_prime"),v:0}]};function oa(){const s=p.prop.local?500:75;setTimeout(async()=>{if(f.ready())return;p.open(),console.log("%ccomm test",G.style.test,"info + sync");const e=new CustomEvent("meh");e.data=JSON.stringify(ta),f.parse(e),e.data=JSON.stringify(ia),f.parse(e),await S.delay(75),e.data=JSON.stringify(aa),f.parse(e)},s),setTimeout(()=>{if(f.ready())return;console.log("%ccomm test",G.style.test,"display");const e=new CustomEvent("meh");e.data=JSON.stringify(sa),f.parse(e)},s*2),setTimeout(()=>{if(f.ready())return;const e=new CustomEvent("meh");e.data=JSON.stringify(na),f.parse(e)},s*3)}var la={init:oa};let Gt;function ra(){document.body.insertAdjacentHTML("beforeend",'<svg height="0" width="0" style="visibility: hidden"></svg>'),Gt=document.body.lastChild}function da(s,e){Gt.insertAdjacentHTML("beforeend",'<symbol id="" viewBox="0 0 100 100"></symbol>'),Gt.lastChild.id="sym_"+s,Gt.lastChild.innerHTML=e}function ha(s){Gt.insertAdjacentHTML("beforeend",s)}ra();var g={add:da,def:ha};function ca(){g.add("warn_ui",`<g stroke-width="12" stroke-linecap="round" stroke-linejoin="round" >  
      <polygon stroke="var(--icon-fg)" fill="var(--icon-fg)" points="50 12.69 7.5 86.31 92.5 86.31 50 12.69" />
      <g>
        <polyline stroke="var(--icon-bg)" fill="none" points="50 55 50 32" />
        <circle fill="var(--icon-bg)" stroke="none" cx="50" cy="78" r="7" />
      </g>    
    </g>`),g.add("warn_text",`<g stroke="var(--icon-fg)" fill="none">
      <path stroke-width="6px" stroke-linejoin="round" d="M66,91.39H90.59A6.2,6.2,0,0,0,96,82.08L55.37,11.78a6.2,6.2,0,0,0-10.74,0L4,82.08a6.2,6.2,0,0,0,5.37,9.31H34" />    
      <polyline stroke-width="14px" points="50 73 50 55.5 50 38" />
      <polyline stroke-width="14px" points="50 94.5 50 80.5" />
    </g>`),g.add("hit",`<defs>
      <radialGradient id="grad">
        <stop offset="0%" stop-color="rgb(0,0,0,1)" />
        <stop offset="33%" stop-color="rgb(0,0,0,0.3)" />
        <stop offset="90%" stop-color="transparent" />
      </radialGradient>
    </defs>
    <g transform="translate(50 50)">
      <circle fill="url('#grad')" stroke-width="4px" stroke="var(--icon-bg)" cx="0" cy="0" r="48" />
    </g>`),g.add("halo",`<g transform="translate(50 50)">
      <circle fill="none" stroke-width="4px" stroke="var(--icon-fg)" cx="0" cy="0" r="48" />
    </g>`),g.add("show",`<g fill="var(--icon-fg)">
      <path d="M100,50C89.32,65.16,69,78,50,78S10.68,65.16,0,50C10.68,34.84,31,22,50,22S89.32,34.84,100,50ZM50,31A19,19,0,1,0,69,50,19,19,0,0,0,50,31Zm0,9A10,10,0,1,0,60,50,10,10,0,0,0,50,40Z" />
    </g>`),g.add("hide",`<g fill="var(--icon-fg)" stroke="none">
      <path d="M100,50C89.32,65.16,69,78,50,78S10.68,65.16,0,50C10.68,34.84,31,22,50,22S89.32,34.84,100,50ZM89.82,50C79.39,38.17,63.45,30,50,30S20.62,38.17,10.19,50C20.62,61.83,36.55,70,50,70S79.39,61.83,89.82,50Z" />
      <circle cx="50" cy="50" r="14" />
    </g>
    <g stroke-linecap="butt" transform="translate(50 50) rotate(45)">
      <line stroke="var(--icon-bg)" stroke-width="16" x1="-40" y1="0" x2="40" y2="0" />
      <line stroke="var(--icon-fav)" stroke-width="5" x1="-50" y1="0" x2="50" y2="0" />
    </g>`),g.add("wifi_def",`<g fill="none">
      <circle stroke="var(--icon-fg)" stroke-width="16" cx="0" cy="0" r="8"></circle>
      <circle stroke="var(--icon-fg)" stroke-width="8" cx="0" cy="0" r="32"></circle>
      <circle stroke="var(--icon-fg)" stroke-width="8" cx="0" cy="0" r="52"></circle>
   </g>`),g.add("wifi",`<g transform="translate(50, 84) rotate(-135) scale(1.25)">
      <use href="#sym_wifi_def" />
    </g>`),g.add("info",`<g stroke="var(--icon-fg)" fill="none">
      <circle stroke-width="5" cx="50" cy="50" r="47.5"></circle>
      <g stroke-width="16" transform="translate(11) skewX(-12)">
        <line x1="50" y1="82" x2="50" y2="44" />
        <line x1="50" y1="34" x2="50" y2="18" />
      </g>
    </g>`),g.add("help",`<g transform="translate(50 50)" stroke="none">
      <path d="M8.6,33.2H-8.6V23.6H8.6Zm12-60.4H-20.6c-5,0-10.3,3.6-10.3,8.3v8.8h16.5v-10H14.4v18H.7c-5.6,0-9.3,3.5-9.3,9.4v9.1H8.6V7.9c0-2.7,1-3.3,3.7-3.3h8.3C25.2,4.6,30.9.8,30.9-4V-18.9C30.9-23.6,25.6-27.2,20.6-27.2Z" /> 
    </g>`),g.add("help_button",`<g>
      <use href="#sym_halo" />
      <use href="#sym_help" />
    </g>`),g.add("tap",`<g>
      <polygon fill="var(--icon-fg)" stroke="none" points="86.76 0 66.96 0 49.87 17.09 32.84 0 13.08 0 49.85 36.91 86.76 0" />
      <g stroke="var(--icon-fg)">
        <line stroke-width="14px" y1="50" x2="100" y2="50" />
        <g stroke-width="10px" >
          <line class="cls-3" x1="50" y1="100" x2="50" y2="77" />
          <line class="cls-3" x1="14.64" y1="85.36" x2="30.91" y2="69.09" />
          <line class="cls-3" x1="85.36" y1="85.36" x2="69.09" y2="69.09" />
        </g>
      </g>
    </g>`),g.add("twirl",`<g fill="var(--icon-fg)" stroke="none">
    <polygon points="0,88 100,88 50,0"/>
  </g>`),g.add("refresh",`<g stroke="var(--icon-fg)" transform="translate(50 50)" fill="none" style="stroke-miterlimit:10;">
      <polyline points="3.536 52.75 19.036 37.25 34.536 52.75" transform="translate(-49.75 -48)" />
      <path d="M0-31A31,31,0,0,1,31,0,31,31,0,0,1,0,31,31,31,0,0,1-31,0a31.041,31.041,0,0,1,1.206-8.593" />
    </g>`),g.add("refresh_run",`<g stroke="var(--icon-fg)" transform="translate(50 50)" fill="none" style="stroke-miterlimit:10;">
      <path d="M0-31A31,31,0,0,1,31,0,31,31,0,0,1,0,31,31,31,0,0,1-31,0a31.041,31.041,0,0,1,1.206-8.593" />
    </g>`),g.add("undo",`<g transform="scale(-1 1) translate(-100 0)" stroke="var(--icon-fg)" stroke-width="8" fill="none">
      <polyline points="46.21 53.21 30 37 46.21 20.79" />
      <path d="M33,79H60.48a21,21,0,1,0,0-42H30" />
      <line x1="18" y1="18" x2="18" y2="56" />
    </g>`),g.add("dot",`<g transform="translate(50, 50)">
      <circle fill="var(--icon-fg)" cx="0" cy="0" r="50"></circle>
    </g>`),g.add("o",`<g transform="translate(50, 50)">
      <circle stroke="var(--icon-fg)" stroke-width="22" fill="none" cx="0" cy="0" r="39"></circle>
    </g>`),g.add("x",`<g stroke="var(--icon-fg)" stroke-width="22">
        <line x1="12" y1="12" x2="88" y2="88"></line>
        <line x1="12" y1="88" x2="88" y2="12"></line>
    </g>`),g.add("bar_1",`<g transform="translate(0, 0)">
      <line stroke="var(--icon-fg)" stroke-width="22" x1="50" y1="0" x2="50" y2="100"></line>
    </g>`),g.add("bar_2",`<g stroke="var(--icon-fg)" stroke-width="22" transform="translate(0, 0)">
      <line x1="20" y1="0" x2="20" y2="100"></line>
      <line x1="80" y1="0" x2="80" y2="100"></line>
    </g>`),g.add("vol_wave_0",`<g transform="translate(0, 0)">
      <g transform="scale(0.5) translate(100, 50)">
        <use href="#sym_x" />
      </g>
    </g>`),g.add("vol_wave_1",`<g transform="translate(0, 0)">
      <path stroke="var(--icon-fg)" stroke-width="10" fill="none" d="M62.7,31.63a28.5,28.5,0,0,1-.45,36.29"/>
     </g>`),g.add("vol_wave_2",`<g transform="translate(0, 0)">
      <use href="#sym_vol_wave_1" />
      <path stroke="var(--icon-fg)" stroke-width="12" fill="none" d="M80.21,14.44a52.94,52.94,0,0,1-.06,71.07"/>
     </g >`),g.add("lock",`<g>
      <path transform="translate(62 55)" stroke-width="12" stroke="var(--icon-fg)" fill="none" d="M-20,0V-22c0-12.15,8.954-22,20-22H0c11.046,0,20,9.85,20,22V0"/>
      <rect fill="var(--icon-fg)" stroke="none" x="25" y="50" width="75" height="50" />
      </g>`),g.add("unlock",`<g>
      <path transform="translate(25 50)" stroke-width="12" stroke="var(--icon-fg)" fill="none" d="M-20,0V-22c0-12.15,8.954-22,20-22H0c11.046,0,20,9.85,20,22V0"/>
      <rect fill="var(--icon-fg)" stroke="none" x="25" y="50" width="75" height="50" />
    </g>`),g.add("bell",`<g transform="translate(5 10)" stroke-width="10" stroke="var(--icon-fg)" fill="none">
      <g transform="translate(-7 -9.73)">
        <path d="M60.59,74a11,11,0,1,1-21.18,0Z" />
        <path d="M79,73,68.5,33.16C67.31,29,63.94,26,59.7,26H40.63a9.42,9.42,0,0,0-8.8,7.12L21.33,73" />
      </g>
      <line x1="43" y1="19.31" x2="43" />
      <line y1="63.27" x2="86" y2="63.27" />
    </g>`),g.add("tna_hex",`<g stroke="var(--icon-fg)" fill="none">
        <polygon points="88.97 72.5 50 95 11.03 72.5 11.03 27.5 50 5 88.97 27.5 88.97 72.5" />
    </g>`),g.add("tna_n",`<g stroke="var(--icon-fg)" fill="none">
        <polyline stroke-linecap="round" stroke-linejoin="round" points="28.71 61.84 28.71 38.16 71.29 61.84 71.29 38.16" />
    </g>`),g.add("tna",`<g>
      <use href="#sym_tna_hex" />
      <use href="#sym_tna_n" />
    </g>`),g.add("warn_tna",`<g fill="var(--icon-fg)" stroke="none" transform="translate(50, 50)">
      <path d="M-17-25.7l-8.2-14.2,4.7-2.7h41l4.7,2.7L17-25.7l16.5,9.5,8.2-14.2L50-25.6l-24.8,43H9.5v-30h-19v30H-25.2L-50-25.6l8.3-4.8,8.2,14.2Zm22.5,52h-11l-9.4,16.3H14.9Z"/>
    </g>`)}ca();class E extends O{constructor(t){super(t,"object");a(this,"id");a(this,"linked");a(this,"onEnter");a(this,"onExit");this.id=t,this.linked=r.linkDialog(this)}begin(){this.onEnter!=null&&this.onEnter(this)}exit(){this.onExit!=null&&this.onExit(this)}}const ua=`<div id="region">
    <span id="h" class="time_h">00</span>
    <span id="m" class="time_m">00</span>
    <span id="p" class="period"></span>
  </div>`;class fa extends R{constructor(t,i=void 0,n="info"){super(t,i);a(this,"_h",0);a(this,"_m",0);a(this,"mode24h",!1);this.link(n),this.div.insertAdjacentHTML("beforeend",ua),this.div.classList.add("tna_Info_T"),this.dRegion=this.getDiv("region"),this.dHour=this.getDiv("h"),this.dMin=this.getDiv("m"),this.dPeriod=this.getDiv("p")}format(t){this.mode24h=t,this.draw()}draw(){if(this.mode24h)this.dHour.innerText=this._h,this.dPeriod.innerText="";else{const t=this._h%12;this.dHour.innerText=t==0?12:t,this.dPeriod.innerText=this._h<12?"a":"p"}this.dMin.innerText=et.sprintf("%02u",this._m)}set(t){this._h=t.h,this._m=t.m,super.set(t)}}const _a=`<div id="region" class="region">
    <div id="bg" class="bg">
      <div id="action" class="action"></div>
    </div>
    <div id="label_wrap" class="label_wrap">
      <div id="label" class="label"></div>
    </div>
    <div id="status_wrap" class="status_wrap">
      <div id="status" class="status"></div>
      <div id="status_icon" class="status_icon"></div>
    </div>
  </div>`;class le extends R{constructor(t,i="pref"){super(t);a(this,"_label");a(this,"_status");a(this,"iStatus");a(this,"onExecute");this.link(i),this.div.insertAdjacentHTML("beforeend",_a),this.div.classList.add("tna_Button","disable"),this.dRegion=this.getDiv("region"),this.dBg=this.getDiv("bg"),this.dAction=this.getDiv("action"),this.dLabel=this.getDiv("label_wrap"),this.dLabelVal=this.getDiv("label"),this.dStatusW=this.getDiv("status_wrap"),this.dStatus=this.getDiv("status"),this.dIconStatus=this.getDiv("status_icon"),this.label=this.getDataAttr("label","string",""),this.enable(this.div.dataset.enable!=null)}icon(){this.dStatus.classList.add("alt");const t=new nt(this.dIconStatus).static().prime();return this.iStatus=t,this}enable(t=!0){if(t!=this._enable)return this._enable=t,this.enablePrime(),this}async enablePrime(){this._enable||(this.div.onclick=null);const t=500;this.div.classList.toggle("disable",!this._enable),this.dRegion.style.transition=t+"ms",await this.delay(t),this.dRegion.style="",this._enable&&(this.div.onclick=this.execute.bind(this))}execute(t){t.preventDefault(),t.stopImmediatePropagation();let i;this.onExecute!=null&&(i=this.onExecute(this)),i=i==null?!0:i,i&&this.confirm()}confirm(){this.div.classList.add("confirm"),this.dAction.onanimationend=this.confirmEnd.bind(this)}confirmEnd(t){this.div.classList.remove("confirm"),this.dAction.onanimationend=void 0}shuffleIcon(t=!0){const i=t?"beforeend":"afterbegin";return this.dStatusW.insertAdjacentElement(i,this.dIconStatus),this.dStatus.classList.toggle("alt",t),this}displayIcon(t=!0){return this.iStatus.display(t),this.dStatus.classList.toggle("alt",t),this}set label(t){this._label=t,this.dLabelVal.innerHTML=t}set status(t){this._status=t,this.dStatus.innerHTML=t}}const pa=`<div id="region" class="region">
    <div id="thumb" class="thumb"></div>
  </div>`;class C extends R{constructor(t,i="pref"){super(t);a(this,"_invert",!1);a(this,"onExecute");a(this,"onChange");a(this,"onTron");this.link(i),this.div.insertAdjacentHTML("beforeend",pa),this.div.classList.add("tna_Toggle","disable"),this.dRegion=this.getDiv("region"),this.dThumb=this.getDiv("thumb");let n=parseInt(this.div.dataset.checked);this._val=isNaN(n)?0:n;const o=this.div.dataset.value;o!=null&&(console.log(`${this.id} construct data-value:${o}`),this.value=parseInt(o)),this.enable(this.div.dataset.enable!=null),this.draw()}enable(t=!0){return this._enable=t,t?(this.draw(),this.div.onclick=this.execute.bind(this),this.div.classList.remove("disable")):(this.div.onclick=void 0,this.div.classList.add("disable")),this}draw(t=this._val){t=t>0,t^=this._invert,this.div.classList.toggle("check",t)}execute(t){this.toggle(),this.onTron!=null&&this.onTron(`${this.div.id} > end`),this.onExecute!=null?this.onExecute(this,this.value):this.save()}toggle(){return this.set(!this.value),this}set(t){return typeof t!="object"&&(this.value=t),super.set(t),this}set invert(t){this._invert=t}get invert(){return this._invert}}const ga=`<div class="region">
    <div id="label" class="label">X</div>
  </div>`;class va extends O{constructor(t,i,n=ga){super(t,"div");a(this,"_index");a(this,"_label");a(this,"_target");a(this,"control");a(this,"bClick");this.control=i,this.div.id=this.id=`${i.id}_item_${i.itemN}`,this._label=this.div.innerHTML,this.div.innerText="",this.div.insertAdjacentHTML("afterbegin",n),this.div.classList.add("tna_Radio_item"),this.dLabel=this.getDiv("label"),this.label=this._label;let o=this.div.querySelector("._click");o==null&&(o=this.div),o._tna_target=this.div,this._target=o,this.bClick=this.click.bind(this),this.enable()}click(t){let i=t.target._tna_target;i==null&&(i=this.parent(t.target,"_item")),this.execute(i),t.preventDefault(),t.stopImmediatePropagation()}execute(t){this.control.last=this,this.control.execute(this),this.control.view(!1)}enable(t=!0){return this.enabled=t,this.div.classList.toggle("enable",t),this._target.onclick=t&&!this._static?this.bClick:null,this._target.style.pointerEvents=t&&!this._static?"":"none",this}highlight(t=!0){this.div.classList.toggle("act",t);const i=t&&this._index==0&&!this.control.attrOff;return this.div.classList.toggle("off",i),this.enable(!t||this.control._persist),this}set label(t){this.dLabel.innerText=t}}const ma=`<div id="region" class="region">
    <div id="bg" class="bg"></div>
    <div id="rule" class="rule"></div>
    <div id="cursor" class="cursor"></div>
    <div id="panel" class="panel"></div>
  </div>`;class wa extends R{constructor(t){super(t);a(this,"_primed",!1);a(this,"_persist",!1);a(this,"_rule");a(this,"_ruleLimit");a(this,"_itemN",0);a(this,"_defP");a(this,"_itemDef",va);a(this,"list",[]);a(this,"listR",[]);a(this,"last");a(this,"onChange");a(this,"onExecute");this.link("pref"),this.div.insertAdjacentHTML("afterbegin",ma),this.div.classList.add("tna_Radio"),this.dRegion=this.getDiv("region"),this.dBg=this.getDiv("bg"),this.dRule=this.getDiv("rule"),this.dCursor=this.getDiv("cursor"),this.dPanel=this.getDiv("panel"),this._defP=this.getPropVal("--radio-p"),this._rule=this.div.dataset.rule!=null,this._ruleLimit=this.div.dataset.ruleLimit!=null,this.attrOff=this.div.dataset.radioOff!=null,this.enable(this.div.dataset.enable!=null),this.dCursor.style.left=0}init(t){for(let i=0;i<t;i++){const n=document.createElement("div");this.div.appendChild(n)}return this.merge(),this}prime(){return this._primed=!0,this}merge(){const t=this.div.childElementCount;this.setProp("--radio-n",t-1);for(let i=1;i<t;i++){const n=this.div.children[1];this.create(n).touchPrime(),this.dPanel.insertAdjacentElement("beforeend",n)}return this.rule(),this}create(t){const i=new this._itemDef(t,this),n=`${this.id}_item_${this._itemN}`;return t.id=i.id=n,i._index=this._itemN,this.list.push(i),this._itemN++,i}rule(t=this._rule){if(t)for(let i=0;i<=this._itemN;i++){const n=document.createElement("div");this.dRule.appendChild(n),this.listR.push(n),this.dRule.classList.toggle("limit",this._ruleLimit)}return this}index(t){if(this.list.forEach(i=>i.highlight(!1)),t>=0&&this.list[t].highlight(),this._primed&&(this.dCursor.style.transition="left 0.25s"),this.dCursor.style.left=`calc(${this._defP}px + ${t/this._itemN*100}%)`,this.dCursor.style.opacity=1,this._val=t,this.dCursor.classList.toggle("solid",t!=0||this.attrOff),this._rule)for(let i=0;i<=this._itemN;i++){const n=t==i||t+1==i;this.listR[i].classList.toggle("show",!n)}return this}execute(t){this.index(t._index),this.onChange!=null&&this.onChange(this),this.onExecute!=null&&this.onExecute(this),this.push()}set(t=this._val){return this.index(this._val),super.set(this._val),this}enable(t=!0){if(t!=this._enable)return this._enable=t,this.div.classList.toggle("disable",!t),this}persist(t=!0){return this._persist=t,this}label(t){return this.list[t].dLabel}}const ba=`<div id="region" class="region">
    <div id="strip" class="strip">
      <div id="fade" class="fadeW">
        <div class="fade"></div>
        <div class="fade R"></div>
      </div>
      <div id="ruler" class="ruler"></div>
      <div id="fill" class="fill"></div>
    </div>
    <div id="hit" class="hit"></div>
    <div id="thumb" class="thumb">
      <div id="divot" class="divot"></div>
      <div id="thumb_fill" class="fill"></div>
    </div>
  </div>`;class Vi extends R{constructor(t){super(t);a(this,"dLabel");a(this,"_minVal");a(this,"_maxVal");a(this,"_range");a(this,"rulePrime");a(this,"x0");a(this,"val0");a(this,"valTrack");a(this,"lastDraw");a(this,"endDelay",0);a(this,"endTimeout");a(this,"onBegin");a(this,"onEnd");a(this,"onChange");a(this,"onEnable");a(this,"onTron");this.link("pref"),this.div.insertAdjacentHTML("beforeend",ba),this.div.classList.add("tna_Slide"),this.dThumb=this.getDiv("thumb"),this.dThumbFill=this.getDiv("thumb_fill"),this.dRegion=this.getDiv("region"),this.dHit=this.getDiv("hit"),this.divStrip=this.getDiv("strip"),this.dFill=this.getDiv("fill"),this.dDivot=this.getDiv("divot"),this.dFade=this.getDiv("fade"),this.dRuler=this.getDiv("ruler"),this._attrFill=this.div.dataset.slideFill!=null,this._attrFade=this.div.dataset.slideFade!=null,this._attrRule=this.div.dataset.slideRule!=null,this._attrOff=this.div.dataset.slideOff!=null,this._attrOn=this.div.dataset.slideOn!=null,this.attrFill(),this.attrFade(),this.defH=this.getDataAttr("slideH","pixel"),this.defB=this.getPropVal("--slide-b"),this.thumbW=this.getDataAttr("slideThumbW","pixel"),this.bClick=this.click.bind(this),this.bDragStart=this.dragStart.bind(this),this.bDragEnd=this.dragEnd.bind(this),this.bTrack=this.track.bind(this),this.observer=new ResizeObserver(i=>{const n=i[0].contentRect.width;this.resize(n)}),this.observer.observe(this.div),this.enable(this.div.dataset.enable!=null)}init(t){return this._val=t,this.draw(),this.set(t),this}enable(t=!0){return this._enable=t,t?(this.draw(!0),this.dThumbFill.onmousedown=this.dThumbFill.ontouchstart=this.bDragStart,this.dHit.onclick=this.bClick):(this.draw(!1),this.dThumbFill.onmousedown=this.dThumbFill.ontouchstart=null,this.dHit.onclick=this.bClick,this.dFill.style.width="0px"),this.div.classList.toggle("disable",!t),this.onEnable!=null&&this.onEnable(this),this}resize(t=this.stripW){t!=null&&(this.stripW=t,this.locMax=this.stripW-this.thumbW,this.draw(!0))}draw(t=!1){if(this.lastDraw!=this._val||t){const i=(this._val-this._minVal)*(this.locMax/this._range);this.dThumb.style.left=i+(this.defH-this.thumbW)/2+"px",this._attrFill&&(this.dFill.style.width=i+"px"),this.div.classList.toggle("on",this._attrFill&&!this._attrOff||this._attrOff&&this._attrOn&&this.value!=this._minVal),this.div.classList.toggle("min",this._attrOff&&this.value==this._minVal),this.div.classList.toggle("max",this._attrOn&&this.value==this._maxVal),this.lastDraw=this._val}}click(t){this.incr(t),this.draw(),this.push(),this.onChange!=null&&this.onChange(this),t.preventDefault()}incr(t){const i=isNaN(t.pageX)?t.changedTouches[0].pageX:t.pageX;this.val0=this._val;const n=this.dThumb.getBoundingClientRect();i-n.left>0?this._val++:this._val--,this._val=this._val>this._maxVal?this._maxVal:this._val,this._val=this._val<this._minVal?this._minVal:this._val}start(t){this.primed=!0,this.x0=isNaN(t.pageX)?t.changedTouches[0].pageX:t.pageX,this.lastTime=t.timeStamp,this.val0=this._val,this.valTrack=this._val,this.dThumbFill.classList.add("highlight"),document.addEventListener("mousemove",this.bTrack),document.addEventListener("touchmove",this.bTrack),this.onBegin!=null&&this.onBegin(this),t.preventDefault()}dragStart(t){this.start(t),document.addEventListener("mouseup",this.bDragEnd),document.addEventListener("touchend",this.bDragEnd),this.dThumbFill.style.cursor="grab",t.preventDefault()}track(t){if(!this.primed)return;const n=(isNaN(t.pageX)?t.changedTouches[0].pageX:t.pageX)-this.x0,o=Math.round(n/(this.locMax/this._range));let l=this.val0-this._minVal+o;l=l>this._range?this._range:l,l=l<0?0:l,this._val=l+this._minVal,this.draw(),this.valTrack!=this._val&&(this.valTrack=this._val,this.push(),this.onChange!=null&&this.onChange(this)),t.preventDefault()}dragEnd(t){this.dThumb.onmouseup=this.dThumb.ontouchend=null,document.removeEventListener("mousemove",this.bTrack),document.removeEventListener("touchmove",this.bTrack),document.removeEventListener("mouseup",this.bDragEnd),document.removeEventListener("touchend",this.bDragEnd),this.end(),t.preventDefault()}end(){this.dThumbFill.classList.remove("highlight"),this.dThumb.style.cursor=null,this.dThumbFill.onmousedown=this.dThumbFill.ontouchstart=this.bDragStart,this.primed=!1,this.onTron!=null&&this.onTron(`${this.div.id} > end`),this.onEnd!=null&&(this.endDelay>0?this.endTimeout=setTimeout(this.onEnd,this.endDelay,this):this.onEnd(this)),this.push(),this.jumpFlag=!1}set(t){this.draw(),this.onChange!=null&&this.onChange(this,t),!(this.primed||this.onEnd==null)&&(this.endDelay>0?this.endTimeout=setTimeout(this.onEnd,this.endDelay,this):this.onEnd(this))}range(t,i){this._minVal=t,this._maxVal=i,this._range=i-t;let n=this._val;return n=n>this._maxVal?i:n,n=n<this._minVal?t:n,this._val=n,this.attrRule(),this}attrRule(t=this._attrRule){if(this._attrRule=t,this.dRuler.style.display=t?"":"none",t&&!this.rulePrime){const i=this._range+1;for(let n=1;n<=i;n++){let o=document.createElement("div");this.dRuler.appendChild(o),o.classList.add("mark")}this.rulePrime=!0}return this}attrFill(t=this._attrFill){return this._attrFill=t,this.dFill.classList.toggle("show",t),this}attrFade(t=this._attrFade){return this._attrFade=t,this.dFade.classList.toggle("show",t),this}}const xa=`<g class="shape" transform="translate(-50 -50)">
    <polyline points="25,100 75,50 25,0" />
  </g>`;class ya extends H{constructor(t){super(t);a(this,"_duration");a(this,"_count",0);this.div.classList.add("tna_Tread"),this.duration=this.getPropVal("--tread-t"),this.count=this.getPropVal("--tread-n"),this.getProp("--tread-fade").indexOf("in")>=0&&this.div.classList.add("fadeIn"),this.value=0}set count(t){this.clear();for(let i=0;i<t;i++){this.add=xa;const n=this.list[this.list.length-1],o=-(i/t)*this._duration;n.style.animationDelay=o+"s",n._tna_id=i,n.onanimationiteration=this.iterate.bind(this)}this.translate(50,50),this.scale(.88),this.update()}set duration(t){this._duration=t,this.div.style.setProperty("--tread-t",t+"s")}show(t=!1){this._val=!0,t&&(this.dWrap.onanimationend=void 0,this.div.classList.remove("hide")),this.div.classList.add("show","run")}hide(){this._val=!1,this.div.classList.remove("show"),this.div.classList.add("hide"),this.dWrap.onanimationend=t=>{t.animationName=="tna_Tread_hide"&&this.div.classList.remove("run","hide"),this.dWrap.onanimationend=void 0}}toggle(t){this._val=t==null?!this._val:t,this._val?this.show():this.hide()}iterate(t){t.animationName=="tna_Tread_move"&&this._count++}}const ka=`<div id="region" class="region">
    <div id="bg" class="bg"></div>
    <div id="strip" class="strip"></div>
    <div id="fill" class="fill"></div>
    <div class="flex left">
      <div id="status" class="status"></div>
      <div id="value_wrap" class="value_wrap">
        <div id="value" class="value"></div>
      </div>
    </div>
    <div class="flex right">
      <div style="flex:1"></div>
      <div id="tread" class="tread"></div>
      <div id="prompt" class="prompt"></div>
    </div>
    <div id="thumb" class="thumb">
      <svg id="chevron" class="chevron" viewBox="0 0 100 100">
        <g transform="translate(0 6) scale(.88)">
          <polyline stroke-width="24" points="25 100 75 50 25 0" />
        </g>
      </svg>
    </div>
  </div>`;class Ke extends R{constructor(t,i="ux"){super(t);a(this,"_ready",!1);a(this,"sticky",!1);a(this,"autoReset",!0);a(this,"committed",!1);a(this,"expired",!1);a(this,"textStatus","");a(this,"textPrompt");a(this,"x0");a(this,"loc");a(this,"locMax");a(this,"locNorm");a(this,"delta");a(this,"defH");a(this,"thumbW");a(this,"promptW");a(this,"treadPersist",!1);a(this,"treadPrompt",!1);a(this,"cancelDelay",75);a(this,"commitDelay",0);a(this,"timeout");a(this,"tread");a(this,"animThumb");a(this,"onBegin");a(this,"onReady");a(this,"onPrime");a(this,"onCommit");a(this,"onEnd");a(this,"onCancel");a(this,"onExpire");a(this,"onChange");this.link(i),this.div.insertAdjacentHTML("beforeend",ka),this.div.classList.add("tna_SafeSlide","disable"),this.dRegion=this.getDiv("region"),this.dBg=this.getDiv("bg"),this.dStrip=this.getDiv("strip"),this.dFill=this.getDiv("fill"),this.dPrompt=this.getDiv("prompt"),this.dStatus=this.getDiv("status"),this.dValueW=this.getDiv("value_wrap"),this.dValue=this.getDiv("value"),this.dThumb=this.getDiv("thumb"),this.divChevron=this.getDiv("chevron"),this.divTread=this.getDiv("tread"),this.treadPrompt=this.div.dataset.safeTread!=null,this.treadPersist=this.div.dataset.safeTreadPersist!=null,this.treadIcon=this.treadPrompt||this.treadPersist,this.treadIcon&&(this.tread=new ya(this.divTread.id)),this.dPrompt.innerText=this.textPrompt=this.getDataAttr("safePrompt","string",""),this.dStatus.innerText=this.textStatus=this.getDataAttr("safeStatus","string",""),this.defH=this.getPropVal("--safe-h"),this.defP=this.getPropVal("--safe-p"),this.getDataAttr("safeThumbW","percent"),this.bEnableEnd=this.enableEnd.bind(this),this.bStart=this.start.bind(this),this.bTrack=this.track.bind(this),this.bStop=this.stop.bind(this),this.bResetEnd=this.resetEnd.bind(this),this.bCommitEnd=this.commitEnd.bind(this),this.observer=new ResizeObserver(n=>{n[0].contentRect.width,this.resize()}),this.observer.observe(this.div),this.resize(),this.sticky=this.div.dataset.sticky!=null,this._enable=this.div.dataset.enable!=null,this._enable==1&&this.enable()}resize(){const t=this.thumbW;if(this.calcThumb(),this.thumbW==t)return;const i=this.locNorm*this.locMax;this.dThumb.style.left=this.defP+i+"px",this.dFill.style.left=this.defP+i-this.width+"px",this.calcPrompt();let n,o;const l=this.div.dataset.safeGradStart;if(l!=null){const d=parseFloat(l);isNaN(d)?n=50:(o=l.indexOf("px"),n=o>0?(this.thumbW+d)/this.width*100:((this.width-this.thumbW)*d/100+this.thumbW)/this.width*100),this.div.style.setProperty("--safe-grad-start",n+"%")}}enable(t=!0){if(t==this._enable)return;if(this._enable=t,this.loc=this.locNorm=0,this.primed&&!t)return this.committed=!0,this.commitPrime(),this;this.div.classList.toggle("disable",!t),this.divChevron.classList.toggle("show",t);let i=500;return t?this.animThumb=this.dThumb.animate([{opacity:0,width:this.defH+"px"},{opacity:1,width:this.thumbW/3+"px",offset:.33},{opacity:1,width:this.thumbW+"px"}],{duration:i,easing:"ease-out",fill:"backwards"}):(this.dThumb.onmousedown=this.dThumb.ontouchstart=null,this.dPrompt.classList.remove("show"),this.treadPersist&&this.tread.hide(),this.animThumb=this.dThumb.animate([{opacity:1,left:this.defP+"px"},{opacity:0,left:this.width-this.thumbW+"px"}],{duration:i,easing:"ease-in"})),this.animThumb.addEventListener("finish",this.bEnableEnd),this}enableEnd(){this.animThumb.removeEventListener("finish",this.bEnableEnd),this.div.classList.toggle("disable",!this._enable),this.dThumb.onmousedown=this.dThumb.ontouchstart=this._enable?this.bStart:null,this._enable&&(this.dPrompt.classList.add("show"),this.treadPersist&&(this.tread.prime(),this.tread.show()))}parse(t){const i=t.v;if(i<0)return console.warn(`${this.id} safeSlide parse FAIL no stage value`);switch(r.stageID[i]){case"ready":this.ready(t);break;case"run":this.update(t);break;case"commit":this.commit(t);break;case"expire":this.expire(t);break}}start(t){t.preventDefault(),t.stopImmediatePropagation(),this.primed=!0,this._ready=this.expired=this.committed=!1,clearTimeout(this.timeout),this.dThumb.style.cursor="grab",document.addEventListener("mousemove",this.bTrack),document.addEventListener("touchmove",this.bTrack),document.addEventListener("mouseup",this.bStop),document.addEventListener("touchend",this.bStop),this.x0=isNaN(t.pageX)?t.changedTouches[0].pageX:t.pageX,this.delta=0,this.calcThumb(),this.div.classList.add("active"),this.dPrompt.classList.add("active"),this.onTron!=null&&this.onTron(`${this.div.id} > start`),this.onBegin!=null&&this.onBegin(this),this.dPrompt.style.transition="none",this.treadIcon&&(this.tread.prime(!1),this.tread.show(!0),this.tread.div.style.transition="none")}track(t){if(!this.primed)return;const i=isNaN(t.pageX)?t.changedTouches[0].pageX:t.pageX;this.loc=Math.round(i-this.x0),this.loc=this.loc<this.locMax?this.loc:this.locMax,this.delta=this.loc=Math.max(this.loc,0),this.onTron!=null&&this.onTron(`${this.div.id} track ${Math.round(this.delta)}`),this.locNorm=this.loc/this.locMax,this.dThumb.style.left=this.defP+this.loc+"px",this.dFill.style.left=this.defP+this.loc-this.width+"px";const n=(this.loc-(this.locMax-(1-this.promptStart)*this.promptW))/((this.promptEnd-this.promptStart)*this.promptW);this.dPrompt.style.opacity=1-n,this.tread.div.style.opacity=1-n*2,this.loc>=this.locMax?(this.dPrompt.classList.remove("show"),!this.expired&&this._ready&&this.execute()):this.dPrompt.classList.add("show"),t.preventDefault()}execute(){document.removeEventListener("mousemove",this.bTrack),document.removeEventListener("touchmove",this.bTrack),this.treadIcon&&this.tread.hide(),this.div.classList.add("hold"),this.sticky?(this.onTron!=null&&this.onTron(`${this.div.id} > prime sticky`),document.removeEventListener("mouseup",this.bStop),document.removeEventListener("touchend",this.bStop),this.dThumb.style.pointerEvents="none",this.dThumb.onmousedown=this.dThumb.ontouchstart=null):this.onTron!=null&&this.onTron(`${this.div.id} > prime`),this.onPrime!=null?this.onPrime(this):this.dRegion.classList.add("confirm")}ready(){this._ready=!0,this.onReady!=null&&this.onReady()}async commit(t){!this.primed||(this.committed=!0,this.sticky||(document.removeEventListener("mouseup",this.bStop),document.removeEventListener("touchend",this.bStop),this.dThumb.style.pointerEvents="none",this.dValueW.classList.remove("show","blink"),this.dValue.innerText=""),this.onTron!=null&&this.onTron(`${this.div.id} > commit`),this.onCommit!=null&&this.onCommit(this,t),this.autoReset?this.commitDelay>0?this.timeout=setTimeout(this.resetPrime.bind(this),this.commitDelay):this.resetPrime():this.commitDelay>0?this.timeout=setTimeout(this.commitPrime.bind(this),this.commitDelay):this.commitPrime())}async commitPrime(){if(!this.committed)return;this.primed=!1;const t=500;this.dStrip.style.opacity=0,this.dStrip.style.transition=t+"ms",await this.delay(t/2),this.dPrompt.style="",this.dPrompt.classList.remove("show"),this.tread.div.style.opacity="",this.tread.div.style.transition="",this.dFill.style.opacity=0,this.dFill.style.transition=t+"ms",this.dThumb.style.left=this.width-this.defP-this.defH+"px",this.dThumb.style.width=this.defH+"px",this.dThumb.style.opacity=0,this.dThumb.style.transition=`${t}ms ease-in`,this.drawStatus(!1),this.dThumb.addEventListener("transitionend",this.bCommitEnd),this.dBg.classList.add("disable")}commitEnd(){this.dThumb.removeEventListener("transitionend",this.bCommitEnd),this.onEnd!=null&&this.onEnd(this),this.dThumb.style="",this.div.classList.remove("active","hold"),this.dThumb.onmousedown=this.dThumb.ontouchstart=null,this.dStrip.style="",this.dStrip.classList.remove("show"),this.dFill.style="",this.status="",this.value="",this.dRegion.classList.remove("confirm"),this.dBg.classList.remove("disable"),this.div.classList.add("disable"),this._enable=!1,this.loc=this.locNorm=0}expire(t){if(console.warn(`${this.id} safeSlide expire, primed:${this.primed}`),!this.primed)return;this.expired=!0;const i=this.onExpire!=null?this.onExpire(this,t):void 0;this.endMouse(i)}stop(t){this.endMouse(),t.preventDefault(),t.stopImmediatePropagation()}endMouse(t=!0){document.removeEventListener("mousemove",this.bTrack),document.removeEventListener("touchmove",this.bTrack),document.removeEventListener("mouseup",this.bStop),document.removeEventListener("touchend",this.bStop),t&&this.resetPrime()}async resetPrime(){if(!this.primed)return;this.primed=!1,this.onTron!==void 0&&this.onTron(`${this.div.id} > endPrime`),this.drawStatus(!1);let t=this.delta/this.locMax*200;t=t>50?t:50,this.committed&&await this.delay(t),this.delta!=0?(this.dThumb.addEventListener("transitionend",this.bResetEnd),this.loc=this.locNorm=0,this.dThumb.style.left=this.defP+"px",this.dThumb.style.transition=`${t}ms ease-in`,this.dFill.style.left=-this.width+"px",this.dFill.style.transition=`${t}ms ease-in`):this.resetEnd(),this.dStrip.classList.remove("show"),this.dPrompt.classList.remove("active"),this.dPrompt.style.opacity="",this.tread.div.style.opacity="",this.tread.div.style.transition="",this.treadPrompt&&!this.treadPersist&&(this.tread.prime(),this.tread.hide()),this.dRegion.classList.remove("confirm")}resetEnd(){this.dThumb.removeEventListener("transitionend",this.bResetEnd),this.onTron!=null&&this.onTron(`${this.div.id} > end`),!this.committed&&this.onCancel!=null&&(this.cancelDelay>0?this.timeout=setTimeout(this.onCancel,this.cancelDelay,this):this.onCancel(this)),this.committed=!1,this.div.classList.remove("confirm"),this.dThumb.style="",this.div.classList.remove("active","hold"),this.dThumb.onmousedown=this.dThumb.ontouchstart=this.bStart,this.dFill.style="",this.dPrompt.classList.add("show"),this.dPrompt.innerText=this.textPrompt,this.dPrompt.style="",this.dValue.innerText="",this.treadPersist&&this.tread.show()}reset(t=0){this.committed&&(t>0?this.timeout=setTimeout(this.expire.bind(this),t):this.expire())}update(t){!this.primed||(this.onChange!=null&&this.onChange(this,t),this.drawStrip())}drawStrip(t=!0){this.dStrip.classList.toggle("show",t)}drawStatus(t=!0){this.dStatus.classList.toggle("show",t),this.dValueW.classList.toggle("show",t),t||this.dValueW.classList.remove("blink")}drawValue(t=!0){this.dValueW.classList.toggle("show",t)}blink(t=.14){this.div.style.setProperty("--blink-rate",t+"s"),this.dValueW.classList.add("blink"),this.dValueW.onanimationend=this.blinkEnd.bind(this)}blinkEnd(t){this.dValueW.classList.remove("blink"),this.dValueW.onanimationend=void 0}calcThumb(){const t=this.div.offsetWidth;t!=this.width&&(this.width=t,this.thumbW=this.dThumb.offsetWidth,this.locMax=this.width-this.thumbW-this.defP*2)}calcPrompt(){let t,i;this.promptW=this.dPrompt.offsetWidth;let n=this.div.dataset.safePromptStart,o=this.div.dataset.safePromptEnd;n=n!=null?n:"0",o=o!=null?o:"50%";const l=parseFloat(n),d=parseFloat(o);isNaN(l)?t=0:(i=n.indexOf("px"),t=i>0?l/this.promptW:l/100),this.promptStart=t,isNaN(d)||(i=o.indexOf("px"),t=i>0?d/this.promptW:d/100),this.promptEnd=t}set value(t){this.dValue.innerText=this._val=t}get value(){return this._val}set prompt(t){this.textPrompt=this.dPrompt.innerText=t,this.calcPrompt()}set status(t){this.textStatus=this.dStatus.innerText=t,this.dStatus.classList.toggle("nil",t=="")}}class La extends O{constructor(t,i="object"){super(t,i);a(this,"_focus",!1);a(this,"list",[]);a(this,"busyList",[]);a(this,"onGroupFocus");a(this,"onBlurFocus")}add(t){this.list.push(t),this.busyList.push(0)}focus(t){const i=this.list.findIndex(n=>n==t);if(i<0)return console.warn(`${this.id} focus ${t.id} not found`);this.busyList[i]=1,this.calcFocus()}blur(t){const i=this.list.findIndex(n=>n==t);if(i<0)return console.warn(`${this.id} blur ${t.id} not found`);this.busyList[i]=0,this.calcFocus()}calcFocus(){let t=0;this.busyList.map(i=>t+=i),t==0&&this._focus?(this._focus=!1,this.onGroupBlur!=null&&this.onGroupBlur(this)):this._focus||(this._focus=!0,this.onGroupFocus!=null&&this.onGroupFocus(this))}}const Da=`<div id="region" class="region">
    <div id="debug" class="debug">
      <div id="lsd" class="lsd"></div>
      <div id="val" class="val"></div>
    </div>
    <div id="portal" class="portal">
      <div id="wrap" class="wrap _dmm"></div>
      <div id="fade" class="fade"></div>
    </div>
    <div id="bezel" class="bezel">
      <div class="icon_wrap">
        <div id="up_icon"></div>
      </div>
      <div class="icon_wrap">
        <div id="down_icon" class="down"></div>
      </div>
    </div>
    <div class="zone">
      <div id="up_zone"></div>
      <div id="down_zone"></div>
    </div>
  </div>`;var Ta={HTML:Da};class Ea extends O{constructor(t,i){super(t);a(this,"_index");a(this,"_target");a(this,"_tron",!1);a(this,"_enable",!1);a(this,"_focus",!1);a(this,"_active",!1);a(this,"_hook",!1);a(this,"_primed",!1);a(this,"_hold",!1);a(this,"_solo",!1);a(this,"_base",10);a(this,"_limited",!1);a(this,"_limitL");a(this,"_limitH");a(this,"_loop",!1);a(this,"_dir",1);a(this,"_speed",1);a(this,"_factor",2);a(this,"_defH");a(this,"_defP");a(this,"_def");a(this,"_start");a(this,"_clickW",250);a(this,"_blurD",2e3);a(this,"_blurTO");a(this,"_moveD");a(this,"_lsd",0);a(this,"_loc",0);a(this,"_y",0);a(this,"_lsd0");a(this,"_v0");a(this,"_y0");a(this,"_t0");a(this,"_lastV");a(this,"_lastY");a(this,"control");a(this,"onTron");this.div.insertAdjacentHTML("afterbegin",Ta.HTML),this.div.classList.add("tna_Numbler"),this.dRegion=this.getDiv("region"),this.dPortal=this.getDiv("portal"),this.dWrap=this.getDiv("wrap"),this.getDiv("fade"),this.dBezel=this.getDiv("bezel"),this.dUpIcon=this.getDiv("up_icon"),this.dDownIcon=this.getDiv("down_icon"),this.dUp=this.getDiv("up_zone"),this.dDown=this.getDiv("down_zone"),this.dUp.tna_click=1,this.dDown.tna_click=-1,this.dBugLSD=this.getDiv("lsd"),this.dBugVal=this.getDiv("val");const n='<polyline points="0,65 50,35 100,65"/>';this.iconUp=new H(this.dUpIcon).static().show(),this.iconUp.add=n,this.iconUp.index=0,this.iconDown=new H(this.dDownIcon).static().show(),this.iconDown.add=n,this.iconDown.index=0,this._defH=this.getPropVal("--numbler-h"),this._defP=this.getPropVal("--numbler-p"),this._def=parseFloat(this._defH-this._defP),this.durF=this.getPropVal("--numbler-t-focus"),this.bSpinFrame=this.spinFrame.bind(this),this.bSnapFrame=this.snapFrame.bind(this),this.bStart=this.start.bind(this),this.bTrack=this.track.bind(this),this.bStop=this.stop.bind(this),this._val=0,this._target=this}format(){for(let t=0;t<=this._base;t++){const i=document.createElement("div");i.classList.add("digit"),i.id=`${this.id}_digit_${t}`,this._dir>0?this.dWrap.insertAdjacentElement("afterbegin",i):this.dWrap.appendChild(i),i.innerText=this.control.onBuild!=null?this.control.onBuild(this,t%this._base):(t%this._base).toString(16)}return this}incr(t=0,i=120){if(t!=0)return this._tron&&this.onTron!=null&&this.onTron(this.div.id+et.sprintf(" incr %+1i >> val: %04i",t,this.value).replace("-","\u2212")),this.blurCancel(),this.blurDelay(),this.roll(this.value+t,i),this.control.execute(this),this}roll(t,i=120){if(this._loop)t>this._limitH?(t=this._limitL,console.warn(`${this.id} roll loop +1 ${this._y}`)):t<this._limitL&&(t=this._limitH,console.warn(`${this.id} roll loop -1 ${this._y}`));else{if(t<this._limitL||t>this._limitH)return console.warn(`${this.id} roll out of limit val:${this.value}`);this._limited||(t=(t+this._base)%this._base)}return this.move(t,i),this.value=t,this.control.flow(this),this}spin(t,i=120){if(t!=this.value)return this.move(t,i),this.value=t,this}move(t,i){this._v0=this.value,this._y0=this._y;const n=this._base<=10?this._lsd:this.value,o=t%this._base-n;let l=Math.abs(o)>this._base/2?(Math.abs(o)-this._base)*Math.sign(o):o;const d=this._base-Math.abs(l);return l=d<Math.abs(l)?d:l,this.yFinal=this._y0+this._def*this._dir*l,this.cancelFrame(),Math.abs(l)>0&&i!=0?(this._hold=!0,this.draw(),this._moveD=Math.max(100,Math.abs(l)*i),this._start=performance.now(),this.req=window.requestAnimationFrame(this.bSpinFrame)):this.set(),l}spinFrame(t){this.calcFrame(t)?(this.req=window.requestAnimationFrame(this.bSpinFrame),this.draw()):(this.set(),this.dUpIcon.classList.remove("active"),this.dDownIcon.classList.remove("active"),this.req=void 0,this._hold=!1,this._hook&&(this._hook=!1,this.control.spinEnd(this)))}calcFrame(t){const i=t-this._start,n=this.easeInOutSine(i,0,1,this._moveD);return this._y=this._y0+(this.yFinal-this._y0)*n,i<this._moveD}busy(t=!0){return this._hook=t,this.control._busy++,this}cancelFrame(){this._hold=!1,this.req!=null&&(window.cancelAnimationFrame(this.req),this.req=void 0,this._tron&&console.warn(`${this.id} cancelFrame anim running`)),this.set()}start(t){this.cancelFrame(),this.control._index=this._index,this._primed=!0,this._start=t.timeStamp,document.addEventListener("mousemove",this.bTrack),document.addEventListener("touchmove",this.bTrack),document.addEventListener("mouseup",this.bStop),document.addEventListener("touchend",this.bStop),this._t0=isNaN(t.pageY)?t.changedTouches[0].pageY:t.pageY,this._y0=this._y,this._v0=this.value,this._lsd0=this._lsd,this._focus||this.control.focus(this),this.blurCancel(),this.activeCancel(),this.div.classList.add("focus"),this.control.begin(this),t.preventDefault(),t.stopImmediatePropagation()}track(t){if(!this._primed)return;const i=(isNaN(t.pageY)?t.changedTouches[0].pageY:t.pageY)-this._t0,n=this._defH*this._factor,o=Math.min(Math.abs(i),n),l=this.easeLinear(o,0,1,n),d=i*l*this._speed,u=d/this._def;if(this._y=this._y0+d,this._limited){const c=this._limitL,m=this._limitH;if(this._loop){const h=this.range+1,L=u>0?-Math.floor((u+this._v0-c+.5)/h):Math.floor((-u+m-this._v0+.5)/h);this.vFinal=u+L*h+this._v0,this._y=this.vFinal*this._def}else this._y=this._dir>0?this.clamp(this._y,c,m):this.clamp(this._y,-m,c)}if(this.value=Math.round(this.vFinal),this.draw(),this._tron&&this.onTron!=null){let c=`${this.div.id} test: %5.2f y: %+04i val: %04i`;c=et.sprintf(c,0,this._y,this.value),this.onTron(c.replace("-","\u2212"))}this._lsd0!=this._lsd&&(this.control.flow(this),this.control.execute(this),this._lsd0=this._lsd),t.preventDefault(),t.stopImmediatePropagation()}stop(t){const i=(isNaN(t.pageY)?t.changedTouches[0].pageY:t.pageY)-this._t0;document.removeEventListener("mousemove",this.bTrack),document.removeEventListener("touchmove",this.bTrack),document.removeEventListener("mouseup",this.bStop),document.removeEventListener("touchend",this.bStop),this._primed&&(this._primed=!1,this.control.end(),t.timeStamp-this._start<this._clickW&&Math.abs(i)<this._def/2?this.click(t):this.snap(),t.preventDefault(),t.stopImmediatePropagation())}click(t){const i=t.target.tna_click;i!=null&&(i>0&&this.dUpIcon.classList.add("active"),i<0&&this.dDownIcon.classList.add("active"),this.incr(i))}snap(){this.blurDelay();const t=-this._loc%this._def;if(t!=0){const i=t>=this._defH/2?t-this._def:t;this._y0=this._y,this.yFinal=this._y+i,this._moveD=500,this.cancelFrame(),this._start=performance.now(),this.req=window.requestAnimationFrame(this.bSnapFrame)}else this.snapEnd();this.control.execute(this)}snapFrame(t){const i=t-this._start,n=this.easeOutElastic(i,0,1,this._moveD);this._y=this._y0+(this.yFinal-this._y0)*n,i<this._moveD?(this.draw(),this.req=window.requestAnimationFrame(this.bSnapFrame)):(this.req=void 0,this._y=this.yFinal,this.snapEnd())}snapEnd(){this.draw()}draw(t=!1){if(!t&&this._y==this._lastY)return;const i=this._def*this._base;return this._loc=this._y-Math.ceil(this._y/i)*i,this.dWrap.style.top=this._loc+"px",this._lastY=this._y,this}calc(t=this._y){let i;return this._limited?(i=Math.round(t/this._def),i=this._dir>0?i:-i):(i=Math.round(this._loc/this._def),i=this._dir>0?i+this._base:-i,i=Math.abs(i)==this._base?0:i),i}set(t=this.value){return this._dir>0?this._y=t*this._def:this._y=-t*this._def,this.value=t,this.draw(),super.set(t),this}active(t=!0){return this._active=t,t?this.div.classList.add("active"):(this.div.classList.remove("active"),this.dPortal.style.transition=`${this.durF}s ease-in`,this.dPortal.ontransitionend=()=>{this.dPortal.style.transition="",this.dPortal.ontransitionend=null}),this}activeCancel(){this.div.classList.remove("active"),this.dPortal.style.transition="",this.dPortal.ontransitionend=null}focus(t=!0){return t?(clearTimeout(this._blurTO),this.dBezel.classList.add("show"),this._focus=t):this.blur(),this.div.style.zIndex=t?10:"",this}blur(){if(!!this._focus)return this._focus=!1,clearTimeout(this._blurTO),this.div.classList.remove("focus"),this.dPortal.style.transition=`${this.durF}s ease-in`,this.dBezel.style.transition=`${this.durF*2}s ease-in`,this.dBezel.classList.remove("show"),this.dBezel.ontransitionend=()=>{this.dPortal.style.transition="",this.dBezel.style.transition="",this.dBezel.ontransitionend=null},this.control.blur(this),this}blurDelay(t=this._blurD,i=1e3){return this._blurTO=setTimeout(this.blur.bind(this),t,i),this}blurCancel(){return this.dPortal.style.transition="",this.dBezel.style.transition="",clearTimeout(this._blurTO),this}limit(t,i){return this._limitL=t,this._limitH=i,this._limited=!0,this.range=i-t,this}tron(t=this._tron){return this._tron=t,this.div.classList.toggle("tron",t),this}set enable(t){t!=this.enable&&(this._enable=t,this.div.classList.toggle("disable",!t),this.dUp.onmousedown=this.dUp.ontouchstart=this.dDown.onmousedown=this.dDown.ontouchstart=this._enable?this._target.bStart:null)}get enable(){return this._enable}target(t){this._target=t}set value(t){t!=this._lastV&&(this._val=t,this._lsd=Number(String(this._val).slice(-1)),this.dBugLSD.innerText=this.control._digitN!=1?this._lsd:"\u2212",this.dBugVal.innerText=this._val,this._lastV=t)}get value(){return this._val}}class re extends O{constructor(t){super(t);a(this,"_index");a(this,"_busy",0);a(this,"_valLast");a(this,"_focusCount");a(this,"_digitN");a(this,"_base",10);a(this,"_loop",!1);a(this,"_limited",!1);a(this,"_limitL");a(this,"_limitH");a(this,"_range");a(this,"list");a(this,"_onBuild");a(this,"onSet");a(this,"onBegin");a(this,"onEnd");a(this,"onExecute");a(this,"onChange");a(this,"onSpinEnd");a(this,"onFocus");a(this,"onBlur");this.div.classList.add("tna_Numbler_Control"),this._val=0}init(){this._focusCount=0,this.list=[],this._digitN=arguments.length,this.setProp("--numbler-n",this._digitN);for(let t=0;t<this._digitN;t++){const i=this._digitN-1-t,n=new Ea(this.div.createDiv(`${this.id}_${i}`));n.control=this,n._index=i,n._base=arguments[t],Be.add(n),this.list.unshift(n)}return this}set(t){if(!!this.validate(t)){if(this._tron&&console.log(`${this.id} control set ${t}`),this._val=t,this.list.forEach((i,n)=>{let o=t;n>0&&(o=Math.floor(t/Math.pow(this._base,n))),i.set(o)}),this.onSet!=null){const i=this.list[0];this.list.forEach(n=>n.set(this.onSet(n,i)))}this.onChange!=null&&this.onChange(this)}}begin(t){this.onBegin!=null&&this.onBegin(this,t)}end(t){this.onEnd!=null&&this.onEnd(this,t)}execute(t){this.onExecute!=null&&this.onExecute(this,t),this.value!=this._valLast&&(this.onChange!=null&&this.onChange(this),this._valLast=this.value)}edit(t=!0){this.div.classList.toggle("edit",t)}roll(t){!this.validate(t)||this.list.forEach((i,n)=>{let o=t;n>0&&(o=Math.floor(t/Math.pow(this._base,n))),i.roll(o)})}spin(t){!this.validate(t)||(this.list.forEach((i,n)=>{let o=t;n>0&&(o=Math.floor(t/Math.pow(this._base,n))),i.busy().spin(o)}),this.value=t)}flow(t){const i=t.value,n=t._index;let o;if(this.onSet!=null)return this.list.forEach(l=>l.spin(this.onSet(l,t)));for(let l=n+1;l<this._digitN;l++)o=Math.floor(i/Math.pow(this._base,l-n)),this.list[l].spin(o);for(let l=n-1;l>=0;l--)if(this._loop)o=this.sliceVal(1,this.list[l].value)+i*Math.pow(this._base,n-l),this.list[l].spin(o);else if(i==t._limitH){const d=this.list[l]._lsd,u=this.list[l]._limitH,c=this.sliceVal(1,u);o=d<=c?i:c,o+=i*Math.pow(this._base,n-l),this.list[l].spin(o)}}change(t){if(this._limited)for(let i=t._index-1;i>=0;i--){let n=0;for(let o=this._digitN-1;o>i;o--)n+=this.list[o]._lsd*Math.pow(this._base,o-i-1);n=n*this._base+this.list[i]._lsd,this._index!=i&&this.list[i].set(n)}this.value!=this._valLast&&(this.onChange!=null&&this.onChange(this),this._valLast=this.value)}focus(t){this._focusCount++,this._focus=t._index,this.onFocus!=null&&this.onFocus(this),this.list.forEach((i,n)=>{i.focus(n==this._focus),t!=i&&i.active()})}focusAll(t=!0){return this.list.forEach((i,n)=>i.focus(t)),t||(this._focusCount=0),this}blur(t){this._focusCount--,this._focusCount==0&&this.onBlur!=null&&this.onBlur(this),this.list.forEach(i=>{i!=t&&i.active(!1)})}blurAll(){return this.list.forEach((t,i)=>t.blur()),this}spinEnd(t){this._busy--,this._busy==0&&this.onSpinEnd!=null&&this.onSpinEnd(this)}format(){return this.list.forEach((t,i)=>t.format()),this}clear(){this.list!=null&&(this.list.forEach(t=>{t.div.remove()}),this.list=[],this._digitN=0)}limit(t,i){this._limited=!0;const n=Math.pow(this._base,this._digitN),o=this._digitN>1;return this._limitL=t-Math.floor(t/n)*n,this._limitH=o?i-Math.floor(i/n)*n:i,this._range=i-t,(t>=n||i>n&&o)&&console.warn(`${this.id} limit ${this._limitL}(${t})..${this._limitH}(${i}) truncate`),this.list.forEach((l,d)=>{let u=this._limitL,c=this._limitH;d>0&&(u=Math.floor(this._limitL/Math.pow(this._base,d)),c=Math.floor(this._limitH/Math.pow(this._base,d))),l.limit(u,c).draw(!0),l._solo=!o}),this}validate(t){let i;return t==null?(console.warn(`${this.id} validate FAIL: %o`,void 0),!1):(i=t<Math.pow(this._base,this._digitN)||this._digitN==1,i?(this._limited&&(i=t>=this._limitL&&t<=this._limitH,i||console.warn(`${this.id} validate FAIL: "${t}" out of limits: ${this._limitL}..${this._limitH}`)),i):(console.warn(`${this.id} validate FAIL: "${t}" out of range, digitN:${this._digitN} base:${this._base}`),!1))}target(t,i){return this.list[t].target(this.list[i]),this}enable(t=!0){return this.list.forEach((i,n)=>i.enable=t),this}tron(t=!0){return this.list.forEach(i=>i.tron(t)),this.div.classList.toggle("tron",t),this}set onBuild(t){this._onBuild=t,this.format()}get onBuild(){return this._onBuild}set value(t){this.set(t)}get value(){return this.list!=null?this.list[0].value:void 0}set base(t){if(Array.isArray(t)){if(t.length!=this._digitN)return console.warn(`${this.id} setBase param mismatch ${t.length}`);for(let i=0;i<this._digitN;i++){const n=t[this._digitN-1-i];this.list[i]._base=n}}else this.list.forEach(i=>i._base=t)}speed(t){if(Array.isArray(t)){if(t.length!=this._digitN)return console.warn(`${this.id} setSpeed param mismatch ${t.length}`);for(let i=0;i<this._digitN;i++){const n=t[this._digitN-1-i];this.list[i]._speed=n}}else this.list.forEach(i=>i._speed=t);return this}loop(t=!0){return this._loop=t,this.list.forEach(i=>i._loop=t),this}stringVal(t=this.value){return String(t).padStart(this._digitN,"0")}sliceVal(t,i=this.value){return Number(this.stringVal(i).slice(-t))}}const Ia=`<div id="region" class="region">
      <div id="hours" class="hours"></div>
      <div id="colon" class="colon _dmm">:</div>
      <div id="mins" class="mins"></div>
      <div id="period" class="period _dmm">X</div>
      <div id="bezel" class="bezel">
        <div id="bracket_L" class="bracket">
          <div class="def"></div>
        </div>
        <div id="bracket_R" class="bracket right">
          <div class="def"></div>
        </div>
      </div>
    </div>
  </div>`;var $a={HTML:Ia};class Sa extends La{constructor(t){super(t,"id");a(this,"_edit",!1);a(this,"_bezel",!1);a(this,"_tron",!1);a(this,"_bts",!1);a(this,"hour24h");a(this,"hours");a(this,"mins");a(this,"valH");a(this,"valM");a(this,"valP");a(this,"lastH");a(this,"lastM");a(this,"onBegin");a(this,"onEnd");a(this,"onExecute");a(this,"onChange");a(this,"onFocus");a(this,"onBlur");this.div.insertAdjacentHTML("beforeend",$a.HTML),this.div.classList.add("tna_Numbler_T"),this.getDiv("region"),this.dHours=this.getDiv("hours"),this.dMins=this.getDiv("mins"),this.getDiv("colon"),this.dPeriod=this.getDiv("period"),this.dBezel=this.getDiv("bezel"),this.getDiv("bracket_L"),this.getDiv("bracket_R"),this.hours=new re(this.dHours.id),this.mins=new re(this.dMins.id),this.mins.init(6,10).format().limit(0,59).speed([1,2]).loop(),this.mins.enable(),this.mins.onChange=i=>{this.valM=i.value,this.change(i)},this.format(),this.hours.onBegin=this.mins.onBegin=(i,n)=>this.begin(i,n),this.hours.onEnd=this.mins.onEnd=(i,n)=>this.end(i,n),this.hours.onExecute=this.mins.onExecute=(i,n)=>this.execute(i,n),this.hours.onFocus=this.mins.onFocus=i=>{this.focus(i);let n;i==this.hours?(this.hour24h||this.dPeriod.classList.add("act"),n=this.mins):n=this.hours,n.blurAll()},this.hours.onBlur=this.mins.onBlur=i=>{i==this.hours&&this.dPeriod.classList.contains("act")?(this.dPeriod.classList.remove("act"),this.dPeriod.classList.add("prime"),this.dPeriod.ontransitionend=()=>{this.dPeriod.classList.remove("prime"),this.dPeriod.ontransitionend=null}):this.dPeriod.classList.remove("prime"),this.blur(i)},this.add(this.hours),this.add(this.mins),this.edit(!1)}format(t=!1){this.hour24h=t;const i=this.hours.value;return this.hours.clear(),t?(this.hours.init(3,24),this.hours.onBuild=(n,o)=>o%10,this.hours.onChange=n=>{this.dPeriod.innerText="",this.valH=n.value,this.valP="",this.change(n)},this.hours.onSet=void 0):(this.hours.init(2,12),this.hours.onBuild=(n,o)=>{let l=o%10;switch(n._index){case 0:o%12==0&&(l=2);break;case 1:l==0&&(l="");break}return l},this.dots(this._edit),this.hours.onChange=n=>{const o=n.value;this.valH=o%12,o%12==0&&(this.valH=12),this.valP=o<12||o==0?"A":"P",this.dPeriod.innerText=this.valP,this.change(n)},this.hours.onSet=(n,o)=>{let l=n.value;if(n._index==1){const d=o.value%12;l=Number(d==0||d>=10)}return l}),this.hours.target(1,0),this.hours.limit(0,23).loop().speed(1).enable(),this.hours.set(i),this.tron(this._tron),this}dots(t=!0){this.hour24h||[0,2].forEach(i=>{const n=this.hours.list[1].dWrap.children[i];n.innerText="\u2022",n.classList.toggle("hide",!t)})}begin(t,i){this.onBegin!=null&&this.onBegin(this,t,i)}end(t,i){this.onEnd!=null&&this.onEnd(this,t,i)}execute(t,i){let n;switch(t){case this.hours:const o=this.hours.value;o!=this.lastH&&(n=!0,this.lastH=o);break;case this.mins:const l=this.mins.value;l!=this.lastM&&(n=!0,this.lastM=l);break}n&&this.onExecute!=null&&this.onExecute(this,t,i)}change(t){this.onChange!=null&&this.onChange(t)}set(t,i){this.hours.set(t),this.mins.set(i)}edit(t=!0){return this._edit=t,this.div.classList.toggle("edit",t),this.div.classList.toggle("lock",!t),this.hours.edit(t),this.dots(t),this.mins.edit(t),t||(this.hours.blurAll(),this.mins.blurAll()),this}tron(t=!0){return this._tron=t,this.div.classList.toggle("tron",t),this.hours.tron(t),this.mins.tron(t),this}bts(t=!0){return this._bts=t,this.div.classList.toggle("bts",t),this}get stringVal(){return sprintf("%02i:%02i%s",this.valH,this.mins.value,this.valP)}get value(){return sprintf("%02i:%02i",this.hours.value,this.mins.value)}}function Qe(s){return{days:Math.floor(s/(3600*24)),hours:Math.floor(s%(3600*24)/3600),minutes:Math.floor(s%3600/60),seconds:Math.floor(s%60)}}function Pa(s){const e=Qe(s);return sprintf("%ih%02im%02is",e.hours,e.minutes,e.seconds)}function ts(s,e=!0){let t={};return s>=3600?(t.v=`${Math.round(s/3600)}`,t.u=e?"h":"hr"):s>60?(t.v=`${Math.round(s/60)}`,t.u=e?"m":"min"):(t.v=`${s}`,t.u=e?"s":"sec"),t}function Ca(s){return ts(s,!1)}function ie(s){const e=s!=null?new Date(s*1e3):new Date,t=String(e.getFullYear()).slice(-2);return sprintf("%s.%02i.%02i",t,e.getMonth()+1,e.getDate())}function is(s){const e=s!=null?new Date(s*1e3):new Date;return sprintf("%02i:%02i:%02i",e.getHours(),e.getMinutes(),e.getSeconds())}function es(s){const e=s!=null?new Date(s*1e3):new Date,t=e.getHours(),i=t%12,n=t<=11||t==0?"A":"P";return sprintf("%2i:%02i%s",i,e.getMinutes(),n)}function Ma(s){return`${ie(s)} ${is(s)}`}function Na(s){return`${ie(s)} ${es(s)}`}const Oa=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Fa=["January","February","March","April","May","June","July","August","September","October","November","December"];function oi(s,e=!0){let t;if(e){const i=s.getHours()%12;t=sprintf("%u:%02u ",i==0?12:i,s.getMinutes()),t+=s.getHours()>=12?"PM":"AM"}else t=sprintf("%u:%02u ",s.getHours(),s.getMinutes());return t}function Aa(s,e=!1){const t=s!=null?new Date(s*1e3):new Date,i=new Date,n=Fa[t.getMonth()].slice(0,e?3:void 0),o=Oa[t.getDay()].slice(0,e?3:void 0),d=i.toLocaleTimeString().match(/AM|PM|am|pm|a.m.|p.m./),u=d!=null?d.length>0:!1,c=new Date;c.setHours(-24*6,0,0,0);const m=new Date;m.setHours(-24,0,0,0);const h=new Date;h.setHours(0,0,0,0);let L="unset";const w=t.getTime();return w>h.getTime()?L="Today at "+oi(t,u):w>m.getTime()?L="Yesterday at "+oi(t,u):w>c.getTime()?L=`${o}, ${oi(t,u)}`:(L=`${n} ${t.getDate()}, `,L+=t.getFullYear()==i.getFullYear()?oi(t,u):t.getFullYear()),L}var bt={durationObject:Qe,durationString:Pa,durationFormat:ts,durationFormatLong:Ca,dateString:ie,timeString:is,timeString12h:es,timeStringLong:Ma,timeStringLong12h:Na,relative:Aa};const Ha=`
  <div id="region" class="region">
    <div id="bg" class="bg"></div>
    <div id="wrap" class="wrap"></div> 
    <div id="fade" class="fade"></div>
    <div id="bracket_wrap" class="bracket_wrap">
      <div class="bracket">
        <div class="def"></div>
      </div>
    </div>
    <div id="status_wrap" class="status_wrap _dmm">
      <div id="status" class="status _dmm"></div>
    <div>
  </div>`,Ra=`
  <div class="bar">
    <div class="bg">
      <div class="fill"></div>
    </div>
    <div class="max_wrap">
      <div class="fill"></div>
    </div>
    <div class="min_wrap">
      <div class="fill"></div>
    </div>
  </div>`;class Ba extends R{constructor(t){super(t,"id");a(this,"data");a(this,"minVal");a(this,"maxVal");a(this,"range");a(this,"defN");a(this,"fitN",0);a(this,"capN",0);a(this,"dataN",0);a(this,"defW");a(this,"defM");a(this,"defP");a(this,"height");a(this,"width");a(this,"breakCount");a(this,"breakIndex");a(this,"onDraw");a(this,"onChange");this.link("info"),this.div.insertAdjacentHTML("beforeend",Ha),this.div.classList.add("tna_Graph"),this.dRegion=this.getDiv("region"),this.dBg=this.getDiv("bg"),this.dWrap=this.getDiv("wrap"),this.dFade=this.getDiv("fade"),this.getDiv("bracket_wrap"),this.dStatusW=this.getDiv("status_wrap"),this.dStatus=this.getDiv("status"),this.defW=this.getPropVal("--graph-w"),this.defM=this.getPropVal("--graph-m"),this.defP=this.getPropVal("--graph-p"),this.bracketW=this.getPropVal("--graph-bracket-w"),this.bracketP=this.getPropVal("--graph-bracket-p"),this.padN=this.getPropVal("--graph-left-n"),this.observer=new ResizeObserver(i=>{this.height=i[0].contentRect.height,this.width=i[0].contentRect.width-this.bracketW-this.bracketP,this.resize(),this.bound(),this.draw()}),this.observer.observe(this.div)}format(t){this.defN=t;for(let i=0;i<t;i++)this.dWrap.insertAdjacentHTML("beforeend",Ra),this.dWrap.lastElementChild;return this}resize(){this.fitN=Math.floor(this.width/(this.defW+this.defM*2)),this.capN=Math.min(this.fitN,this.defN);const t=Math.min(this.defN,this.dataN);this.setProp("--graph-n",t);const n=(this.dataN>this.capN-this.padN?t+this.padN:t)*(this.defW+this.defM*2),o=this.width==null?!1:n>this.width;if(this.div.classList.toggle("overflow",o),o){const d=Math.max(this.fitN-12,0),c=Math.min(d,9);this.setProp("--graph-fade-i",o*c)}}bound(){if(this.data==null)return!1;const t=this.capN<this.dataN?this.dataN-this.capN:0;let i=0,n=99;for(let d=t;d<this.dataN;d++)this.data.max[d]>=0&&(i=Math.max(i,this.data.max[d]),n=Math.min(n,this.data.min[d]));const o=i-n,l=4;o<l&&(n=Math.max(i-l,0)),this.range=i-n,this.minVal=n,this.maxVal=i}draw(){if(this.dataN==0)return;this.breakCount=0,this.breakIndex=-1;const t=this.capN<this.dataN?this.dataN-this.capN:0;for(let i=0;i<this.defN;i++){const n=i+t;let o=!0;n<this.dataN&&(this.data.max[n]==-1?this.breakCount++:(this.breakCount=0,this.breakIndex=-1),this.breakCount>0&&this.breakIndex==-1&&(this.breakIndex=i),this.breakCount>0?(this.drawBar(this.breakIndex,{max:-1,min:this.breakCount}),o=this.breakIndex!=i):(this.drawBar(i,{max:this.data.max[n],min:this.data.min[n]}),o=!1)),o&&this.drawBar(i,0)}this.onDraw!=null&&this.onDraw(this)}drawBar(t,i){const n=this.dWrap.children[t],o=typeof i=="object";let l=!0;if(o){let d,u,c;if(i.max==-1)n.style.setProperty("--graph-bar-n",i.min),n.classList.add("break"),n.classList.remove("fade","zero"),l=!1;else if(i.max>=0){if(i.max!=0)if(i.max>1){const b=(this.maxVal-i.max)/this.range*100,_=(i.min-this.minVal)/this.range*100;i.max!=i.min?(d=`calc(${(i.max-i.min)/this.range*100}%)`,u=`calc( ${_}% - ${this.defP}px)`,c=`calc( ${b}%)`):(d=`calc(${this.defP}px)`,u=`calc(${_}% - ${this.defP*2}px)`,c=i.min==this.minVal?`calc( ${b}% - ${this.defP}px)`:`calc( ${b}%)`)}else d=`calc(${this.defP}px)`,c=`calc( 100% - ${this.defP}px))`;else d=0;const m=n.querySelector(".max_wrap"),h=n.querySelector(".min_wrap");m.style.height=d,h.style.height=u,m.style.top=c;const L=i.max==this.maxVal;n.classList.toggle("peak",L);const w=(i.max-i.min)/this.range*this.height;if(n.classList.toggle("fade",w>5),n.classList.toggle("zero",i.min==0&&i.max==0),n.classList.toggle("warn",i.min==0&&i.max!=0),i.min==0&&i.max!=0){const b=1-(this.maxVal-i.max)/this.range;n.style.setProperty("--graph-i-h0",100-11/b+"%"),n.style.setProperty("--graph-i-h1",100-(11+8)/b+"%")}}}n.classList.toggle("show",o),l&&(n.style.setProperty("--graph-bar-n",""),n.classList.remove("break"))}set(t=this.data){bt.timeStringLong(t.t),t==null||this.data==null||t.t!=this.data.t,this.data=t,this.dataN=t.n,this.resize(),this.bound(),super.set(t)}status(t){return this.dStatus.innerText=t,this}set enable(t){this._enable=t}}const za=`<div id="region" class="region">
    <div id="strip_wrap" class="strip_wrap">
      <div id="strip" class="strip"></div>
    </div>
    <div id="fade_wrap" class="fade_wrap">
      <div id="fade_v" class="fade fade_v"></div>
      <div id="fade_h" class="fade fade_h"></div>
    </div>

    <div id="fill" class="fill"></div>
    <div id="rule" class="rule"></div>
    <div id="peak" class="peak _dmm">
      <div id="divot" class="divot"></div>
      <div id="mark" class="mark"></div>
    </div>
    <div id="flag_wrap" class="flag_wrap _dmm">
      <div id="flag" class="flag">wait</div>
    </div>
  </div>`;class Wa extends R{constructor(t){super(t);a(this,"_minVal");a(this,"_maxVal");a(this,"_run",!1);a(this,"_flag",!0);a(this,"maxW");a(this,"autoStop",!1);a(this,"lastTime");a(this,"lastPeak");a(this,"updateRate",33);a(this,"updateInt");a(this,"decay");a(this,"decayComp");a(this,"peak",0);a(this,"peakTimeout");a(this,"onPeak");this.link("info"),this.div.insertAdjacentHTML("beforeend",za),this.div.classList.add("tna_Meter"),this.dRegion=this.getDiv("region"),this.dRule=this.getDiv("rule"),this.dStrip=this.getDiv("strip"),this.dStripW=this.getDiv("strip_wrap"),this.dFade=this.getDiv("fade_wrap"),this.getDiv("fade_v"),this.getDiv("fade_h"),this.dFill=this.getDiv("fill"),this.dPeak=this.getDiv("peak"),this.getDiv("mark"),this.dDivot=this.getDiv("divot"),this.dFlagW=this.getDiv("flag_wrap"),this.dFlag=this.getDiv("flag"),this.attrFill=this.div.dataset.fill!=null,this.attrPeak=this.div.dataset.peak!=null,this.decay=this.getDataAttr("meterDecay","float",.2),this._minVal=this.getDataAttr("meterMin","float",0),this.maxVal=this.getDataAttr("meterMax","float",100),this.defH=this.getDataAttr("meterH","pixel"),this.minW=this.getDataAttr("meterMinW","pixel",6),this.peakTimeout=this.getDataAttr("meterPeakTimeout","number",1e3),this.peakW=this.getDataAttr("meterPeakW","pixel"),this.peakPad=this.getDataAttr("meterPeakP","pixel"),this.markW=this.getDataAttr("meterMarkW","pixel");const i=this.getDataAttr("meterDivision","integer");if(i>=3&&!isNaN(i))for(let n=1;n<=i+1;n++){let o=document.createElement("div");o.classList.add("mark"),this.dRule.appendChild(o)}if(this.div.dataset.meterRuleDouble!=null){const n=this.dRule.cloneNode(!0);this.dRegion.appendChild(n),n.id=`ruler_alt_${this.id}`,n.classList.add("alt")}this.bUpdate=this.update.bind(this),window.addEventListener("resize",this.resize.bind(this)),this.resize()}set maxVal(t){this._maxVal=t,this.range=this._maxVal-this._minVal,this.decayComp=this.range*this.decay}set flag(t){this._flag=t,this.dFlagW.style.display=t?"":"none"}set run(t){t!=this._run&&(this._run=t,t?(this.lastTime=this.lastPeak=performance.now(),this.updateInt=setInterval(this.bUpdate,this.updateRate)):(clearInterval(this.updateInt),this.set(0)))}resize(t){this.width=this.div.offsetWidth;let i=this.dRule.children.length;this.ruleSpacing=i!=0?this.width/(i-1):0,this.maxW=this.width-this.markW/2-this.peakW-this.peakPad-this.minW,this.draw()}draw(){const t=this.maxW*(this._val-this._minVal)/this.range;this.dFill.style.width=t+this.minW+"px";let i=this.maxW*(this.peak-this._minVal)/this.range;i=i>this.maxW?this.maxW:i,this.dPeak.style.left=i+this.peakPad+this.minW+"px",this.dRule.childNodes.forEach((n,o)=>{const l=t>Math.floor(o*this.ruleSpacing)+this.markW;n.classList.toggle("invert",l)})}update(){const t=performance.now(),i=this.decayComp*(1+this.autoStop*4)*(t-this.lastTime)/1e3;this.peak=Math.max(this.peak,this._val),this.autoStop&&this.peak==0&&(this.autoStop=!1,this._run=!1,clearInterval(this.updateInt)),this.draw(),this.peak>=this._maxVal&&t>this.lastPeak+this.peakTimeout&&(this.lastPeak=t,this.onPeak!=null&&this.onPeak(this)),this.peak-=i,this.peak=this.peak<0?0:this.peak,this.lastTime=t}render(t=this._view){super.render(t),this.dPeak.classList.toggle("show",t)}stop(){this.autoStop=!0,this._val=0}reset(){this.peak=0,this._val=0,this._run||this.draw()}busy(t=!0){t?(this.div.classList.add("busy"),this.dStripW.ontransitionend=null,this.dStrip.classList.add("move")):(this.div.classList.remove("busy"),this.dStripW.ontransitionend=this.busyEnd.bind(this))}busyEnd(t){this.div.classList.remove("busy"),this.dStripW.ontransitionend=null,this.dStrip.classList.remove("move")}set(t){this._val=Math.min(t,this._maxVal),this._run||this.draw(),super.set(t)}}class xt extends H{constructor(e,t){super(e),this.link(t),this.div.classList.add("tna_Twirl"),this.add='<polygon points="0,88 100,88 50,0"/>',this.def()}draw(){this.div.classList.toggle("open",this.value)}}class ss extends nt{constructor(t,i,n=4){super(t);a(this,"_count");a(this,"_inMin",-83);a(this,"_inMax",-45);a(this,"_out");this.link(i),this._count=n,this.div.classList.add("tna_RSSI"),this.setProp("--rssi-n",n)}init(){this.bars=this.div;for(let t=1;t<=5;t++)this.bars=this.bars.firstElementChild;this.bars=this.bars.children,this.index=0}draw(){const t=this._out;for(let i=0;i<this._count;i++)this.bars[i].classList.toggle("lit",i<t&&t!=0)}set value(t){this._out=t!=0?Math.round(this.range(t,this._inMin,this._inMax,0,this._count)):0,super.value=t,this.draw()}get value(){return super.value}warn(t=!0){return this.div.classList.toggle("warn",t),this}map(t,i){return this._inMin=t,this._inMax=i,this}range(t,i,n,o,l){const d=o+(l-o)*(t-i)/(n-i),u=Math.min(d,l);return Math.max(1,u)}}class Va extends ss{constructor(e,t,i){super(e,t,i),this.div.classList.add("tna_RSSI_Bar"),this.add=this.create(),super.init()}create(){let e='<g transform="translate(0 0)">';for(let t=0;t<this._count;t++)e+=`<polyline style="--rssi-i:${t}" points="0 100 0 0"/>`;return e+="</g>",e}}const Ua=`
  <g id="padlock_offset" transform="translate(34 0)">
    <rect fill-opacity="0" transform="translate(50 0)" x="0" y="0" width="100" height="100" fill="blue" stroke="none"></rect>
    <g id="shackle_wrap">
      <g id="shackle" stroke-miterlimit="1" stroke="var(--icon-fg)" fill="none">
        <path transform="translate(50 -5)" vector-effect="non-scaling-stroke" d="M28,74 L28,39 C28,26.8497355 37.8497355,17 50,17 C62.1502645,17 72,26.8497355 72,39 L72,59 L72,59"></path>
      </g>
    </g>
    <rect transform="translate(50 0)" x="10" y="50" width="80" height="50" fill="var(--icon-fg)" stroke="none"></rect>
  </g>`;class Xa extends nt{constructor(e,t){super(e),this.link(t),this.div.classList.add("tna_Padlock"),this.add=Ua,this.scale(.9).translate(5,10).def(),this.div.querySelector("#padlock_offset").classList.add("padlock_offset"),this.div.querySelector("#shackle_wrap").classList.add("shackle_move"),this.div.querySelector("#shackle").classList.add("shackle_swing")}draw(){this.div.classList.toggle("open",this.value),this.div.classList.toggle("lock",!this.value)}size(e){return this.sizeXY(e*2,e),this.div.style.setProperty("--padlock-h",e+"px"),this}}const qa=`
  <g transform="translate(7 10)" fill="none">
    <g transform="translate(-7 -9.73)">
      <path d="M60.59,74a11,11,0,1,1-21.18,0Z" />
      <path d="M79,73,68.5,33.16C67.31,29,63.94,26,59.7,26H40.63a9.42,9.42,0,0,0-8.8,7.12L21.33,73" />
    </g>
    <line x1="43" y1="19.31" x2="43" />
    <line y1="63.27" x2="86" y2="63.27" />
  </g >`;class Ga extends nt{constructor(e){super(e),this.div.classList.add("tna_Bell"),this.add=qa,this.def(),this._anim="bell_ring"}}const Ui=[{val:"_",text:"None"},{val:"W",text:"White"},{val:"R",text:"Red"},{val:"G",text:"Green"},{val:"B",text:"Blue"}],Ya=[{val:15},{val:20},{val:30},{val:60},{val:90}],ja=[{val:1},{val:2},{val:5},{val:10},{val:15},{val:20},{val:30},{val:60}],Ja=[{val:-10,text:"US Hawaii"},{val:-8,text:"US Pacific"},{val:-7,text:"US Mountain"},{val:-6,text:"US Central"},{val:-5,text:"US Eastern"},{val:0,text:"GMT"},{val:1,text:"EU Central"}],Za=[{text:"OFF"},{text:"LOW"},{text:"2"},{text:"3"},{text:"4"},{text:"5"},{text:"6"},{text:"7"},{text:"8"},{text:"HIGH"}],Ka=[{text:"OFF"},{text:"LOW"},{text:"2"},{text:"3"},{text:"4"},{text:"5"},{text:"6"},{text:"7"},{text:"8"},{text:"HIGH"}],Qa=[{text:"Time"},{text:"Date"},{text:"Seconds"}];var ki={color:Ui,ntp_int:Ya,gps_log_int:ja,bright:Za,tap:Ka,clock:Qa,tz:Ja};class ei extends nt{constructor(t,i){super(t);a(this,"_enable",!1);a(this,"_color");this.link(i),this.div.classList.add("tna_LED"),this.add='<circle stroke="var(--icon-fg)" stroke-width="16" fill="none" cx="50" cy="50" r="42"></circle>',this.add='<circle fill="var(--icon-fg)" cx="50" cy="50" r="50"></circle>',this.static(),this.index=1}draw(t){this.primed?t?this.prime(!1).choreo("blink","hot").timing(3,140).act():this.prime():this.primed=!0,this.view(t)}color(t){return this._color!=t&&(this.index=t!="white",this.div.classList.remove(this._color),this.div.classList.add(t),this._color=t),this}}const Bt={},pt={chip:""};let pi,Lt;function to(){fe("reg",!1),Bt.mfgTwirl=Lt=new xt("mfg_twirl").target("mfg_hit").show(),Lt.onExecute=e=>{e.toggle(),ue("mfg",e.value)},Lt.onExecute(Lt),Bt.regTwirl=pi=new xt("reg_twirl").target("reg_hit").show(),pi.onExecute=e=>{e.toggle(),ue("reg",e.value)},new k("info_mfg","object").onChange=(e,t)=>{if(Object.assign(pt,t),t.mfg_product!=null&&(Lt.label=t.mfg_product),t.mfg_version!=null&&(window.mfg_version.innerHTML=t.mfg_version),t.mfg_serial!=null&&ce(),t.mfg_date!=null&&(window.mfg_date.innerHTML=de(t.mfg_date)),t.mfg_logic!=null&&(window.mfg_logic.innerHTML=he(t.mfg_logic)),t.mfg_color!=null){const i=Ui.findIndex(n=>n.val==t.mfg_color);if(i>=0){const n=Ui[i];window.mfg_display_text.innerHTML=n.text,Bt.color.color(n.text.toLocaleLowerCase()).show()}}t.mfg_display!=null&&(window.mfg_display_version.innerHTML=he(t.mfg_display))},Bt.color=new ei("mfg_color").static().enable(),new k("info_reg","object").onChange=(e,t)=>{let i="";t.reg_name_1!=null&&(i+=t.reg_name_1),t.reg_name_2!=null&&(i+=" "+t.reg_name_2),i.length&&(pi.label=i),t.reg_date!=null&&(window.reg_date.innerHTML=de(t.reg_date)),fe("reg")};const s=new k("info_hardware","object");s.onChange=async(e,t)=>{t.chip!=null&&(pt.chip=et.sprintf("%08u",parseInt(t.chip)),ce()),N.currentID()=="about"&&N.setByID("about")}}function de(s){return"20"+s.replace(/\./g,"/")}function he(s){return s=s.split("/")[0].split("-")[0],s.match(/[A-Z]$/)?s.slice(0,-1):s}function ce(){let s="";pt.mfg_serial!=null&&(s=pt.mfg_serial.split("."),s=s.length>1?s[s.length-1]:s[0],s+="-"),pt.chip.length&&(s+=pt.chip),window.serial.innerHTML=s}function ue(s,e){document.querySelectorAll("._"+s).forEach(i=>{const n=i.tna;if(n!=null)switch(Object.getPrototypeOf(n)){case dt.prototype:n.toggle(e);break;case O.prototype:n.view(e);break}})}function fe(s,e=!0){document.querySelectorAll("._"+s).forEach(i=>i.style.display=e?"":"none")}function io(){if(pi.prime(),Lt.prime(),p.prop.preflight)f.send("call","call_admin");else{const s=new CustomEvent("meh");s.data=JSON.stringify(Qn),f.parse(s)}}var ns={tna:Bt,prop:pt,init:to,prime:io};const eo=2e3,y={},as={};let Ni,at,ht,D,Ft,zt=!1;function so(){new k("info_tap","object","info").onChange=(i,n)=>{if(!zt)return;D.set(n.v);const o=n.m/1023*100;D.run=!0,window.tap_max_val.innerText=o<100?et.sprintf("%3.1f",o):"|00.0";const l=parseInt(n.c);l>=0&&(window.tap_count_val.innerText=l);const d=parseInt(n.s);d>0&&ao(d)};const s=new E("tap_menu");s.onEnter=i=>{at.ext_lock(),ht.dLabel.classList.add("show"),window.tap_threshold.innerText="--.-",window.tap_max_val.innerText="--.-",window.tap_count_val.innerText="-",D.busy()},s.onExit=i=>{at.ext_lock(),ht.dLabel.classList.remove("show"),D.busy(!1)};let e="88.8";y.tap=ht=new Vi("tap").range(0,9).valRef(ki.tap),ht.END_DELAY=eo,ht.dLabel=window.tap_value,ht.onChange=(i,n)=>{I.update();const o=i.value>0;i.dLabel.innerText=ki.tap[i.value].text,i.dLabel.classList.add("prime"),Ft=1023,n!=null&&n.x!=null&&(Ft=i.value?n.x:1023,e=_e(Ft)),window.tap_threshold.innerText=e,D.maxVal=Ft,Kt.tna.clock_static.enable(o);const l=o&&Ni.value,d=l&&y.tilt.value;y.tilt.enable(l),y.alert.enable(d),Kt.drawIcon()};const t=new E("tap_test");t.onEnter=async i=>{const n=p.tna.ux.lastID=="tap_menu";at.div.firstElementChild.classList.remove("lock"),zt||(window.tap_value.classList.add("show"),window.tap_max_val.innerText="|88.8",window.tap_count_val.innerText="8",n||(D.flag=!1),D.busy(),await i.delay(500),window.tap_threshold.innerText=_e(Ft),window.tap_max_val.innerText="0.0",window.tap_count_val.innerText=0,D.show(),D.busy(!1),D.flag=!0,zt=!0)},t.onExit=()=>{at.div.firstElementChild.classList.add("lock"),D.stop(),D.hide(),window.tap_value.classList.remove("show"),window.tap_max_val.innerText="0.0",window.tap_count_val.innerText="0",zt=!1},at=new dt("tap_test"),at.ext_lock=i=>{const n=p.tna.ux.lastID;i=i==null?n!="tap_test"||n!="tap_menu":i,at.div.firstElementChild.classList.toggle("lock",i)},y.twirl=Ni=new xt("tap_twirl").target("tap_button").prime().show(),Ni.onExecute=async i=>{i.toggle(),I.update();let n;i.value?n="tap_test":p.tna.ux.current.id=="tap_test"&&(n="clock_hide"),i.value&&n!=null&&f.sendUX(n);const o=ht.value&&i.value;at.toggle(),i.value&&await i.delay(250),y.tilt.enable(o),y.alert.enable(o&&y.tilt.value),y.led.enable(o&&y.tilt.value),!i.value&&n!=null&&f.sendUX(n)},D=new Wa("tap_meter"),D.peakTimeout=150*4,D.onPeak=async i=>{window.tap_threshold.classList.add("blink"),await i.delay(i.peakTimeout),window.tap_threshold.classList.remove("blink")},window.tap_test.onclick=()=>{f.sendUX("tap_test"),D.run=!0},y.tilt=new C("tap_tilt"),y.tilt.autoEnable=!1,y.tilt.onChange=i=>{as.tilt_enable=i.value!=-1,I.update(),y.alert.enable(i.value),y.led.enable(i.value&&y.alert.value)},y.alert=new C("tap_alert"),y.alert.autoEnable=!1,y.alert.onChange=i=>{y.led.enable(),y.led.toggle(i.value),I.update()},y.led=new ei("tap_alert_led")}function no(){}async function ao(s){if(!!zt)switch(s){case 1:break;case 2:D.busy(),D.hide(),await D.delay(2500),D.busy(!1),D.show();break}}function _e(s){return s==1023?"100":et.sprintf("%3.1f",s/1023*100)}var lt={tna:y,prop:as,init:so,prime:no};const oo=4e3,Wt={},lo={};let gi,Xi,Vt,vi,ut,pe,li,mi,wi,bi,ge;function ro(){new E("alarm_menu"),new E("alarm_set"),Wt.enable=Vt=new C("daily_enable"),Vt.onExecute=t=>f.send("push","daily",t.value),Vt.onChange=async t=>{t.enable(),I.update(),t.value&&await t.delay(125),ve()},Wt.daily_sum=li=new fa("daily_sum"),Xi=new dt("daily_insert"),Wt.twirl=gi=new xt("daily_twirl").target("daily_button").prime().show(),gi.onExecute=async t=>{t.toggle(),Xi.toggle(t.value),li.view(!t.value),I.update(),t.value&&await t.delay(250),ve()},vi=new Xa("daily_edit").show(),vi.onExecute=t=>{t.choreo("blink","hal").act(!1),t.toggle(),ut.edit(t.value),ri(),os(!t.value)},Wt.daily_time=ut=new Sa("daily_time"),ut.onBegin=()=>ri(!1),ut.onEnd=()=>ri(),ut.onExecute=t=>{f.sendObject("push","daily",{h:t.hours.value,m:t.mins.value})};const s=new Ga("daily_bell").show(),e=new nt("daily_vol","pref").target("daily_vol_hit").show();e.onChange=t=>s.act(t.value>0),e.onExecute=t=>{t.value=++t.value>2?0:t.value,t.index=t.value,f.send("save","daily_vol",t.value),ri()},e.symbol("vol_wave_0").symbol("vol_wave_1").symbol("vol_wave_2"),pe=new k("daily","object","pref"),pe.onChange=(t,i)=>{const n=i.v;n!=null&&Vt.set(n);const o=i.h,l=i.m;o!=null&&(ut.set(o,l),li.set({h:o,m:l}),li.view(!gi.value))},wi=new C("daily_snooze"),wi.autoEnable=!1,wi.onExecute=t=>f.send("save","daily_snooze",t.value),mi=new C("alarm_tap"),mi.autoEnable=!1,mi.onExecute=t=>f.send("save","alarm_tap",t.value),bi=new C("daily_ind"),bi.autoEnable=!1,bi.onExecute=t=>f.send("save","daily_ind",t.value),window.daily_block.onclick=()=>vi.choreo("blink").timing(3,150).act()}function ve(){const s=gi.value&&Vt.value;mi.enable(s),wi.enable(s),bi.enable(s)}function ri(s=!0){clearInterval(ge),s&&(ge=setInterval(ho,oo))}function ho(){ut.edit(!1),vi.toggle(!1),os()}function os(s=!0){Xi.div.firstElementChild.classList.toggle("lock",s)}function co(){}var Jt={tna:Wt,prop:lo,init:ro,prime:co};const K={},Ct={};let Tt,qi,mt,me,j,x,At,Ht,Gi,ls=!1,Zt,di,Yi=!1;function uo(){new E("clock_service"),new E("diag_gps");let s=!1;me=new dt("info_service"),K.twirl=mt=new xt("service_twirl").target("service_button").prime().show(),mt.onExecute=e=>{e.toggle(),me.toggle(),ji()},Gi=new nt("service_warn").symbol("warn_ui").static().def(),j=new Ke("clock_service"),j.commitDelay=500,j.onBegin=()=>f.sendUX("clock_service","begin"),j.onPrime=()=>f.sendUX("clock_service","prime"),j.onCancel=()=>f.sendUX("clock_service","cancel"),j.onCommit=e=>e.drawStatus(!1),j.onChange=(e,t)=>{e.status=Ct.gps_active?"NTP":"GPS",e.drawStatus()},new k("info_status","object").onChange=(e,t)=>{const i=r.serviceID[t.v];Ct.gps_active=i=="GPS",mt.label=i;const n=r.serviceID[!t.v*1];j.prompt=n,j.enable(),ji()},x=new Ba("info_gps_log").format(120),x.onDraw=e=>{e.maxVal!=null&&(window.gps_log_max.innerText=e.maxVal,window.gps_log_min.innerText=e.minVal)},x.onChange=e=>{s=!1,ls=!0;let t=0,i=-1;for(let n=0;n<e.dataN;n++){const o=e.data.min[n];o>=0?(t+=o==0?i!=-1?n>i+1:1:0,i=-1):i=n}go(t)},K.gps_alert=new C("gps_alert"),K.gps_alert.autoEnable=!1,K.gps_alert.onChange=e=>{K.led.toggle(e.value),window.gps_alert_led.classList.toggle("blue",!p.install.xpio)},K.led=new ei("gps_alert_led"),qi=new k("info_gps","id"),qi.onChange=(e,t)=>{if(window.gps_act_value.innerText=t.v,window.gps_rec_value.innerText=t.rec,Ht=isNaN(t.d)?0:t.d,Ht&&po(Ht),At=t.t,!isNaN(At)&&At>1641024e3){const n=Math.round(new Date().getTime()/1e3)-At,o=Ht&&n>Ht;x.status(o?bt.durationString(n):"")}if(x.data!=null?At==x.data.t:!1){if(x.data!=null){s||(x.data.n>=x.defN&&(x.data.n--,x.data.max.shift(),x.data.min.shift()),x.data.n++,s=!0);const n=x.data.n-1,o=t.max,l=t.min;(x.data.max[n]!=o||x.data.min[n]!=l)&&(x.data.max[n]=o,x.data.min[n]=l,x.dataN=x.data.n,x.resize(),x.bound(),x.draw())}}else f.send("call","call_gps_log")},window.gps_act_cell.onclick=()=>f.sendUX("diag_gps"),Tt=new k("info_ntp","info"),Tt.onChange=(e,t)=>{const i=parseInt(t.v)==0;if(i){e.value=parseInt(t.s),e.fraction=parseInt(t.f),e.interval=parseInt(t.r);const o=new Date(e.value*1e3).toLocaleTimeString("en-GB");window.ntp_last.innerText=o,window.ntp_fraction.innerText=sprintf("%03u",t.f),window.ntp_process.innerText=parseInt(t.p)*2}else console.warn(`info_ntp error_code:${t.v}`);window.ntp_frac_cell.classList.toggle("opt",!i),window.ntp_error_cell.classList.toggle("opt",i),window.ntp_error_count.innerText=i?"-":t.x},window.ntp_sync_cell.onclick=async()=>{const e=Math.trunc((Date.now()-Tt.value*1e3)/1e3);e<5||(console.warn(`ntp manual sync last:${e}s ago`),window.ntp_sync_m.innerText=window.ntp_sync_s.innerText="--",f.sendUX("clock_service","commit"),Yi=!0,await S.delay(1e3),Yi=!1)}}async function ji(){const s=Ct.gps_active,e=mt.value;if(e){s&&!ls&&f.send("call","call_gps_log");const t=window[s?"info_gps":"info_ntp"],i=window[s?"info_ntp":"info_gps"];_o(),rs(),fo(),I.update(),i.classList.remove("show"),Mt.items.service_foot.toggle(!I.prop.enable&&!s),await mt.delay(250),t.classList.add("show")}else I.update();K.gps_alert.enable(e),K.led.enable(e)}function rs(){if(Ct.gps_active)return;let s=!1;if(di=0,Tt.value>0){const t=(Tt.value+Tt.interval)*1e3;di=Math.trunc((t-Date.now()+100)/1e3),s=di>=0}s=s&&Zt!=null&&!Yi;let e=bt.durationObject(di);window.ntp_sync_m.innerText=s?sprintf("%02i",e.minutes):"--",window.ntp_sync_s.innerText=s?sprintf("%02i",e.seconds):"--"}async function fo(){if(Zt!=null)return;const s=Date.now()/1e3,e=Math.round((s-Math.trunc(s))*1e3);await S.delay(1e3-e),Zt=setInterval(rs,1e3)}function _o(){clearInterval(Zt),Zt=void 0}function po(s){const e=qi.data.v<20?bt.durationFormatLong(s):bt.durationFormat(s);window.gps_log_int.innerText=e.v,window.gps_log_int_unit.innerText=e.u}function go(s){s?Gi.show().choreo("blink").timing(0,1e3).act():Gi.hide()}async function vo(){Ct.gps_active&&mt.onExecute(mt),!p.prop.preflight&&(await S.delay(250),x.set(ea),console.log("%ccomm test",G.style.test,"gps log"))}var Li={tna:K,prop:Ct,init:uo,prime:vo,select:ji};const we=2e3,T={};let Ut,be,xe,gt;const Et=Object.freeze({RESTORE:0,HIDE:1,SHOW:2});async function ds(s){const e=Mt.items;e.clock_24hr_item.toggle(s),e.tz_item.toggle(s),e.tz_hr.view(s),e.dst_hr.view(s),e.dst_item.toggle(s),s&&await T.tz.delay(250),T.tz.enable(s),T.dst.enable(s),T.mode.enable(s),p.activate.piezo&&T.clock_24h.enable(s)}function Ji(){const s=lt.tna.tap.value>0&&p.activate.piezo;let e=!1;Ut.value>0?s&&(gt.index=T.clock_static.value?Et.SHOW:Et.HIDE,e=!0):(gt.index=Et.RESTORE,e=!0),gt.viewStaged(e)}function mo(){T.clock_static=new k("clock_static","object","pref"),T.clock_static.onChange=()=>Ji();const s=new E("set_bright");s.onEnter=async n=>{},s.onExit=async n=>{},Ut=new Vi("ui_bright").range(0,9),Ut.END_DELAY=we,Ut.dLabel=window.bright_val,Ut.onChange=(n,o)=>{o!=null&&(be=o.x),n.dLabel.innerText=ki.bright[n.value].text,n.dLabel.classList.add("prime"),p.tna.retro.bright(n.value),Ji()},gt=new H("bright_icon"),gt.symbol("undo").symbol("hide").symbol("show").def().prime(),gt.onExecute=()=>{switch(gt.index){case Et.RESTORE:f.send("save","ui_bright",be);break;case Et.HIDE:f.send("save","clock_static",!0);break;case Et.SHOW:f.send("save","clock_static",!1);break}},T.twirl=xe=new xt("clock_twirl").target("clock_button").prime().show(),xe.onExecute=async n=>{n.toggle(),I.update(),ds(n.value)},T.mode=new C("tap_mode").enable(),T.mode.autoEnable=!1,T.mode.onChange=I.update,new E("clock_static"),new E("clock_hide"),new E("clock_switch");const e=new E("clock_tz");e.onEnter=()=>t.dLabel.classList.add("show"),e.onExit=()=>t.dLabel.classList.remove("show");const t=new Vi("clock_tz").range(0,6).valRef(ki.tz).valIO();t.END_DELAY=we,t.dLabel=window.tz_value,t.onChange=n=>{window.tz_label.innerText=n._valRef[n._val].text;const o=parseInt(n._valRef[n._val].value),l=o==0?"":o>0?"+":"\u2212";n.dLabel.innerText=l+Math.abs(n._valRef[n._val].val),n.dLabel.classList.add("prime"),window.tz_item.classList.remove("disable")},T.tz=t,new E("clock_dst");const i=new C("clock_dst");T.dst=i,new E("clock_24h"),T.clock_24h=new C("clock_24h"),T.clock_24h.onChange=n=>{Jt.tna.daily_sum.format(n.value),Jt.tna.daily_time.format(n.value)},new E("clock_pps"),T.pps_toggle=new C("clock_pps").onChange=n=>T.pps_led.toggle(n.value),T.pps_led=new ei("clock_pps_led").enable(),Li.init()}function wo(){bo(),Li.prime(),ds(!1)}let ye=!1;function bo(){if(!ye)if(ye=!0,p.activate.gps)window.clock_pps_label.style.display="none";else{let s=window.service_item,e=window.pps_wrap;s.insertAdjacentElement("beforeend",e),e.classList.add("pad"),s=window.service_help_p,e=window.clock_pps_span,s.insertAdjacentElement("beforeend",e),window.pps_help!=null&&window.pps_help.remove(),window.pps_item.style.display="none",window.clock_pps_label.innerText="PPS"}}var Kt={tna:T,init:mo,prime:wo,drawIcon:Ji};const xo=`
  <g fill="none">
    <circle stroke-width="18" r="8"></circle>
    <circle stroke-width="10" r="32"></circle>
    <circle stroke-width="10" r="52"></circle>
  </g>
  <g id="caution" class="caution">
    <polyline stroke-width="15" points="20 20 46 46"></circle>
  </g>`;class yo extends ss{constructor(e,t){super(e,t,3),this.div.classList.add("tna_RSSI_Wave"),this.add=xo,super.init(),this.dCaution=this.getDiv("caution")}draw(){super.draw()}}const v={},Qt={ip:"",mac:""};let Dt,B,hi,Di,Xt=bt.durationObject(0),Rt,Zi=0;function ko(){let s=!1;window.info_ssid.onclick=()=>{s^=!0,B.ext_lock(s)},hi=new C("net_alert"),hi.autoEnable=!1,hi.onChange=i=>v.led.toggle(i.value),v.alertToggle=hi,v.led=new ei("net_alert_led");const e=new E("diag_info");e.onEnter=()=>{B.ext_lock(!1),v.rssi.ext_sign(!1),Dt.value&&Rt==null&&(window.uptime_d.innerText="88",window.uptime_h.innerText=window.uptime_m.innerText="88",Rt=setInterval(ke,1e3))},e.onExit=()=>{B.ext_lock(),v.rssi.ext_sign(!1)},B=new dt("info"),B.ext_lock=(i=!0)=>{B.div.firstElementChild.classList.toggle("lock",i),i&&(v.rssi_dmm.value=0)},B.div.onclick=()=>f.sendUX("diag_info"),new ResizeObserver(i=>{Zi=i[0].contentRect.width,hs()}).observe(B.div),v.twirl=Dt=new xt("info_twirl").target("diag_button").prime().show(),Dt.onExecute=async i=>{i.toggle(),i.value&&(B.ext_lock(!1),p.prop.preflight&&f.send("call","call_admin")),Do(),I.update(),Rt=clearInterval(Rt),B.toggle(),await i.delay(250);let n;i.value?(n="diag_info",Rt=setInterval(ke,1e3),n!=null&&f.sendUX(n)):(B.ext_lock(!1),p.tna.ux.currentID=="diag_info"&&(n="clock_hide")),!i.value&&n!=null&&f.sendUX(n)},v.rssi_ind=new yo("rssi_ind").static().prime(),v.rssi_dmm=new Va("rssi_dmm","object",7).static().show(),v.rssi=new k("info_rssi"),v.rssi.ext_sign_div=window.rssi_sign,v.rssi.ext_sign=(i=!0)=>{v.rssi.ext_sign_div.innerHTML=i?"-":"&nbsp;",i||(v.rssi.div.innerHTML="--")},v.rssi.onChange=(i,n)=>{i.value=parseInt(n.v),v.rssi_ind.view(),v.rssi_dmm.view(),v.rssi_ind.value=v.rssi_dmm.value=i.value;const o=i.value<-79;v.rssi_ind.warn(o),v.rssi_dmm.warn(o),Dt.value,i.div.classList.toggle("warn",o),i.div.innerText=-i.value,i.ext_sign(),i.ext_sign_div.classList.toggle("warn",o)};const t=new k("info_net","object");t.onChange=(i,n)=>{window.info_ssid.innerText=n.v,Qt.mac=n.p,Qt.ip=n.q,Lo()},new k("info_firmware","object").onChange=(i,n)=>{const o=S.versionString(n.v);window.diag_client.innerText!=o?window.diag_firmware.innerText=o:window.diag_firmware.style.display="none",window.diag_version.style.display="unset"},Di=new k("info_uptime","object"),Di.onChange=(i,n)=>{i.value=n.v}}function Lo(){window.info_ip.innerHTML=Qt.ip.replace(/\b1/g,"|").replace(/\./g,","),window.info_mac.innerHTML=Qt.mac.replace(/:/g,";")}async function Do(){const s=Mt.items,e=Dt.value;s.net_item.toggle(e),e&&await Dt.delay(250),v.alertToggle.enable(e),v.led.enable(e)}function hs(){const s=39*(Xt.days<100),e=Zi<=354-s,t=Zi>=540-s;window.cell_ip.classList.toggle("alt",!t),window.uptime.classList.toggle("alt",e),window.uptime_d.classList.toggle("alt",e),window.uptime_h.classList.toggle("small",!e)}function ke(){let s=0;Di.value>0&&(s=Math.trunc(Date.now()/1e3)-Di.value),Xt=bt.durationObject(s),window.uptime_d.innerText=Xt.days,window.uptime_h.innerText=et.sprintf("%02i",Xt.hours),window.uptime_m.innerText=et.sprintf("%02i",Xt.minutes),hs()}function To(){v.led.prime()}async function Eo(){v.rssi_ind.view(!1),v.rssi_dmm.view(!1),v.rssi.ext_sign(!1),window.info_mac.innerHTML="",window.info_ip.innerHTML="",window.uptime_d.innerText="0",window.uptime_h.innerText="00",window.uptime_m.innerText="00"}var ti={tna:v,prop:Qt,init:ko,prime:To,close:Eo};const V={};let qt,Ki,_t;function Io(){V.develop=new C("develop"),S.initStorage("develop",V.develop),new E("set_sound"),qt=new wa("ui_sound").init(3);let s;s=qt.label(0).createDivFirst("radio_icon_0"),new H(s).static().show().symbol("o").def().size(12),s=qt.label(1).createDivFirst("radio_icon_1"),new H(s).static().show().symbol("bar_1").def().size(12),s=qt.label(2).createDivFirst("radio_icon_2"),new H(s).static().show().symbol("bar_2").def().size(12),new E("sys_restart");const n=new Ke("sys_restart");n.commitDelay=900+600+100+(2200+2200),n.onBegin=()=>f.sendUX("sys_restart","begin"),n.onPrime=c=>{f.sendUX("sys_restart","prime"),c.status="HOLD",c.drawStatus()},n.onCancel=()=>f.sendUX("sys_restart","cancel"),n.onCommit=async c=>{c.status="RESTARTING",c.value="",await c.delay(1e3),p.close()},n.onChange=(c,m)=>{const h=m.x;c.value=`0:0${h}`,h==0&&c.blink()},n.enable(),V.socket_breaker=Ki=new C("socket_breaker"),V.socket_breaker.onChange=c=>{f.monitor(c.value),p.tna.socket_button.view(!c.value&&V.develop.value)},new E("photo"),_t=new C("photo_toggle"),_t.onChange=(c,m)=>{c.value?f.send("call","call_photo"):f.sendUX("clock_hide"),localStorage.setItem("photo",Number(c.value)),Le(c.value)},_t.enable(),S.initStorage("photo",_t),Le(_t.value);const o=new E("diag_led");o.onEnter=()=>d(!0),o.onExit=()=>d(!1);const l=new le("identify");l.value=!1,l.icon().enable().set(!0),l.iStatus.symbol("refresh_run").size(20).def(),l.onExecute=c=>{if(c.value^=!0,p.prop.preflight){const m="diag_led";f.sendUX(p.tna.ux.currentID!=m?m:"clock_hide")}else d()};function d(c=l.value){l.iStatus.view(c).choreo("spin").timing(!c,1e3).act(),l.status=c?"do you see the <b>light?</b>":""}const u=new le("clear_button");u.enable(),u.onExecute=c=>localStorage.clear(),V.develop.enable(),V.develop.onChange=De,De(V.develop)}function $o(){qt.prime()}function Le(s){p.click.retro=s?()=>{const e=p.tna.ux.currentID!=null?p.tna.ux.currentID=="photo":!0;return f.send("call","call_photo",e),!0}:void 0}async function De(s){p.tna.socket_button.view(!Ki.value&&V.develop.value),localStorage.setItem("develop",Number(s.value));let e=document.querySelectorAll("._dev");e.forEach(t=>t.style.display=s.value?"":"none"),e=document.querySelectorAll("._dev_option"),e.forEach(t=>t.classList.toggle("show",s.value)),e=document.querySelectorAll("._dev_alt"),e.forEach(t=>t.style.display=s.value?"":"inherit"),e=document.querySelectorAll("._photo"),e.forEach(t=>t.style.display=_t.value?"":"none"),I.update(),window.pps_wrap.style.display=s.value?"":"none",await S.delay(250),_t.enable(s.value),Ki.enable(s.value)}var Ti={tna:V,init:Io,prime:$o};function So(){document.title=window.location.hostname.split(".")[0],N.add("about","About"),N.add("clock","Clock"),N.add("system","System"),Mt.init(),I.init(),p.init(),G.init(),ns.init(),Kt.init(),Jt.init(),lt.init(),ti.init(),Ti.init(),p.patch(),Ti.tna.socket_breaker.set(p.prop.preflight),!p.prop.preflight&&la.init()}p.upon.open=I.stage;p.upon.close=ti.close;p.upon.prime=(s,e)=>{Mt.prime(),I.prime(),G.prime();const t=s.piezo&&e.piezo,i=s.xpio&&e.xpio;window.ui_sound_hr.style.display=t?"none":"",window.tap_top_hr.style.display=t&&i||!(t&&!i)?"":"none";const n=N.inject(window.location.search);if(n!=null){const o=N.setByID(n,n=="about");it.tna.menu.index(o)}else N.setByID("clock");window.head_title.innerHTML=N.currentID()[0].toUpperCase()+N.currentID().slice(1),ns.prime(),Kt.prime(),ti.prime(),Ti.prime()};I.prop.onUpdate=s=>{try{const e=I.item,t=Mt.items,i=Ti.tna.develop.value,n=lt.tna.tap.value>0;window.clock_static_help.style.display=n&&p.activate.piezo?"":"none";const o=Kt.tna.twirl.value;e.clock_help.toggle(s&&!o),e.tz_help.toggle(s&&o),e.dst_help.toggle(s&&o),e.clock_24hr_help.toggle(s&&o||s&&!p.activate.piezo),t.tap_mode_item.toggle(o&&n),e.tap_mode_help.toggle(s&&o&&n);const l=Jt.tna.twirl.value,d=Jt.tna.enable.value;e.daily_help.toggle(s&&!l),e.daily_sub_help.toggle(s&&l),t.daily_snooze_hr.view(s&&d&&l),t.daily_snooze_item.toggle(d&&l),e.daily_snooze_help.toggle(s&&d&&l),t.alarm_tap_item.toggle(n&&d&&l),e.alarm_tap_help.toggle(s&&n&&d&&l),t.daily_ind_item.toggle(n&&d&&l),e.daily_ind_help.toggle(s&&n&&d&&l),t.daily_foot.toggle(!d&&l&&!s);const u=Li.tna.twirl.value,c=Li.prop.gps_active;e.service_help.toggle(s&&!u),t.service_foot.toggle(!s&&u&&!c),e.service_help_diag_gps.toggle(s&&u&&c),e.service_help_diag_ntp.toggle(s&&u&&!c),e.service_help_gps.toggle(s&&c),e.service_help_ntp.toggle(s&&!c),t.gps_alert_hr.view(s&&c&&u),t.gps_alert_item.toggle(c&&u),e.gps_alert_help.toggle(c&&u&&s),t.pps_hr.view(i),t.pps_item.toggle(i);const m=ti.tna.twirl.value;e.info_help.toggle(s&&!m),e.info_sub_help.toggle(s&&m),t.net_item_hr.view(s&&m),e.sound_help.toggle(s&&p.install.xpio);const h=lt.tna.twirl.value,w=n&&h&&lt.prop.tilt_enable;e.tap_help.toggle(s&&!h),t.tap_tilt_hr.view(s&&h),t.diag_tap_foot.toggle(s?0:(!lt.prop.tilt_enable||!n||!p.activate.xpio)&&h),e.tap_sub_help.toggle(s&&h),t.tap_tilt_item.toggle(w),e.tap_tilt_help.toggle(s&&w),t.tap_alert_item.toggle(w&&lt.tna.tilt.value),e.tap_alert_help.toggle(s&&w&&lt.tna.tilt.value);const b=ti.tna.twirl.value;e.info_help.toggle(s&&!b),e.net_help.toggle(s&&b),t.diag_led_item.toggle(i),e.diag_led_help.toggle(s&&i),t.socket_breaker_item.toggle(i),e.socket_breaker_help.toggle(s&&i),t.photo_toggle_item.toggle(i),e.photo_toggle_help.toggle(s&&i),t.clear_item.toggle(i),e.dev_clear_help.toggle(s&&i)}catch(e){console.warn("help onUpdate callback FAIL: %o",e)}};window.addEventListener("load",So);
