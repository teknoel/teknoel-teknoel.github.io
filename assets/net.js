var Ue=Object.defineProperty;var Xe=(s,e,t)=>e in s?Ue(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var a=(s,e,t)=>(Xe(s,typeof e!="symbol"?e+"":e,t),t);const Ge=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}};Ge();var qe={};(function(s){(function(){var e={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function t(c){return n(h(c),arguments)}function i(c,p){return t.apply(null,[c].concat(p||[]))}function n(c,p){var l=1,v=c.length,d,m="",k,_,u,Tt,Bt,Ht,zt,at;for(k=0;k<v;k++)if(typeof c[k]=="string")m+=c[k];else if(typeof c[k]=="object"){if(u=c[k],u.keys)for(d=p[l],_=0;_<u.keys.length;_++){if(d==null)throw new Error(t('[sprintf] Cannot access property "%s" of undefined value "%s"',u.keys[_],u.keys[_-1]));d=d[u.keys[_]]}else u.param_no?d=p[u.param_no]:d=p[l++];if(e.not_type.test(u.type)&&e.not_primitive.test(u.type)&&d instanceof Function&&(d=d()),e.numeric_arg.test(u.type)&&typeof d!="number"&&isNaN(d))throw new TypeError(t("[sprintf] expecting number but found %T",d));switch(e.number.test(u.type)&&(zt=d>=0),u.type){case"b":d=parseInt(d,10).toString(2);break;case"c":d=String.fromCharCode(parseInt(d,10));break;case"d":case"i":d=parseInt(d,10);break;case"j":d=JSON.stringify(d,null,u.width?parseInt(u.width):0);break;case"e":d=u.precision?parseFloat(d).toExponential(u.precision):parseFloat(d).toExponential();break;case"f":d=u.precision?parseFloat(d).toFixed(u.precision):parseFloat(d);break;case"g":d=u.precision?String(Number(d.toPrecision(u.precision))):parseFloat(d);break;case"o":d=(parseInt(d,10)>>>0).toString(8);break;case"s":d=String(d),d=u.precision?d.substring(0,u.precision):d;break;case"t":d=String(!!d),d=u.precision?d.substring(0,u.precision):d;break;case"T":d=Object.prototype.toString.call(d).slice(8,-1).toLowerCase(),d=u.precision?d.substring(0,u.precision):d;break;case"u":d=parseInt(d,10)>>>0;break;case"v":d=d.valueOf(),d=u.precision?d.substring(0,u.precision):d;break;case"x":d=(parseInt(d,10)>>>0).toString(16);break;case"X":d=(parseInt(d,10)>>>0).toString(16).toUpperCase();break}e.json.test(u.type)?m+=d:(e.number.test(u.type)&&(!zt||u.sign)?(at=zt?"+":"-",d=d.toString().replace(e.sign,"")):at="",Bt=u.pad_char?u.pad_char==="0"?"0":u.pad_char.charAt(1):" ",Ht=u.width-(at+d).length,Tt=u.width&&Ht>0?Bt.repeat(Ht):"",m+=u.align?at+d+Tt:Bt==="0"?at+Tt+d:Tt+at+d)}return m}var o=Object.create(null);function h(c){if(o[c])return o[c];for(var p=c,l,v=[],d=0;p;){if((l=e.text.exec(p))!==null)v.push(l[0]);else if((l=e.modulo.exec(p))!==null)v.push("%");else if((l=e.placeholder.exec(p))!==null){if(l[2]){d|=1;var m=[],k=l[2],_=[];if((_=e.key.exec(k))!==null)for(m.push(_[1]);(k=k.substring(_[0].length))!=="";)if((_=e.key_access.exec(k))!==null)m.push(_[1]);else if((_=e.index_access.exec(k))!==null)m.push(_[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");l[2]=m}else d|=2;if(d===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");v.push({placeholder:l[0],param_no:l[1],keys:l[2],sign:l[3],pad_char:l[4],align:l[5],width:l[6],precision:l[7],type:l[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");p=p.substring(l[0].length)}return o[c]=v}s.sprintf=t,s.vsprintf=i,typeof window!="undefined"&&(window.sprintf=t,window.vsprintf=i)})()})(qe);function Ze(s){return new Promise(e=>{setTimeout(()=>{e()},s)})}String.prototype.camelKabob=function(){let s="";return this.split("").map(e=>{s+=e.toUpperCase()==e?`-${e.toLowerCase()}`:e}),s};String.prototype.kabobCamel=function(){return this.replace(/-./g,s=>s[1].toUpperCase())};function Je(s,e,t){if(e.value==null){console.warn(`initStorage FAIL name:${s} target:${e}`);return}const i=localStorage.getItem(s);if(i!=null)return e.value=parseFloat(i),console.log(`initStorage ${s}:${e.value} data:${parseFloat(i)}`),e.value;if(t==null)localStorage.setItem(s,Number(e.value)),console.warn(`initStorage none:${s}, target:${e.value}`),e.onDefault!=null&&e.onDefault();else return localStorage.setItem(s,Number(t)),console.warn(`initStorage none:${s}, default:${t}`),e.value=t,t}function Ye(s){const e=s.split(".");let t="";for(let i in e)t+=i!=1?e[i]:Number("0x"+e[1]),i<e.length-1&&(t+=".");return t}var $={delay:Ze,initStorage:Je,versionString:Ye};const ue=["ping","call","ux","info","push","save","sync"],pe=["call_prime","call_console","call_tune","call_warn","call_restart","call_admin","call_photo","call_gps_log"],Ke=["none","default","notify","toggle_on","toggle_off","alarm","close_encounter","charge_fanfare","bonanza","guantanamera","rhythm_dancer"],Qe=["OK",'"index.html" served from FS'],ge=["null","sys_splash","sys_boot","sys_ap","sys_ota","sys_restart","sys_fail","reset_user","reset_admin","net_setup","net_menu","net_fail","set_bright","set_sound","tap_menu","tap_test","tap_notify","clock_static","clock_hide","clock_switch","clock_service","clock_tz","clock_dst","clock_24h","clock_pps","alarm_menu","alarm_set","alarm_notify","alarm_snooze","diag_info","diag_serial","diag_console","diag_net","diag_net_mac","diag_gps","diag_led","photo"],ve=["idle","init","begin","splash","prime","ready","run","update","wait","confirm","notify","commit","end","exit","cancel","expire","fail"],me=["info_rc","info_user","info_mfg","info_reg","info_hardware","info_firmware","info_install","info_uptime","info_net","info_rssi","info_display","info_status","info_tap","info_ntp","info_gps","info_gps_log"],_e=["admin_sign","admin_fpo","ota_version","ota_version_fs","ota_time","ota_time_fs","ota_fpo","mfg_product","mfg_version","mfg_date","mfg_serial","mfg_logic","mfg_display","mfg_color","mfg_note","mfg_fpo","reg_date","reg_name_1","reg_name_2","reg_user","reg_gift","reg_gp_1","reg_gp_2","reg_fpo","sys_output","sys_console","sys_fpo","def_name","def_device","def_ssid","def_pass","def_alert","def_net_fpo","def_bright","def_sound","def_av_fpo","def_tap_act","def_tap","def_tilt","def_tap_fpo","def_ntp_serve","def_ntp_int","def_ntp_fpo","def_nts_fpo","def_gps_alert","def_gps_log_i","def_gps_log_x","def_gps_fpo","def_tz","def_dst","def_24h","def_pps","def_clock_fpo","def_alarm_ind"],ti=100,we=["ux_boot","ux_index","ux_fpo","user_consent","user_fpo","net_name","net_device","net_ssid","net_pass","net_alert","net_fpo","ui_bright","ui_sound","ui_fpo","tap","tap_mode","tap_tilt","tap_alert","tap_fpo","ntp_server","ntp_interval","ntp_fpo","nts_fpo","gps_alert","gps_log_int","gps_log_ratio","gps_fpo","clock_static","clock_disp","clock_service","clock_tz","clock_dst","clock_24h","clock_pps","clock_fpo","alarm_tap","alarm_fpo","daily","daily_ind","daily_tone","daily_vol","daily_d","daily_h","daily_m","daily_snooze"],ei={display:0,piezo:1,xpio:2,gps:3},ii={display:1,piezo:2,xpio:4,gps:8},si=["CLOCK_HHMM","CLOCK_DATE","CLOCK_MMSS"],ni=["NTP","GPS","pps","none"],ai={action:ue,call:pe,ux:ge,info:me,admin:_e,pref:we,stage:ve};var I={master:ai,hwOffset:ei,hwMask:ii,actionID:ue,callID:pe,tuneID:Ke,warnID:Qe,uxID:ge,stageID:ve,infoID:me,prefBase:ti,prefID:we,adminID:_e,clockID:si,serviceID:ni};const ct={},ft={};let U=!1;var r={...I,getPrefID:li,controls:ct,linkControl:oi,getControlByID:ri,getControlByIndex:di,dialogs:ft,linkDialog:ci,printDialogs:ui,getDialogByIndex:fi,tron:hi};function oi(s){const e=I.master[s.linkType];if(e==null){U&&console.log(`linkControl FAIL id:${s.id}, bad type:${s.linkType}`);return}const t=e.indexOf(s.id),i=s.linkType=="pref"?I.prefBase:0;return t<0?(U&&console.log(`linkControl FAIL not found id:${s.id}`),!1):(s.linkID=t+i,ct[s.id]={obj:s},!0)}function ri(s){if(ct.hasOwnProperty(s))return ct[s].obj;U&&console.log(`map.getControlByID FAIL no table entry for ${s}`)}function di(s,e){let t=0;switch(s){case"action":t=I.actionID[e];break;case"call":t=I.callID[e];break;case"ux":t=I.uxID[e];break;case"info":t=I.infoID[e];break;case"pref":t=I.prefID[e-I.prefBase];break;case"admin":t=I.adminID[e];break}if(t==0){U&&console.log(`map.getControlByIndex FAIL not registered ${typeID}: ${e}`);return}if(ct.hasOwnProperty(t))return ct[t].obj;U&&console.log(`map.getControlByIndex FAIL no object ${typeID}:${e}`)}function li(s){let e=I.prefID.indexOf(s);if(e!=-1)return e+I.prefBase;console.warn(`getPrefID FAIL ${s} not found`)}function hi(s=!0){U=s}function ci(s){const e=I.uxID.indexOf(s.id);switch(e){case-1:return U&&console.log(`map.linkDialog FAIL id:${s.id}`),!1;default:s.linkID=e,ft[s.id]={obj:s};break}return!0}function fi(s){const e=I.uxID[s];if(e==null){U&&console.log(`map.getDialogByIndex FAIL ux not registered for ${s}`);return}if(ft.hasOwnProperty(e))return ft[e].obj;U&&console.log(`map.getDialogByIndex FAIL no object for :${e}`)}function ui(){console.warn("printDialogs");for(const s in ft)console.log(`  ${ft[s].obj.id}`)}Element.prototype.createDiv=function(s){const e=document.createElement("div");return e.id=s,this.appendChild(e),e};Element.prototype.createDivFirst=function(s){const e=document.createElement("div");return s!=null&&(e.id=s),this.insertAdjacentElement("afterbegin",e),e};function pi(s,e){const t=document.createElement("div"),i=s.id;return s.insertAdjacentElement("afterend",t),t.appendChild(s),i.length!=0&&(t.id=i),t.classList.value=s.classList.value,s.classList.value="",s.removeAttribute("id"),e!=null&&s.classList.add(e),t}var gi={nest:pi};class Q{constructor(e,t){a(this,"_id");a(this,"_tags",[]);a(this,"_valRef");a(this,"_valIO",!1);a(this,"_val");a(this,"_valLast");a(this,"_tron",!1);a(this,"_view",!1);a(this,"_height",0);a(this,"div");a(this,"data");a(this,"onChange");a(this,"onRender");switch(t=e.nodeType!=null?"div":t,t){case"object":case"obj":this.id=e;break;case"div":this.div=e,this.div.tna=this,this.id=e.id;break;case"id":default:this.div=document.getElementById(e),this.div!=null?this.div.tna=this:console.error(`tna construct no element for ${e}`),this.id=this.div==null?e:this.div.id;break}this.bRenderEnd=this.renderEnd.bind(this)}fuse(){return this.div==null?console.warn(`${this.id} fuse no div`):(this.div.classList.add("_tna"),this)}shy(e=!0){return this.div.classList.toggle("shy",e),this}prime(e=!0){if(this.div!=null)return this.div.classList.toggle("prime",e),this}touchPrime(){return this.div.ontouchstart=()=>{},this}show(){return this.render(!0),this}hide(){return this.render(!1),this}view(e=!0,t=!1){return this.render(e,t),this}viewStaged(e){return this.view(e,!0)}render(e=this._view,t=!1){this._view=e,this.div.classList.toggle("show",e),t?this.div.addEventListener("transitionend",this.bRenderEnd):this.callRender()}draw(){}renderEnd(){this.div.removeEventListener("transitionend",this.bRenderEnd),this.div.style.transition="",this.callRender()}callRender(){this.onRender!=null?this.onRender(this):this._view&&(this.onShow!=null?this.onShow(this):this.onHide!=null&&this.onHide(this))}display(e=!0){return console.log(`${this.id} display b:%o`,e),this.div.style.display=e?"":"none",this}getDiv(e,t){const i=this.div.querySelector(`#${e}`);if(i==null){console.warn(`${this.id} getDiv FAIL for "${e}"`);return}const n=t==null?this.div.id:t;return i.id=`${e}_${n}`,i}setProp(e,t){this.div.style.setProperty(e,t)}getProp(e){return getComputedStyle(this.div).getPropertyValue(e)}getPropVal(e){return parseFloat(this.getProp(e))}getDataAttr(e,t,i){const n=this.div.dataset[e],o=`--${e.camelKabob()}`,h=this.getProp(o);let c,p="";switch(t){case"pixel":p="px";case"integer":c=parseInt(n);break;case"percent":p="%";case"number":case"float":c=parseFloat(n);break;case"s":c=parseFloat(n)*1e3;break;case"string":return n==null?h.length>0?h:i:(c=n,c);default:c=parseFloat(n),n.indexOf("%")>0&&(p="%"),n.indexOf("px")>0&&(p="px");break}return isNaN(c)&&(c=parseInt(h),h.indexOf("%")>0&&(p="%"),h.indexOf("px")>0&&(p="px")),isNaN(c)&&c!=null&&(c=i),this.div.style.setProperty(o,c+p),c}parent(e,t){for(;!(e.id.indexOf(t)!=-1||e.parentElement==null);)e=e.parentElement;return e}async delay(e=1){return new Promise(t=>{setTimeout(()=>{t()},e)})}set(e){return this.data=e,e!=this._valLast&&(this.draw(),this.onChange!=null&&this.onChange(this,e),this._valLast=e),this}enable(e=!0){return this._enable=e,this}tag(...e){for(const t of e)this._tags.push(t);return this}hasTag(...e){let t=!1;for(const i of e)t=t||this._tags.find(n=>n==i);return t}latchClass(e){return this.div.querySelectorAll("._"+e).forEach(i=>i.classList.add(e)),this}set id(e){this._id=e}get id(){return this._id}valRef(e){return this._valRef=e,this}valIO(){return this._valIO=!0,this}set value(e){if(this._valIO&&this._valRef!=null&&this._valRef[0].val!=null){let t=this._valRef.findIndex(i=>i.val==e);t==-1&&(t=0,console.warn(`${this.id} set value(${e}) FAIL not in valRef, using _val:0`)),e=t}this._val=e}get value(){let e=this._val;return this._valIO&&this._valRef!=null&&this._valRef[0].val!=null&&(e=this._valRef[e].val),e}set height(e){this._height=e}get height(){return this._height}tron(e=!0){return this._tron=e,this}clamp(e,t,i){return Math.min(Math.max(e,t),i)}easeLinear(e,t,i,n){return i*e/n+t}easeInQuad(e,t,i,n){return i*(e/=n)*e+t}easeOutQuad(e,t,i,n){return-i*(e/=n)*(e-2)+t}easeInOutQuad(e,t,i,n){return(e/=n/2)<1?i/2*e*e+t:-i/2*(--e*(e-2)-1)+t}easeInSine(e,t,i,n){return-i*Math.cos(e/n*(Math.PI/2))+i+t}easeOutSine(e,t,i,n){return i*Math.sin(e/n*(Math.PI/2))+t}easeInOutSine(e,t,i,n){return-i/2*(Math.cos(Math.PI*e/n)-1)+t}easeInCubic(e,t,i,n){return i*(e/=n)*e*e+t}easeOutCubic(e,t,i,n){return i*((e=e/n-1)*e*e+1)+t}easeInOutCubic(e,t,i,n){return(e/=n/2)<1?i/2*e*e*e+t:i/2*((e-=2)*e*e+2)+t}easeOutElastic(e,t,i,n){let o,h=0,c=i;return e==0?t:(e/=n)==1?t+i:(h||(h=n*.3),c<Math.abs(i)?o=h/4:o=h/(2*Math.PI)*Math.asin(i/c),c*Math.pow(2,-10*e)*Math.sin((e*n-o)*(2*Math.PI)/h)+i+t)}}class bt extends Q{constructor(t){super(t);a(this,"_enable",!1);a(this,"_dynamic",!1);a(this,"_val",!1);a(this,"onChange");this.div.classList.add("tna_Accord"),this.div.dataset.dynamic!=null&&this.dynamic(),this.div.dataset.open!=null&&this.open(),this.div.dataset.prime!=null&&this.prime(),this._spill=this.div.dataset.spill!=null,this.bSpill=this.spill.bind(this)}prime(){return this.div.classList.add("prime"),this}resize(){const t=this.div.classList.contains("prime");this.div.classList.remove("prime"),this.div.classList.add("open"),this.div.style.setProperty("--accord-h","");const i=this.div.offsetHeight;this.div.style.setProperty("--accord-h",i+"px"),this.div.classList.toggle("open",this._val),this.div.classList.toggle("prime",t)}toggle(t){return this._val=t==null?!this._val:t,this._val?this.open():this.close(),this}open(){return this._val=!0,this.div.classList.add("open"),this._spill&&this.div.addEventListener("transitionend",this.bSpill),this.onChange!=null&&this.onChange(this),this}close(){return this._val=!1,this.div.classList.remove("open","spill"),this.onChange!=null&&this.onChange(this),this}spill(){return console.log(`${this.id} spill`),this.div.classList.add("spill"),this.div.removeEventListener("transitionend",this.bSpill),this}dynamic(t=!0){return t&&!this._dynamic?window.addEventListener("resize",this.resize.bind(this)):window.removeEventListener("resize",this.resize.bind(this)),this.resize(),this._dynamic=t,this}}class gt extends Q{constructor(t,i){super(t,i);a(this,"_enable",!1);a(this,"autoEnable",!0);a(this,"primed",!1);a(this,"synced");a(this,"linked");a(this,"linkType");a(this,"linkID");a(this,"valPush");a(this,"valSave");a(this,"lastTime");this._val=0}link(t){t!=null&&(this.linkType=t,this.linked=r.linkControl(this))}sync(t){const i=t.v;this.value=i,this.valPush=this.valSave=i,this.set(t),this.synced||(this.autoEnable&&this._enable!=null&&this.enable(),this.synced=!0)}push(){if(this.linked==!1)return;const t=this.value;t!=this.valPush&&(this.valPush=t,this.send("push",t))}save(){if(this.linked==!1)return;const t=this.value;t!=this.valSave&&(this.valSave=this.valPush=t,this.send("save",t))}send(t,i){const n={a:r.actionID.indexOf(t),t:[]};n.t.push({i:this.linkID,v:i|0}),this.linked!=null&&w.transmit(n,`${this.id} >>`)}}const vi=`<div id="region" class="region">
    <div id="wrap" class="wrap"></div>
    <div id="label"></div>
  </div>`;class Y extends gt{constructor(t,i){super(t);a(this,"_enable",!0);a(this,"_highlight",!1);a(this,"_static",!1);a(this,"_target");a(this,"_index");a(this,"_x0",0);a(this,"_y0",0);a(this,"_x1",100);a(this,"_y1",100);a(this,"_x",0);a(this,"_y",0);a(this,"_scaleX",1);a(this,"_scaleY",1);a(this,"list",[]);a(this,"onExecute");this.link(i),this.target(this.div),this.div.insertAdjacentHTML("beforeend",vi),this.div.classList.add("tna_Icon"),this.dRegion=this.getDiv("region"),this.dWrap=this.getDiv("wrap"),this.dLabel=this.getDiv("label"),isNaN(this.getPropVal("--icon-w"))&&this.setProp("--icon-w",this.getProp("--icon-h")),this._val=0,this.label=this.getDataAttr("label","string","")}set add(t){const i=`
      <svg class="svg" viewBox="${this._x0} ${this._y0} ${this._x1} ${this._y1}">
        <g><circle cx="0" cy="0" r="50" /></g>
      </svg>`;this.dWrap.insertAdjacentHTML("beforeend",i);const n=this.dWrap.lastChild,o=n.lastElementChild;o.innerHTML=t,this.list.push(n),this.update()}set addCenter(t){this.add=t,this.list.slice(-1)[0].lastElementChild.firstElementChild.setAttribute("transform","translate(-50 -50)")}symbol(t){return window["sym_"+t]==null?console.warn(`${this.id} addSymbol FAIL: ${t}`):this.add=`<use href="#sym_${t}"/>`,this}enable(t=!0){return t==this._enable?this:(this._enable=t,this.render(),this)}render(t=this._view,i){super.render(t,i),this.div.classList.toggle("interact",t&&this._enable&&!this._static),this.div.classList.toggle("disable",!this._enable&&this._view)}set index(t){if(t=Number(t),isNaN(t))return console.warn(`${this.id} set index NaN`);if(t==this._index)return;this._index!=null&&this.list[this._index].classList.remove("show"),this.list[t].classList.add("show"),this._index=t}get index(){return this._index}def(){return this.index=0,this}toggle(t){return this._val=t==null?!this._val:t,this.draw(t),this}cycle(){let t=this._index+1;return t=t>=this.list.length?0:t,this.index=t,this.draw(),this}clear(){this.list.forEach(t=>t.remove()),this.list=[]}update(){const t=`translate(${this._x} ${this._y}) scale(${this._scaleX} ${this._scaleY})`;for(let i in this.list)this.list[i].firstElementChild.setAttribute("transform",t)}execute(){this.onExecute!=null&&this.onExecute(this),this.onChange!=null&&this.onChange(this)}set(t){typeof t!="object"&&(this.value=t),t!=this.lastVal&&(this.index=this.value),super.set(t)}svgRef(t){return t>this.list.length-1?console.warn(`${this.id} svgRef FAIL, bad index`):this.list[t]}gRef(t){return t>this.list.length-1?console.warn(`${this.id} gRef FAIL, bad index`):this.list[t].firstElementChild}viewBox(t,i,n,o){return this._x0=t,this._y0=i,this._x1=n,this._y1=o,this}translate(t,i){return this._x=t,this._y=i,this.update(),this}center(){return this.translate(50,50),this}scaleXY(t,i){return this._scaleX=t,this._scaleY=i,this.update(),this}scale(t){return this._scaleX=this._scaleY=t,this.update(),this}scaleCenter(t){return this._scaleX=this._scaleY=t,this._x=50,this._y=50,this.update(),this}sizeXY(t,i){return this.div.style.setProperty("--icon-h",i+"px"),this.div.style.setProperty("--icon-w",t+"px"),this}size(t){return this.div.style.setProperty("--icon-x",t),this}highlight(t){if(t==-1&&(t=!this._enable),!!this._enable)return this._highlight=t,this.div.classList.toggle("highlight",t),this}static(t=!0){return this._static=t,this.div.classList.toggle("interact",!t),this}set label(t){const i=t.length>0;this.dLabel.innerText=i?t:"",this.dLabel.classList.toggle("label",i)}target(t){return this._target=typeof t=="string"?window[t]:t,this._target.onclick=this.execute.bind(this),t!=this.div&&(this.div.style.pointerEvents="none"),this}enabled(){return this._enable}}class q extends Y{constructor(t,i){super(t);a(this,"_class");a(this,"_anim");a(this,"_count",0);a(this,"_duration",0);a(this,"_delay",0);a(this,"onAnimEnd");this.link(i)}async act(t=!0){const i=this._class!=null?"act_"+this._class:"act";if(this.div.classList.contains(i)&&(this.div.classList.remove(i),await this.delay()),this.div.classList.toggle(i,t),t){const n="tna_Icon_"+(this._anim!=null?"act_"+this._anim:"act");this.div.onanimationend=o=>{`${this.id}`,o.animationName==n&&this.div.classList.remove(i),this.div.onanimationend=void 0,this.onAnimEnd!=null&&this.onAnimEnd(this)}}else this.div.onanimationend=void 0;return this}choreo(t,i){return this._anim=t,this._class=t+(i==null?"":"_"+i),this}timing(t,i=this._dur,n=0){this._count=t=Number(t),this._dur=i=Number(i),this._delay=n=Number(n);const o="--icon-act_"+this._anim;return this.setProp(o+"-n",t==0?"infinite":t),this.setProp(o+"-t",i+"ms"),this.setProp(o+"-d",n+"ms"),this}property(t,i){this.dWrap.style.setProperty("--icon-act-"+t,i)}}const mi=`<g fill="var(--icon-fg)" transform="translate(-50, -50)">
      <use href="#sym_hit" />
    </g>
    <g fill="var(--icon-fg)" transform="translate(-50, -50)">
      <use href="#sym_help" />
    </g>`,_i=`<circle fill="white" stroke="none" cx="0" cy="0" r="50" />
    <g fill="black" transform="translate(-50, -50)">
      <use href="#sym_help" />
    </g> `;var ne={help_1:mi,help_2:_i};const ye={},et={enable:!1},vt={};let P;function wi(){Li();let s;s=document.querySelectorAll("._help"),s.forEach(e=>gi.nest(e,"wrap")),s=document.querySelectorAll("._help"),s.forEach((e,t)=>{e.id.length==0&&(e.id=`help_${t}`);const i=e.id.length!=0?e.id:t;e.setAttribute("data-dynamic",""),vt[i]=new bt(e.id)}),window.help!=null&&(ye.button=P=new Y("help").show(),P.add=ne.help_1,P.add=ne.help_2,P.translate(50,50).def(),P.onExecute=e=>{e.value^=!0},P.onChange=async e=>{e.index=e.value,e.value||(D.prop.prime_local=!1),localStorage.setItem("help",Number(e.value)),xe()},$.initStorage("help",P,!0)),et.flag=!1}function yi(){P.onChange(P)}async function xi(){for(const[s,e]of Object.entries(vt))e.prime()}function bi(){return!!P.value}function xe(s){et.enable=!!P.value;for(const[e,t]of Object.entries(vt))t.toggle(et.enable);et.onUpdate!=null&&et.onUpdate(et.enable)}function ki(s){vt[s.id]=s}function Li(){let s;s=document.querySelectorAll("._help"),s.forEach((e,t)=>{e.id.length==0&&(e.id=`help_${t}`);const i=e.id.length!=0?e.id:t;vt[i]=new bt(e.id)})}var K={tna:ye,prop:et,item:vt,init:wi,prime:xi,stage:yi,state:bi,update:xe,add:ki};const ut=[];let pt;function Ei(s,e){const t=window[s];if(t==null)return console.log(`panel.add() FAIL, cannot find ${s}`);t.dataset.index=ut.length,ut.push({id:s,title:e,panel:t})}function Ii(){if(pt!=null)return ut[pt].panel}function Di(){return pt}function Ti(){return pt!=null?ut[pt].id:void 0}function be(s,e=!1){s<0||(pt=s,ut.forEach((t,i)=>{const n=t.panel,o=s==i;e||(n.classList.toggle("show",o),n.children[0].classList.toggle("show",o)),o&&n._tna_begin!=null&&n._tna_begin()}))}function $i(s,e=!1){const t=ut.findIndex(i=>i.id==s);return t!=null&&be(t,e),t}function Si(s){return new URLSearchParams(s).get("panel")}var Pt={add:Ei,current:Ii,currentID:Ti,currentIndex:Di,index:be,setByID:$i,inject:Si};class Xt extends Q{constructor(t,i){super(t,"div");a(this,"_static",!1);a(this,"_index");a(this,"_label");a(this,"_html");a(this,"_target");a(this,"control");a(this,"bClick");if(i!=null){this.control=i,this.div.classList.add("menu_item"),this.dLabel=this.getDiv("label"),this.bClick=this.click.bind(this);let n=this.div.querySelector("._click");n==null&&(n=this.div),n._tna_target=this.div,this._target=n}else this.div.classList.add("menu_static"),this._target=this.div,this.static();this.enable()}click(t){let i=t.target._tna_target;i==null&&(i=this.parent(t.target,"_item")),this.execute(i),t.preventDefault(),t.stopImmediatePropagation()}async execute(t){this.control.click(this),this.div.classList.remove("hover"),this.div.classList.add("action"),await this.delay(360),this.control.view(!1),await this.delay(300),this.div.classList.remove("action"),this.control.execute(this)}enable(t=!0){return this.enabled=t,this.control!=null&&this.div.classList.toggle("hover",t&&this.control._hover),this.div.classList.toggle("enable",t),this._target.onclick=t&&!this._static?this.bClick:null,this._target.style.pointerEvents=t&&!this._static?"":"none",this}highlight(t=!0){return this.div.classList.toggle("highlight",t),this.enable(!t),this}set label(t){this.dLabel.innerText=this._label=t}get label(){return this._label}set html(t){this.dLabel.innerHTML=this._html=t}static(t=!0){return this._static=t,this._target.onclick=this.enabled&&!this._static?this.bClick:null,this._target.style.pointerEvents=t?"none":"",this}}const Pi=`<div id="region" class="region">
    <div id="bg" class="bg"></div>
    <div id="panel" class="panel"></div>
  </div>`,Ci=`<div>
    <div id="label" class="label"></div>
  </div>`;class Oi extends Q{constructor(t,i=Pi){super(t);a(this,"_enable",!1);a(this,"_index");a(this,"_highlight",!1);a(this,"_hover",!0);a(this,"_static_high",!0);a(this,"_wipe",!1);a(this,"_tm_open");a(this,"_tm_close");a(this,"_block_tm_open");a(this,"_block_tm_close");a(this,"_block_opacity");a(this,"_itemT");a(this,"_staticT");a(this,"_itemN",0);a(this,"_staticN",0);a(this,"pool",[]);a(this,"list",[]);a(this,"last");a(this,"onBegin");a(this,"onEndPrime");a(this,"onEnd");a(this,"onPrime");a(this,"onExecute");a(this,"onResize");this._itemT=Ci,this.div.insertAdjacentHTML("afterbegin",i),this.div.classList.add("tna_Menu"),this.dRegion=this.getDiv("region"),this.dBg=this.getDiv("bg"),this.dPanel=this.getDiv("panel"),this.getDiv("banner"),this.blocked=this.div.dataset.block!=null,this.blocked&&(this.dBlock=document.createElement("div"),this.dBlock.id="block",this.div.insertAdjacentElement("afterbegin",this.dBlock),this.getDiv("block"),this.dBlock.classList.add("block"),this.dBlock.onmousedown=this.dBlock.ontouchstart=this.escape.bind(this)),this._highlight=this.div.dataset.highlight!=null,this.enable(this.div.dataset.enable!=null),this._block_opacity=this.getProp("--menu-block-a"),this.itemH=this.getDataAttr("menuIH","pixel",""),this.staticH=this.getDataAttr("menuStaticH","pixel",""),this.merge()}merge(){let t,i;const n=this.div.childElementCount-this.blocked;for(let o=1;o<n;o++)i=this.div.children[1+this.blocked],i.classList.contains("menu_item")?(t=this.add(),t.link=i.dataset.link,t.label=i.innerHTML,i.dataset.highlight!=null&&(this._index=t._index)):i.classList.contains("menu_static")&&(t=this.add("static")),t.view(!0),i.remove();this._index!=null&&this.index(this._index),n>1&&this.update()}add(t="item"){let i,n;switch(t){case"static":if(this._staticT!=null){const o=document.createElement("template");o.innerHTML=this._staticT,n=o.content.firstElementChild.cloneNode(!0)}else n=document.createElement("div");this.last=this.createStatic(n);break;default:if(this._itemT!=null){const o=document.createElement("template");o.innerHTML=this._itemT,n=o.content.firstElementChild.cloneNode(!0)}else n=document.createElement("div");this.last=this.createItem(n);break}return i=this.dPanel.appendChild(n),this.pool.push(i),this.last}createItem(t){const i=new Xt(t,this),n=`${this.id}_item_${this._itemN}`;return t.id=i.id=n,i._index=this._itemN,i.link=this._itemN,i.height=this.itemH,this.list.push(t),this._itemN++,i}createStatic(t){const i=new Xt(t).static(),n=`${this.id}_static_${this._itemN}`;return t.id=i.id=n,i.height=this.staticH,this._staticN++,i}index(t){this._index=t;for(let i in this.pool)this.pool[i].tna.highlight(!1);return t>=0&&this.list[t].tna.highlight(),this.setStatic(t),super.set(t),this}setStatic(t){if(!this._static_high)return;let i;if(this.pool.find((n,o)=>{const h=n==this.list[t];return h&&(i=o),h}),i!=null){const n=i-1,o=i+1;n>=0&&this.pool[n].tna.highlight(),o<this.pool.length-1&&this.pool[o].tna.highlight()}}update(){let t=0;return this.pool.forEach((i,n)=>{t+=i.tna.height*i.tna._view}),this.height=t,t}clear(){this.list.forEach(t=>{t.tna=void 0,t.remove()}),this.list=[],this.pool=[],this._itemN=this._staticN=0,this.update()}click(t){this.last=t,this._wipe&&this.index(-1),this.setStatic(t._index),this.onPrime!=null&&this.onPrime(t,t.link)}execute(t){this._highlight&&(t.enable(!1),this.index(t._index)),this.onExecute!=null&&this.onExecute(this,t.link)&&this.end()}async escape(t){t!=null&&(t.stopImmediatePropagation(),t.preventDefault()),this.view(!1),this.transBlock(this._block_tm_close),this.onEnd!=null&&this.onEnd(this)}begin(){this.transRegion(this._tm_open,"ease-out"),this.transBlock(this._block_tm_open,"ease"),this.onBegin!=null&&this.onBegin(this,!0)}endPrime(){this.transRegion(this._tm_close,"ease-in"),this.onEndPrime!=null&&this.onEndPrime(this)}end(){this.transBlock(),this.onEnd!=null&&this.onEnd(this)}render(t=this._view){super.render(t),this.div.classList.toggle("open",t),t?this.begin():this.endPrime()}find(t){return this.list.find(n=>n.tna.label==t)}wipe(t=!0){return this._wipe=t,this}hover(t=!0){return this._hover=t,this}set height(t){this._height=t,this.div.style.setProperty("--menu-h",t+"px"),this.onResize!=null&&this.onResize(this)}get height(){return this._height}get count(){return Object.keys(this.list).length}get next(){if(this.last._index<this.count)return this.list[this.last._index+1]}get previous(){if(this.last._index>0)return this.list[this.last._index-1]}set template(t){this._itemT=t}set templateStatic(t){this._staticT=t}staticHigh(t=!0){return this._static_high=t,this}timing(t,i){return this._tm_open=t,this._tm_close=i,this}timingBlock(t,i){return this._block_tm_open=t,this._block_tm_close=i,this}transRegion(t=0,i=""){const n=t+"ms";return this.dRegion.style.transitionDuration=n,this.dRegion.style.transitionTimingFunction=i,this}transBlock(t=0,i=""){const n=t+"ms",o=this._view?this._block_opacity:0;return this.dBlock.style.transitionDuration=n,this.dBlock.style.transitionTimingFunction=i,this.dBlock.style.opacity=o,this.dBlock.style.visibility="visible",t==0?this.transBlockEnd():this.dBlock.ontransitionend=this.transBlockEnd.bind(this),this}transBlockEnd(){this._view||(this.dBlock.style.visibility="hidden"),this.dBlock.ontransitionend=void 0}}var ke={control:Oi,item:Xt};const Mi=`<g stroke-width="6.7">
    <polygon
      points="89.5 72.8 50 95.6 10.5 72.8 10.5 27.2 50 4.4 89.5 27.2 89.5 72.8"
    />
    <polyline id="badge_N" points="28.4 62 28.4 38 71.6 62 71.6 38" />
  </g>`,Ai=`<div id="region" class="region">
    <div id="bg" class="bg"></div>
    <div id="banner" class="banner">
      <div class="banner_wrap">
        <div>C</div><div>u</div><div>b</div><div>e</div>
        <div>C</div><div>o</div><div>r</div><div>e</div></div></div>
    <div id="panel" class="panel"></div>
    </div>
  </div>`;const Ct={},Gt=[];let b,T,mt,Wt,Le=!1,$t=!1;function Ri(){if(Ct.badge=T=new q("badge").show(),T.div.classList.add("connect"),T.add=Mi,T.value=!1,T.def(),T.ext_onExecute=e=>{e.choreo("3D_flip").timing(1,250).act(),b.view(!b._view),b._view||b.escape()},Ie(!D.prop.modeExt),Ct.dot=mt=new Y("badge_dot"),mt.add='<circle cx="50" cy="50" r="50" />',mt.static().prime().def(),mt.onRender=e=>mt.div.classList.toggle("orbit",e._view),window.menu!=null){Ct.menu=b=new ke.control("menu",Ai).wipe(),Wt=b._index,b.timing(250,250).timingBlock(500,250),b.onExecute=(t,i)=>{t.last.index==0;const n=Ee(i);return n&&(Wt=t._index),s(),n},b.onBegin=b.onEnd=t=>{T.highlight(t._view);const i=t._view?"blur(3px)":"",n=t._view?t._block_tm_open:t._block_tm_close;oe(n,"ease",i),$t=!1},ae("Admin");const e=ae("R/Con","rc");e.html='R<span style="padding-left: 2px; font-size: 130%; position: relative; top: 1.5px;">/</span>Con'}const s=async()=>{$t=!0,await $.delay(2e3),$t&&(T.highlight(!1),b.index(Wt),b.transBlock(),oe(),$t=!1)}}function ae(s,e){const t=b.find(s);if(t==null){let i=b.add("static").enable();return Gt.push(i),i=b.add().enable(),Gt.push(i),i.label=s,i.link=`/${e!=null?e:s.toLowerCase()}/`,Le=!0,i}else return t.tna}function oe(s=0,e="",t=""){const i=s+"ms",n=window.fit!=null?Pt.current():window.page;if(n==null)return console.warn("nav menuBG FAIL");n.style.filter=t,n.style.transitionProperty="filter",n.style.transitionDuration=`${i}`,n.style.transitionTimingFunction=e}function Ee(s){console.log(`hyper -> "${s}"`);const e=Pt.currentIndex(),t=new URL(s,"http://x"),i=t.pathname==document.location.pathname;if(i){const n=Pt.inject(t.search);Pt.setByID(n)}else!D.prop.local&&s.length>1&&s.slice(-1)=="/"&&(s=s.slice(0,-1)),window.location=s,b.index(e);return i}function Fi(s){!Le||(Gt.forEach(e=>e.view(s)),b.update())}function Ie(s=!0){T.div.classList.toggle("static",!s),T.div.classList.toggle("dim",!s),T.onExecute=s?T.ext_onExecute:void 0,T.enable(s)}var j={tna:Ct,init:Ri,enable:Ie,hyper:Ee,access:Fi};class H extends gt{constructor(t,i=void 0,n="info"){super(t,i);a(this,"onChange");this.link(n)}}const N={cast:"border-radius: 9px; padding: 1px 7px 0; font-style: italic; font-weight: bold",test:"border: 0.25px solid gray; border-style: solid solid solid none; border-radius: 0 9px 9px 0; padding: 1px 7px 0 0; font-style: italic; font-weight: bold",gray:"border: 0.25px solid gray; background: gray; color: white;",black:"border: 0.25px solid black; background: black; color: white;",red:"border: 0.25px solid red; background: red; color: white;",gold:"border: 0.25px solid gray; background: gold; color: black;"},Z=["fail","cache","cache_end","tear","touch","normal","warn","error","alert","bold"],qt={},tt={},z={};let Ot,Mt,Zt=0;function Ni(){Ot=r.callID.indexOf("call_console"),qt.rc=new H("call_console","object","call"),qt.rc.onChange=(s,e)=>{switch(e.v){case 0:z.fail!=null?z.fail():A("fail","Access Not Authorized");break;case 1:e.n==1&&(Mt=0);const t=JSON.stringify(e);console.groupCollapsed("cache n:%o, count:%o",e.n,e.z.length),console.log(t),console.groupEnd(),e.z.length&&e.z.forEach(i=>{tt.last_format=Z[i.f],tt.last_msg=i.m,A(Zt?Z[i.f]:"tear",i.m),Zt++}),Mt+=e.z.length;break;case 2:console.warn("cache EOL chunks:%o count:%o",e.n,Mt),e.c!=null&&(tt.capacity=e.c),e.f!=null&&(tt.full=e.f),z.cache!=null&&z.cache();break;default:tt.last_format=Z[e.v],tt.last_msg=e.x,z.msg!=null&&z.msg(),A(Z[e.v],e.x);break}}}function Bi(){Zt=Mt=0}function A(s,e){if(z.output!=null)return z.output(s,e);switch(s){case"normal":console.log("%cRC",N.gray+N.cast,e);break;case"warn":const t="border: 0.25px black solid;";console.log("%cRC",t+N.gold+N.cast+t,e);break;case"error":console.log("%cRC%c %s",N.red+N.cast,"color: red",e);break;case"bold":console.log("%cRC%c %s",N.black+N.cast,"font-weight: bold",e);break}}function Hi(){D.prop.preflight||zi()}function zi(){const s=new CustomEvent("meh"),e="rc.test format:",t={a:r.actionID.indexOf("call"),t:[{i:Ot,v:Z.indexOf("normal"),x:e+"normal"},{i:Ot,v:Z.indexOf("warn"),x:e+"warn"},{i:Ot,v:Z.indexOf("error"),x:e+"error"}]};s.data=JSON.stringify(t),w.parse(s)}function Wi(s){A("normal",s)}function Vi(s){A("warn",s)}function ji(s){A("error",s)}function Ui(s){A("tear",s)}function Xi(s){A("alert",s)}function Gi(s){A("bold",s)}var J={formatID:Z,style:N,tna:qt,prop:tt,upon:z,init:Ni,prime:Hi,reset:Bi,log:Wi,warn:Vi,error:ji,tear:Ui,alert:Xi,bold:Gi};const qi=1,Zi=2;class Ji extends Q{constructor(){super("tron","object");a(this,"_enable",!0);a(this,"state",!1);a(this,"STAGE",Object.freeze({BEGIN:1,END:0}));a(this,"holdTime");a(this,"delayTime");a(this,"showTimeout");a(this,"hideTimeout");a(this,"onWrite");this.setHold().setDelay()}assign(t){const i=window[t];return i==null?console.warn("tron assign FAIL: %o",t):(i.classList.add("tna_Tron"),this.div=i,this)}enable(t=!0){if(this.div!=null&&t!=this._enable)return this.div.classList.toggle("disable",!t),this._enable=t,this}async write(t,i=this.holdTime){this.div!=null&&(clearTimeout(this.hideTimeout),this.div.innerText=t,this.div.classList.add("show","prime"),this.state=!0,this.hideTimeout=setTimeout(this.writeEnd.bind(this),i*1e3),this.onPrime!=null&&this.onWrite(this,STAGE.BEGIN))}async writeEnd(){this.state=!1,this.hideTimeout=void 0,this.div.classList.remove("show"),this.div.ontransitionend=()=>{this.div.classList.remove("prime"),this.onPrime!=null&&this.onWrite(this,STAGE.END),this.div.ontransitionend=void 0}}writeDelay(t,i=this.holdTime,n=this.delayTime){this.div!=null&&(clearTimeout(this.showTimeout),this.state?(this.div.innerText=t,this.write(t,i)):this.showTimeout=setTimeout(this.write.bind(this),n*1e3,t,i))}cancel(){clearTimeout(this.showTimeout)}kill(){this.cancel(),this.writeEnd()}add(t){return t.onTron=i=>this.write(i),this}setHold(t=qi){return this.holdTime=t,this}setDelay(t=Zi){return this.delayTime=t,this}}var lt=new Ji;class Yi extends gt{constructor(){r.prefID.indexOf("ux_index")<0&&console.warn("tna_UX constructor FAIL, cannot find prefID");super("ux_index","object");a(this,"_lastIndex");a(this,"_lastDialog");a(this,"_nextDialog");a(this,"_currentDialog");this.link("pref")}set(t){const i=t.v;if(this._lastIndex!=i&&(this._nextDialog=r.getDialogByIndex(i),this._lastDialog=r.getDialogByIndex(this._lastIndex),this._nextDialog!=null)){this.tron&&this._lastDialog!=null&&`${this._lastDialog.id}`,this._lastDialog!=null&&this.last.exit(),this._nextDialog.begin(),this._lastIndex=this._val=i,this._currentDialog=this._nextDialog,super.set(t);return}}get last(){return this._lastDialog!=null?this._lastDialog:{id:"NULL"}}get lastID(){return this._lastDialog!=null?this._lastDialog.id:void 0}get next(){return this._nextDialog}get current(){return this._currentDialog}get currentID(){return this._currentDialog!=null?this._currentDialog.id:void 0}}const Ki='<div id="region" class="region"></div>',Qi=`
    <svg id="svg" viewBox="0 0 12 13.8" class="digit">
      <g id="a" class="seg">
        <polygon points="9.76 0 10.03 0.31 8.66 1.5 4.33 1.5 3.31 0.34 3.7 0 9.76 0"/>
      </g>
      <g id="b" class="seg">
        <polygon points="10.63 1 9.96 5.77 9.07 6.55 8.44 5.82 8.99 1.88 10.36 0.69 10.63 1"/>
      </g>
      <g id="c" class="seg">
        <polygon points="7.57 11.97 8.13 8.03 9.02 7.25 9.65 7.98 8.97 12.8 8.58 13.14 7.57 11.97"/>
      </g>
      <g id="d" class="seg">
        <polygon points="2.86 12.3 7.19 12.3 8.21 13.46 7.82 13.8 1.76 13.8 1.49 13.49 2.86 12.3"/>
      </g>
      <g id="e" class="seg">
        <polygon points="0.89 12.8 1.56 8.03 2.45 7.25 3.08 7.98 2.53 11.92 1.16 13.11 0.89 12.8"/>
      </g>
      <g id="f" class="seg">
        <polygon points="2.5 6.55 1.87 5.82 2.55 1 2.94 0.66 3.95 1.83 3.39 5.77 2.5 6.55"/>
      </g>
      <g id="g" class="seg">
        <polygon points="8.06 6.15 8.69 6.88 7.8 7.65 3.46 7.65 2.83 6.92 3.72 6.15 8.06 6.15"/>
      </g>
      <g id="dp" class="seg"><circle cx="10.77" cy="13.05" r="0.75" /></g>
    </svg>`,ts=`<svg id="svg" viewBox="0 0 12.47 13.8" class="colon">
    <g class="seg" transform="translate(0.2 0)">
      <circle cx="1.72" cy="3.45" r="0.75" />
      <circle cx="0.75" cy="10.35" r="0.75" />
    </g>
  </svg>`;var Vt={HTML:Ki,DIGIT:Qi,COLON:ts};class es extends gt{constructor(t){super(t);a(this,"_primeD",!1);a(this,"_primeN",0);a(this,"_bright",0);a(this,"digits",[]);a(this,"onPrime");this.fuse(),this.link("info"),this.div.insertAdjacentHTML("beforeend",Vt.HTML),this.div.classList.add("tna_Retro7"),this.dRegion=this.getDiv("region");for(let n=0;n<4;n++){this.dRegion.insertAdjacentHTML("beforeend",Vt.DIGIT);const o=this.dRegion.querySelector("#svg");o.id=`svg_${this.digits.length}_${this.id}`,o.style.setProperty("--retro-i",n),this.digits.push(o)}this.dRegion.insertAdjacentHTML("beforeend",Vt.COLON);const i=this.dRegion.querySelector("#svg");i.id=`colon_${this.id}`,this.divColon=i.children[0]}print(t){for(let i=0;i<4;i++)this.digitRaw(i,t[i])}digitRaw(t,i){let n=this.digits[t].children;for(let o=0;o<8;o++){const h=i>>o&1;n[o].classList.toggle("show",h)}}colon(t=2){this.divColon.classList.toggle("show",t==2)}clear(){this.print([0,0,0,0]),this.colon(!1),this.onChange!=null&&this.onChange(this,this._val)}async reset(){this._primeD=!1,this._primeN=0,this.view(!1),await this.delay(500),this.clear(),this.prime(!1)}async set(t){if(this._val=t.v,!this._primeD&&(this.onBegin!=null?this.onBegin(this):this.show(),this._primeN<2)){let i=0;for(let n=0;n<t.v.length;n++)i+=t.v[n];i>0&&this._primeN++,this._primeN=Math.min(this._primeN,2),this._primeN>1&&this.onPrime!=null&&this.onPrime(this)}this.print(t.v),this.colon(t.v[4]),this.onChange!=null&&this.onChange(this,t)}bright(t=0){return this._bright=t,this.div.classList.toggle("dim",t==0),this}}const De="3.1.05",Te={}.VITE_PREFLIGHT==="true",is={}.VITE_EXT_SERVE==="true";Te||console.warn("core PREFLIGHT: %o",!1);const L={},S={preflight:Te,modeExt:is,modeAP:!1,prime_local:!1},W={},kt={},ot={},X={};let St,$e,C,O,Rt,M,Jt=!1;function ss(){lt.assign("tron_output"),rs(),as(),L.title=C=new Q("head_title"),C.div.classList.add("click"),C.div.onclick=()=>{let e=kt.title!=null?kt.title():!1;e=e==null?!1:e,e||console.log("core title click default")},C.fuse().shy(!(S.modeExt||!Rt)).view(),ns(),window.diag_client.innerText=$.versionString(De);const s=String(document.location);S.local=s.includes("host:")||s.includes("local:"),St=new H("developFPO","object"),St.onDefault=()=>S.prime_local=!0,$.initStorage("develop",St),S.develop=St.value,L.ux=$e=new Yi().tron(),j.init()}function ns(){window.socket!=null&&(M=new Y("socket").prime().show().enable(),M.symbol("x").symbol("o"),M.value=!0,M.index=1,M.onExecute=s=>{s.toggle(),s.index=s.value,w.monitor(s.value),s.value?w.init():w.kill()},L.socket_button=M)}function as(){S.modeExt||(Rt=window.info_display!=null,Rt&&(L.retro=O=new es("info_display"),O.ext_no_prime=!0,O.ext_view=void 0,O.onBegin=s=>{},O.onRender=(s,e)=>{const t=e!=null?e:s._view;s.ext_view!=t&&(s.ext_view=t,s.div.classList.toggle("click",t),s._view&&s.shy(!1))},O.div.onclick=os))}function os(){let s=kt.retro!=null?kt.retro():!1;s=s==null?!1:s,s||(console.log("RD click default, ux:",$e.currentID),w.send("save","clock_disp",-1))}function rs(){if(window.rc_ind==null||S.user==0)return;const s=new H("info_rc","object");J.upon.msg=(e=J.prop.last_format)=>{const t=S.user!=null?S.user:0;L.rc_ind.view(e!=J.formatID.indexOf("touch")&&t)},s.onChange=(e,t)=>{J.upon.msg(t.v)},L.rc_ind=new q("rc_ind").symbol("dot").def(),L.rc_ind.onExecute=async e=>{e.choreo("blink","hot").timing(3,150).act(),e.onAnimEnd=()=>j.hyper("/rc/")}}let re=!1;async function ie(){for(const[s,e]of Object.entries(L))e.ext_no_prime==null&&e.prime();if(Rt)C.shy(!1);else return ie=!0;re||await $.delay(1250),C.view(!1),C.div.classList.add("slide"),window.head.classList.add("gradient"),L.retro.prime(),L.retro.shy(!1),await $.delay(250),L.retro.view(),C.shy(),C.div.classList.remove("slide"),re=!0,Pe()}function Se(){Jt=!1,j.tna.badge.div.classList.add("connect","prime"),j.tna.dot.viewStaged(!1),M!=null&&(M.index=1),W.open!=null&&W.open()}async function Yt(){Jt||(Jt=!0,j.tna.badge.div.classList.add("prime"),j.tna.badge.div.classList.remove("connect"),j.tna.dot.view(!0),window.head.classList.remove("gradient"),await $.delay(250),O!=null&&O.reset(),M!=null&&M.def(),W.close!=null&&W.close(),C.shy(!1),await $.delay(250),C.view())}function ds(){w.onOpen(Se),w.onClose(Yt),new H("info_install","object").onChange=(t,i)=>{t.ext_prime==null&&(ot.display=(i.v&r.hwMask.display)>>r.hwOffset.display,ot.piezo=(i.v&r.hwMask.piezo)>>r.hwOffset.piezo,ot.xpio=(i.v&r.hwMask.xpio)>>r.hwOffset.xpio,ot.gps=(i.v&r.hwMask.gps)>>r.hwOffset.gps,i.z,X.display=(i.z&r.hwMask.display)>>r.hwOffset.display,X.piezo=(i.z&r.hwMask.piezo)>>r.hwOffset.piezo,X.xpio=(i.z&r.hwMask.xpio)>>r.hwOffset.xpio,X.gps=(i.z&r.hwMask.gps)>>r.hwOffset.gps,Object.keys(X).forEach(function(n,o){X[n]||document.querySelectorAll("._"+n).forEach(c=>c.style.display="none")}))},new H("call_prime","object","call").onChange=t=>{ie(),t.ext_prime==null&&(W.prime!=null&&W.prime(ot,X),t.ext_prime=!0)},L.user=new H("info_user","object"),L.user.onChange=t=>{S.user=t.data.v,j.access(S.user),W.user!=null&&W.user(t.data)};let s=new H("call_restart","object","call");s.onChange=async t=>{J.bold("system ESP restart"),Yt(),await t.delay(1e3),w.send("ping")};let e=new H("call_warn","object","call");if(e.onChange=(t,i)=>{let n=parseInt(i.v);n=n<r.warnID.length?n:-1;let o;n>=0&&(o=r.warnID[n]),o!=null&&console.error(`system warning ${o}`)},O!=null&&r.getControlByID("ui_bright")==null){const t=new H("ui_bright","object","pref");t.onChange=(i,n)=>O.bright(n.v),L[t.id]=t}}function Pe(s=S.user){let e=document.querySelectorAll("._admin");e.forEach(t=>t.style.display=s?"":"none"),e=document.querySelectorAll("._admin_alt"),e.forEach(t=>t.style.display=s?"none":"inherit")}var D={tna:L,prop:S,upon:W,click:kt,version:De,install:ot,activate:X,init:ss,prime:ie,open:Se,close:Yt,patch:ds,admin:Pe};let Ft=!1,nt=!1,Ce=!1,it,Oe,Kt,Qt;const ls=`ws://${window.location.hostname}/ws`;let V,Lt=!1;function se(){Ft||(Ft=!0,V=new WebSocket(ls),V.onopen=cs,V.onclose=fs,V.onmessage=Oe,nt=!1,it=clearTimeout(it))}function hs(s){s!=Lt&&(console.log(`socket monitor b:${s} state:${nt}`),Lt=s,s&&(!nt&&it==null?se():it=clearTimeout(it)))}function Me(){return nt=(V!=null?V.readyState:de.closed)==de.connected,nt}function cs(){console.warn("socket open"),nt=!0,Kt!=null&&Kt()}function fs(){console.error(`socket close, squelch:${Ce} check:${Lt}`),Ft=!1,nt=!1,Qt!=null&&Qt(),Lt&&(clearInterval(it),it=setTimeout(se,1e3))}function us(){console.warn("socket kill"),V&&V.close(),Ce=!0,Ft=!1}function Ae(s){Oe=s}function ps(s){Kt=s}function gs(s){Qt=s}const de=Object.freeze({connecting:0,connected:1,closing:2,closed:3});let R=!1;var w={onOpen:ps,onClose:gs,onParse:Ae,check:Lt,init:se,ready:Me,monitor:hs,kill:us,parse:Nt,sendUX:xs,sendTune:bs,sendObject:Re,send:Fe,fakeMessage:Ls,fakeObject:ks,transmit:Dt,fill:Es,tron:vs};Ae(Nt);function vs(s=!0){R=s}function ms(s){let e;for(let t in s)e=r.getControlByIndex("info",s[t].i),e!=null?(s.length>1&&(R?console.log(`<< info #${t} %o ${s[t].v}`,e.id):e.id!="info_display"&&R&&console.log(`<< info %o ${s[t].v}`,e.id)),e.set(s[t])):R&&console.log(`parseInfo #${t} no object id %o`,r.infoID[s[t].i])}function _s(s){for(let e in s){const t=s[e].i,i=r.getControlByIndex(t<r.prefBase?"admin":"pref",t);i!=null?(R&&(s.length>1?console.log(`<< pref #${e} ${i.id} ${s[e].v}`):console.log(`<< pref ${i.id} ${s[e].v}`)),i.sync(s[e])):R&&console.log(`parseSync #${e} no object id %o`,t)}}function ws(s){for(let e in s){const t=r.getControlByIndex("call",s[e].i);t!=null&&t.set(s[e])}}function ys(s){for(let e in s){const t=s[e],i=r.getControlByIndex("ux",t.i);if(i!=null){if(t.s<0)return console.warn("parseUX FAIL bad stage value %o",r.stageID[t.v]);i.parse(t)}else R&&console.log("parsUX no object %o",r.infoID[t.i])}}function Nt(s){let e=JSON.parse(s.data),t=r.actionID[e.a],i=e.t;switch(t){case"call":ws(i);break;case"ux":ys(i);break;case"info":ms(i);break;case"sync":_s(i);break}}function xs(s,e,t){const i="ux",n=r.uxID.indexOf(s);if(n<0)return console.warn("sendUX FAIL no dialog %o",s);const o={i:n},h=r.stageID.indexOf(e);h>=0&&(o.v=h),t!=null&&(o.x=t);const c={a:r.actionID.indexOf(i),t:[o]};Dt(c,`${i} >>`)}function bs(s="default"){const e="call",t=r.tuneID.indexOf(s);if(t<0)return console.warn("sendTune FAIL no melody %o",s);r.callID.indexOf("call_tune");const i={a:r.actionID.indexOf(e),t:[{i:r.callID.indexOf("call_tune"),v:t}]};Dt(i,`${e} >>`)}function Re(s,e,t){const i=r.actionID.indexOf(s);if(i<0)return console.log("sendObject FAIL no action %o",s);let n={a:i,t:[]},o={i:r.getPrefID(e)};return Object.assign(o,t),n.t.push(o),Dt(n,`${s} >>`),n}function ks(s,e,t){const i=Re(s,e,t);if(typeof i=="object"){const n=new CustomEvent("meh");n.data=JSON.stringify(i),Nt(n)}}function Fe(s,e,t){let i=r.actionID.indexOf(s);if(i<0){R&&console.log("send FAIL no action %o",s);return}let n={a:i,t:[]},o=-1;switch(s){case"push":case"save":case"sync":o=r.getPrefID(e);break;case"call":o=r.callID.indexOf(e);break;case"ping":o=t=0}if(o<0){R&&console.log("send FAIL no id %o in action %o",e,s);return}return n.t.push({i:o,v:t|0}),Dt(n,`${s} >>`),n}function Ls(s,e,t){const i=Fe(s,e,t);if(typeof i=="object"){const n=new CustomEvent("meh");n.data=JSON.stringify(i),Nt(n)}}function Dt(s,e){const t=JSON.stringify(s);R&&console.log(`${e} ${t}`),Me()&&V.send(t)}async function Es(s,e,t){let i={};if(D.prop.preflight)try{const n=await fetch(e,{method:"GET"});if(n.status===200)i=await n.json();else throw new Error(`${e} FAIL fetch code:${n.status}`)}catch(n){console.warn(`${e} FAIL, use test data`,n),Object.assign(i,t)}else console.warn(`${e} !preflight, use test data`),Object.assign(i,t);console.groupCollapsed(`comm fill ${e}`),console.log(i),console.groupEnd(),Object.assign(s,i)}const At=Math.floor(new Date().getTime()/1e3);r.actionID.indexOf("info"),r.infoID.indexOf("info_hardware"),r.infoID.indexOf("info_mfg"),r.infoID.indexOf("info_reg");const Is={a:r.actionID.indexOf("info"),t:[{i:r.infoID.indexOf("info_rc"),v:4},{i:r.infoID.indexOf("info_install"),v:r.hwMask.display+r.hwMask.piezo+r.hwMask.xpio+r.hwMask.gps+0,z:r.hwMask.display+r.hwMask.piezo+r.hwMask.xpio+r.hwMask.gps+0},{i:r.infoID.indexOf("info_user"),v:1},{i:r.infoID.indexOf("info_firmware"),v:"8.8.88"},{i:r.infoID.indexOf("info_uptime"),v:At-3600*24*99},{i:r.infoID.indexOf("info_net"),v:"expresso",p:"8C:CE:4E:D5:36:9D",q:"192.168.2.100"},{i:r.infoID.indexOf("info_rssi"),v:"-78"},{i:r.infoID.indexOf("info_status"),v:r.serviceID.indexOf("GPS"),g:1,n:1},{i:r.infoID.indexOf("info_tap"),v:4,m:884,c:4},{i:r.infoID.indexOf("info_gps"),t:At,d:1200,v:13,max:12,min:12,rec:22},{i:r.infoID.indexOf("info_ntp"),v:0,s:At,f:28,p:64,e:0,r:60*30},{i:r.infoID.indexOf("info_display"),v:[0,0,0,0,0]}]},Ds={a:r.actionID.indexOf("sync"),t:[{i:r.getPrefID("net_alert"),v:1},{i:r.getPrefID("ui_bright"),v:0,x:5},{i:r.getPrefID("ui_sound"),v:1},{i:r.getPrefID("tap_mode"),v:0},{i:r.getPrefID("tap_tilt"),v:1},{i:r.getPrefID("tap_alert"),v:0},{i:r.getPrefID("tap"),v:7,t:1023},{i:r.getPrefID("gps_alert"),v:0},{i:r.getPrefID("gps_log_int"),v:1200},{i:r.getPrefID("clock_static"),v:1},{i:r.getPrefID("clock_disp"),v:r.clockID.indexOf("CLOCK_HHMM")},{i:r.getPrefID("clock_24h"),v:0},{i:r.getPrefID("clock_tz"),v:-6},{i:r.getPrefID("clock_dst"),v:1},{i:r.getPrefID("clock_pps"),v:0},{i:r.getPrefID("daily"),v:1,h:9,m:32},{i:r.getPrefID("daily_vol"),v:1},{i:r.getPrefID("daily_ind"),v:1},{i:r.getPrefID("daily_snooze"),v:1},{i:r.getPrefID("ux_index"),v:r.uxID.indexOf("clock_static")}]};r.infoID.indexOf("info_gps_log"),At-200;const Ts={a:r.actionID.indexOf("info"),t:[{i:r.infoID.indexOf("info_display"),v:[127,127,127,127,2]}]},$s={a:r.actionID.indexOf("info"),t:[{i:r.infoID.indexOf("info_display"),v:[120,121,109,120,0]}]},Ss={a:r.actionID.indexOf("call"),t:[{i:r.callID.indexOf("call_prime"),v:0}]};function Ps(){const s=D.prop.local?500:75;setTimeout(async()=>{if(w.ready())return;D.open(),console.log("%ccomm test",J.style.test,"info + sync");const e=new CustomEvent("meh");e.data=JSON.stringify(Is),w.parse(e),e.data=JSON.stringify(Ds),w.parse(e),await $.delay(75),e.data=JSON.stringify(Ss),w.parse(e)},s),setTimeout(()=>{if(w.ready())return;console.log("%ccomm test",J.style.test,"display");const e=new CustomEvent("meh");e.data=JSON.stringify(Ts),w.parse(e)},s*2),setTimeout(()=>{if(w.ready())return;const e=new CustomEvent("meh");e.data=JSON.stringify($s),w.parse(e)},s*3)}var Cs={init:Ps};let yt;function Os(){document.body.insertAdjacentHTML("beforeend",'<svg height="0" width="0" style="visibility: hidden"></svg>'),yt=document.body.lastChild}function Ms(s,e){yt.insertAdjacentHTML("beforeend",'<symbol id="" viewBox="0 0 100 100"></symbol>'),yt.lastChild.id="sym_"+s,yt.lastChild.innerHTML=e}function As(s){yt.insertAdjacentHTML("beforeend",s)}Os();var g={add:Ms,def:As};function Rs(){g.add("warn_ui",`<g stroke-width="12" stroke-linecap="round" stroke-linejoin="round" >  
      <polygon stroke="var(--icon-fg)" fill="var(--icon-fg)" points="50 12.69 7.5 86.31 92.5 86.31 50 12.69" />
      <g>
        <polyline stroke="var(--icon-bg)" fill="none" points="50 55 50 32" />
        <circle fill="var(--icon-bg)" stroke="none" cx="50" cy="78" r="7" />
      </g>    
    </g>`),g.add("warn_text",`<g stroke="var(--icon-fg)" fill="none">
      <path stroke-width="6px" stroke-linejoin="round" d="M66,91.39H90.59A6.2,6.2,0,0,0,96,82.08L55.37,11.78a6.2,6.2,0,0,0-10.74,0L4,82.08a6.2,6.2,0,0,0,5.37,9.31H34" />    
      <polyline stroke-width="14px" points="50 73 50 55.5 50 38" />
      <polyline stroke-width="14px" points="50 94.5 50 80.5" />
    </g>`),g.add("hit",`<defs>
      <radialGradient id="grad">
        <stop offset="0%" stop-color="rgb(0,0,0,1)" />
        <stop offset="33%" stop-color="rgb(0,0,0,0.3)" />
        <stop offset="90%" stop-color="transparent" />
      </radialGradient>
    </defs>
    <g transform="translate(50 50)">
      <circle fill="url('#grad')" stroke-width="4px" stroke="var(--icon-bg)" cx="0" cy="0" r="48" />
    </g>`),g.add("halo",`<g transform="translate(50 50)">
      <circle fill="none" stroke-width="4px" stroke="var(--icon-fg)" cx="0" cy="0" r="48" />
    </g>`),g.add("show",`<g fill="var(--icon-fg)">
      <path d="M100,50C89.32,65.16,69,78,50,78S10.68,65.16,0,50C10.68,34.84,31,22,50,22S89.32,34.84,100,50ZM50,31A19,19,0,1,0,69,50,19,19,0,0,0,50,31Zm0,9A10,10,0,1,0,60,50,10,10,0,0,0,50,40Z" />
    </g>`),g.add("hide",`<g fill="var(--icon-fg)" stroke="none">
      <path d="M100,50C89.32,65.16,69,78,50,78S10.68,65.16,0,50C10.68,34.84,31,22,50,22S89.32,34.84,100,50ZM89.82,50C79.39,38.17,63.45,30,50,30S20.62,38.17,10.19,50C20.62,61.83,36.55,70,50,70S79.39,61.83,89.82,50Z" />
      <circle cx="50" cy="50" r="14" />
    </g>
    <g stroke-linecap="butt" transform="translate(50 50) rotate(45)">
      <line stroke="var(--icon-bg)" stroke-width="16" x1="-40" y1="0" x2="40" y2="0" />
      <line stroke="var(--icon-fav)" stroke-width="5" x1="-50" y1="0" x2="50" y2="0" />
    </g>`),g.add("wifi_def",`<g fill="none">
      <circle stroke="var(--icon-fg)" stroke-width="16" cx="0" cy="0" r="8"></circle>
      <circle stroke="var(--icon-fg)" stroke-width="8" cx="0" cy="0" r="32"></circle>
      <circle stroke="var(--icon-fg)" stroke-width="8" cx="0" cy="0" r="52"></circle>
   </g>`),g.add("wifi",`<g transform="translate(50, 84) rotate(-135) scale(1.25)">
      <use href="#sym_wifi_def" />
    </g>`),g.add("info",`<g stroke="var(--icon-fg)" fill="none">
      <circle stroke-width="5" cx="50" cy="50" r="47.5"></circle>
      <g stroke-width="16" transform="translate(11) skewX(-12)">
        <line x1="50" y1="82" x2="50" y2="44" />
        <line x1="50" y1="34" x2="50" y2="18" />
      </g>
    </g>`),g.add("help",`<g transform="translate(50 50)" stroke="none">
      <path d="M8.6,33.2H-8.6V23.6H8.6Zm12-60.4H-20.6c-5,0-10.3,3.6-10.3,8.3v8.8h16.5v-10H14.4v18H.7c-5.6,0-9.3,3.5-9.3,9.4v9.1H8.6V7.9c0-2.7,1-3.3,3.7-3.3h8.3C25.2,4.6,30.9.8,30.9-4V-18.9C30.9-23.6,25.6-27.2,20.6-27.2Z" /> 
    </g>`),g.add("help_button",`<g>
      <use href="#sym_halo" />
      <use href="#sym_help" />
    </g>`),g.add("tap",`<g>
      <polygon fill="var(--icon-fg)" stroke="none" points="86.76 0 66.96 0 49.87 17.09 32.84 0 13.08 0 49.85 36.91 86.76 0" />
      <g stroke="var(--icon-fg)">
        <line stroke-width="14px" y1="50" x2="100" y2="50" />
        <g stroke-width="10px" >
          <line class="cls-3" x1="50" y1="100" x2="50" y2="77" />
          <line class="cls-3" x1="14.64" y1="85.36" x2="30.91" y2="69.09" />
          <line class="cls-3" x1="85.36" y1="85.36" x2="69.09" y2="69.09" />
        </g>
      </g>
    </g>`),g.add("twirl",`<g fill="var(--icon-fg)" stroke="none">
    <polygon points="0,88 100,88 50,0"/>
  </g>`),g.add("refresh",`<g stroke="var(--icon-fg)" transform="translate(50 50)" fill="none" style="stroke-miterlimit:10;">
      <polyline points="3.536 52.75 19.036 37.25 34.536 52.75" transform="translate(-49.75 -48)" />
      <path d="M0-31A31,31,0,0,1,31,0,31,31,0,0,1,0,31,31,31,0,0,1-31,0a31.041,31.041,0,0,1,1.206-8.593" />
    </g>`),g.add("refresh_run",`<g stroke="var(--icon-fg)" transform="translate(50 50)" fill="none" style="stroke-miterlimit:10;">
      <path d="M0-31A31,31,0,0,1,31,0,31,31,0,0,1,0,31,31,31,0,0,1-31,0a31.041,31.041,0,0,1,1.206-8.593" />
    </g>`),g.add("undo",`<g transform="scale(-1 1) translate(-100 0)" stroke="var(--icon-fg)" stroke-width="8" fill="none">
      <polyline points="46.21 53.21 30 37 46.21 20.79" />
      <path d="M33,79H60.48a21,21,0,1,0,0-42H30" />
      <line x1="18" y1="18" x2="18" y2="56" />
    </g>`),g.add("dot",`<g transform="translate(50, 50)">
      <circle fill="var(--icon-fg)" cx="0" cy="0" r="50"></circle>
    </g>`),g.add("o",`<g transform="translate(50, 50)">
      <circle stroke="var(--icon-fg)" stroke-width="22" fill="none" cx="0" cy="0" r="39"></circle>
    </g>`),g.add("x",`<g stroke="var(--icon-fg)" stroke-width="22">
        <line x1="12" y1="12" x2="88" y2="88"></line>
        <line x1="12" y1="88" x2="88" y2="12"></line>
    </g>`),g.add("bar_1",`<g transform="translate(0, 0)">
      <line stroke="var(--icon-fg)" stroke-width="22" x1="50" y1="0" x2="50" y2="100"></line>
    </g>`),g.add("bar_2",`<g stroke="var(--icon-fg)" stroke-width="22" transform="translate(0, 0)">
      <line x1="20" y1="0" x2="20" y2="100"></line>
      <line x1="80" y1="0" x2="80" y2="100"></line>
    </g>`),g.add("vol_wave_0",`<g transform="translate(0, 0)">
      <g transform="scale(0.5) translate(100, 50)">
        <use href="#sym_x" />
      </g>
    </g>`),g.add("vol_wave_1",`<g transform="translate(0, 0)">
      <path stroke="var(--icon-fg)" stroke-width="10" fill="none" d="M62.7,31.63a28.5,28.5,0,0,1-.45,36.29"/>
     </g>`),g.add("vol_wave_2",`<g transform="translate(0, 0)">
      <use href="#sym_vol_wave_1" />
      <path stroke="var(--icon-fg)" stroke-width="12" fill="none" d="M80.21,14.44a52.94,52.94,0,0,1-.06,71.07"/>
     </g >`),g.add("lock",`<g>
      <path transform="translate(62 55)" stroke-width="12" stroke="var(--icon-fg)" fill="none" d="M-20,0V-22c0-12.15,8.954-22,20-22H0c11.046,0,20,9.85,20,22V0"/>
      <rect fill="var(--icon-fg)" stroke="none" x="25" y="50" width="75" height="50" />
      </g>`),g.add("unlock",`<g>
      <path transform="translate(25 50)" stroke-width="12" stroke="var(--icon-fg)" fill="none" d="M-20,0V-22c0-12.15,8.954-22,20-22H0c11.046,0,20,9.85,20,22V0"/>
      <rect fill="var(--icon-fg)" stroke="none" x="25" y="50" width="75" height="50" />
    </g>`),g.add("bell",`<g transform="translate(5 10)" stroke-width="10" stroke="var(--icon-fg)" fill="none">
      <g transform="translate(-7 -9.73)">
        <path d="M60.59,74a11,11,0,1,1-21.18,0Z" />
        <path d="M79,73,68.5,33.16C67.31,29,63.94,26,59.7,26H40.63a9.42,9.42,0,0,0-8.8,7.12L21.33,73" />
      </g>
      <line x1="43" y1="19.31" x2="43" />
      <line y1="63.27" x2="86" y2="63.27" />
    </g>`),g.add("tna_hex",`<g stroke="var(--icon-fg)" fill="none">
        <polygon points="88.97 72.5 50 95 11.03 72.5 11.03 27.5 50 5 88.97 27.5 88.97 72.5" />
    </g>`),g.add("tna_n",`<g stroke="var(--icon-fg)" fill="none">
        <polyline stroke-linecap="round" stroke-linejoin="round" points="28.71 61.84 28.71 38.16 71.29 61.84 71.29 38.16" />
    </g>`),g.add("tna",`<g>
      <use href="#sym_tna_hex" />
      <use href="#sym_tna_n" />
    </g>`),g.add("warn_tna",`<g fill="var(--icon-fg)" stroke="none" transform="translate(50, 50)">
      <path d="M-17-25.7l-8.2-14.2,4.7-2.7h41l4.7,2.7L17-25.7l16.5,9.5,8.2-14.2L50-25.6l-24.8,43H9.5v-30h-19v30H-25.2L-50-25.6l8.3-4.8,8.2,14.2Zm22.5,52h-11l-9.4,16.3H14.9Z"/>
    </g>`)}Rs();const Fs=`<div id="region" class="region">
    <div id="bg" class="bg"></div>
    <div id="shadow" class="shadow"></div>
    <form class="flex">
      <input
        id="entry"
        class="field entry"
        type="text"
        autocomplete="new-password"
        autocapitalize="none"
        autocorrect="off"
      />
    </form>
    <div class="flex inert">
      <div id="mirror" class="field mirror"></div>
    </div>
    <div id="label" class="label inert __dmm"></div>
    <div id="warn" class="__dmm"></div>
    <div id="reset" class="__dmm"></div>
    <div id="eye" class="__dmm"></div>
    <div id="erase" class="__dmm"></div>
  </div>`,Ns=`<g fill="var(--icon-fg)">
    <path
      d="M100,50C89.32,65.16,69,78,50,78S10.68,65.16,0,50C10.68,34.84,31,22,50,22S89.32,34.84,100,50ZM50,31A19,19,0,1,0,69,50,19,19,0,0,0,50,31Zm0,9A10,10,0,1,0,60,50,10,10,0,0,0,50,40Z"
    />
  </g>`,Bs=`<g stroke="var(--icon-fg)" stroke-width="12">
    <line x1="12" y1="12" x2="88" y2="88"></line>
    <line x1="12" y1="88" x2="88" y2="12"></line>
  </g>`,Hs=`<g fill="var(--icon-fg)">
    <path d="M100,50A50,50,0,1,1,50,0,50,50,0,0,1,100,50ZM87.5,41h-75V59h75Z" />
  </g>`,zs=`<g stroke-width="12" stroke-linejoin="round" stroke-linecap="round">
    <polygon
      stroke="var(--icon-fg)"
      fill="var(--icon-fg)"
      points="50 12.69 7.5 86.31 92.5 86.31 50 12.69"
    />
    <g>
      <polyline stroke="var(--icon-bg)" fill="none" points="50 55 50 32" />
      <circle fill="var(--icon-bg)" stroke="none" cx="50" cy="76" r="7" />
    </g>
  </g>`;var _t={html:Fs,eye:Ns,erase:Bs,reset:Hs,warn:zs};class jt extends gt{constructor(t,i="pref"){super(t);a(this,"_type","text");a(this,"_suffix");a(this,"_regexChars");a(this,"_regexFormat");a(this,"_min",0);a(this,"_max",64);a(this,"_fill","");a(this,"_preLen",-1);a(this,"_censor",!1);a(this,"_bullet",!1);a(this,"_focus",!1);a(this,"_hold",!1);a(this,"icon");a(this,"edit",!1);a(this,"valid",!1);a(this,"error");a(this,"validFormat",!1);a(this,"validChars",!0);a(this,"validLength",!1);a(this,"labelAbbr");a(this,"onValidate");a(this,"onFocus");a(this,"onBlur");a(this,"onErase");a(this,"onReset");a(this,"onError");this.link(i);const n="tna_Field";this.div.insertAdjacentHTML("beforeend",_t.html),this.div.classList.add(n),this.getDiv("region"),this.dEntry=this.getDiv("entry"),this.dMirror=this.getDiv("mirror"),this.dBg=this.getDiv("bg"),this.getDiv("shadow"),this.dLabel=this.getDiv("label"),this.dErase=this.getDiv("erase"),this.dErase.classList.add(n+"_erase"),this.dErase.addEventListener("mousedown",this.erase.bind(this)),this.iErase=new q(this.dErase),this.iErase.addCenter=_t.erase,this.iErase.scaleCenter(.7).def(),this.dEye=this.getDiv("eye"),this.dEye.classList.add(n+"_eye"),this.iEye=new q(this.dEye),this.iEye.addCenter=_t.eye,this.iEye.scaleCenter(.85).def(),this.iEye.onExecute=this.eye.bind(this),this.dUndo=this.getDiv("reset"),this.dUndo.classList.add(n+"_reset"),this.iUndo=new q(this.dUndo),this.iUndo.addCenter=_t.reset,this.iUndo.scaleCenter(.8).def(),this.iUndo.onExecute=this.reset.bind(this),this.dWarn=this.getDiv("warn"),this.dWarn.classList.add(n+"_warn"),this.iWarn=new q(this.dWarn),this.iWarn.addCenter=_t.warn,this.iWarn.scaleCenter(.85).def(),this.iWarn.onExecute=this.clean.bind(this),this.iWarn.onShow=o=>o.choreo("blink").timing(3,140,500).act(),this.icons={erase:this.iErase,undo:this.iUndo,eye:this.iEye,warn:this.iWarn},this.dLabel.innerText=this.getDataAttr("label","string",""),this.value=this.div.dataset.value==null?"":this.div.dataset.value,this.type(this.getDataAttr("type","string","")),this._suffix=this.getDataAttr("suffix","string",""),this.preset(this.value,this.div.dataset.valueLength),this.div.dataset.prime!=null&&this.prime(),this.dEntry.oninput=this.input.bind(this),this.dEntry.onkeypress=this.key.bind(this),this.dEntry.onfocus=this.focus.bind(this),this.dEntry.onblur=this.blur.bind(this)}setIcon(t="none"){const i=this.icons[t];if(i!=this.icon)return this.icon!=null&&(this.icon.enable(!1),this.icon.view(!1)),i!=null&&(i.enable(),i.view(),i.div.style.zIndex=0),this.icon=i,i}preset(t,i,n){return this._fill=t!=null?t:this.dEntry.value,this._preLen=i==null?this._fill.length:i,this.dEntry.value=this._fill,n==null&&this.input(),this.edit=!1,this}set(t){return this.dEntry.value=t,this.input(),this.edit=!1,this}censor(t=!0){return t?(this.type("password"),this._bullet=!0,this.dEntry.value="xxxxxxxx",this.valid=!0,this.dLabel.classList.add("stick"),this.div.classList.remove("warn"),this):this}input(t=!0){this.error=void 0;const i=this.dEntry.value;this.dMirror.innerHTML=this.checkFormat(i),this._val=i.replace(/^\s+|\s+$/g,""),this.checkLength(this._val),this.edit=i!=this._fill||i.length!=this._preLen,this.valid=this.validChars&&this.validLength&&this.validFormat,this.div.classList.toggle("warn",!this.valid),this.div.classList.toggle("valid",this.valid),this.dLabel.classList.toggle("stick",i.length>0);let n=!this.valid||this._suffix.length>0;this.dMirror.classList.toggle("show",n);let o=!1,h;this._type!="password"?(this.valid&&!this.edit&&this._focus&&i.length!=0&&(h="erase",o=!0),o||(this.validChars&&this.validFormat?this.edit&&(h="undo"):this._censor||(h="warn"))):i.length!=0&&(h="eye"),this.setIcon(h),t&&this.onValidate!=null&&this.onValidate(this)}focus(){this._focus=!0,this.div.classList.add("focus"),this.dEntry.classList.add("show"),this._bullet&&(this._bullet=!1,this.dEntry.value="",this.dLabel.classList.remove("stick"));let t=this.valid&&this._type!="password"&&!this.edit;t=t&&this.dEntry.value.length!=0,t&&this.setIcon("erase"),this.onFocus!=null&&this.onFocus(this)}async blur(){if(this._focus=!1,this.div.classList.remove("focus"),this._censor&&this.dEntry.value.length==0&&this._preLen>0&&(this._bullet=!0,this.dLabel.classList.add("stick"),await this.delay(250),this.type("password"),this.dEntry.value="xxxxxxxx"),this._hold){this._hold=!1;return}this.icon==this.iErase&&this.setIcon(),this.onBlur!=null&&this.onBlur(this)}commit(){this.setIcon(),this.dEntry.blur()}async erase(t){t!=null&&(t.preventDefault(),t.stopImmediatePropagation()),this.dEntry.value="",this.onValidate!=null&&this.onValidate(this),this.onErase!=null&&this.onErase(this),await this.delay(100),this.input(),this.focus(),this.dEntry.focus(),this.setIcon("undo")}eye(){this.type("text"),this._hold=!0,this.dEntry.focus(),this.input(),this._hold=!0}async reset(){return this.onValidate!=null&&this.onValidate(this),this.iUndo.choreo("spin_out").timing(1,750).act(),this.error="reset",this.onError!=null&&this.onError(this),this.onReset!=null&&this.onReset(this),this._censor?this._preLen>0?(this._bullet=!0,await this.delay(500),this.dEntry.value="",this.dLabel.classList.add("stick"),await this.delay(250),this.type("password"),this.dEntry.value="xxxxxxxx"):(await this.delay(250),this.dLabel.classList.remove("stick"),this.dEntry.value=""):(this.dEntry.value.length==0&&this.dLabel.classList.toggle("stick",this._fill.length>0),this.dEntry.value="",this.dMirror.classList.remove("show"),this.dEntry.classList.remove("show"),await this.delay(250),this.dEntry.value=this._fill,await this.delay(500)),this.div.classList.remove("focus"),this.input(),this}async clean(){let t="",i=[];const n=this._val;if(this._regexChars!=null){const h=new RegExp(this._regexChars,"g");let c;for(;(c=h.exec(n))!==null;)i.push(c)}this.validFormat||(i.length?i[0].index!=0&&i.unshift({index:0}):i.push({index:0}));let o=0;for(let h=0;h<i.length;h++)t+=n.slice(o,i[h].index),o=i[h].index+1;t+=n.slice(o,n.length),this._val=this.dMirror.innerHTML=this.dEntry.value=t,this.input(),this._hold=!0,this.dEntry.focus()}checkFormat(t){const i="\u02FD",n=t.match(/^(\s*)/)[1].length;let o=i.repeat(n);t=t.replace(/^\s+/g,"");let h=[];if(this._regexFormat!=null){const l=new RegExp(this._regexFormat);this.validFormat=l.test(t)}else this.validFormat=!0;if(this._regexChars!=null){const l=new RegExp(this._regexChars,"g");let v;for(;(v=l.exec(t))!==null;)h.push(v)}this.validFormat||(h.length&&h[0].index!=0&&h.unshift({index:0}),this.error="format");let c=0,p=0;for(let l=0;l<h.length;l++){o+=t.slice(c,h[l].index).split(" ").join(i);const v=t.slice(h[l].index,h[l].index+1).split(" ").join(i);o+="<span class='highlight'>"+v+"</span>",c=h[l].index+1,p++}return o+=t.slice(c,t.length).split(" ").join(i),h.length==0&&(o=t),o+="<span class='_suffix'>"+this._suffix+"</span>",this.validChars=!(h.length>0),p>0&&this.validFormat&&(this.error="char"),o}checkLength(t){const i=new RegExp(`^.{${this._min},${this._max}}$`);this.validLength=i.test(t),!this.validLength&&this.validChars&&this.validFormat&&(this.error="length")}key(t){t.key=="Enter"&&(this.blur(),this.dEntry.blur(),t.preventDefault())}validSize(t,i){return this._min=t,this._max=i,this}regexChar(t){return this._regexChars=t,this}regexFormat(t){return this._regexFormat=t,this}get length(){return this.dEntry.value.length}type(t){return this._type=t,this._censor=t=="password",this.dEntry.setAttribute("type",t),this}label(t){return this.dLabel.innerText=t,this}}const Ws=`<g class="shape" transform="translate(-50 -50)">
    <polyline points="25,100 75,50 25,0" />
  </g>`;class te extends Y{constructor(t){super(t);a(this,"_duration");a(this,"_count",0);this.div.classList.add("tna_Tread"),this.duration=this.getPropVal("--tread-t"),this.count=this.getPropVal("--tread-n"),this.getProp("--tread-fade").indexOf("in")>=0&&this.div.classList.add("fadeIn"),this.value=0}set count(t){this.clear();for(let i=0;i<t;i++){this.add=Ws;const n=this.list[this.list.length-1],o=-(i/t)*this._duration;n.style.animationDelay=o+"s",n._tna_id=i,n.onanimationiteration=this.iterate.bind(this)}this.translate(50,50),this.scale(.88),this.update()}set duration(t){this._duration=t,this.div.style.setProperty("--tread-t",t+"s")}show(t=!1){this._val=!0,t&&(this.dWrap.onanimationend=void 0,this.div.classList.remove("hide")),this.div.classList.add("show","run")}hide(){this._val=!1,this.div.classList.remove("show"),this.div.classList.add("hide"),this.dWrap.onanimationend=t=>{t.animationName=="tna_Tread_hide"&&this.div.classList.remove("run","hide"),this.dWrap.onanimationend=void 0}}toggle(t){this._val=t==null?!this._val:t,this._val?this.show():this.hide()}iterate(t){t.animationName=="tna_Tread_move"&&this._count++}}const Vs=`<div id="region" class="region">
    <div id="bg" class="bg"></div>
    <div id="strip" class="strip"></div>
    <div id="fill" class="fill"></div>
    <div class="flex left">
      <div id="status" class="status"></div>
      <div id="value_wrap" class="value_wrap">
        <div id="value" class="value"></div>
      </div>
    </div>
    <div class="flex right">
      <div style="flex:1"></div>
      <div id="tread" class="tread"></div>
      <div id="prompt" class="prompt"></div>
    </div>
    <div id="thumb" class="thumb">
      <svg id="chevron" class="chevron" viewBox="0 0 100 100">
        <g transform="translate(0 6) scale(.88)">
          <polyline stroke-width="24" points="25 100 75 50 25 0" />
        </g>
      </svg>
    </div>
  </div>`;class js extends gt{constructor(t,i="ux"){super(t);a(this,"_ready",!1);a(this,"sticky",!1);a(this,"autoReset",!0);a(this,"committed",!1);a(this,"expired",!1);a(this,"textStatus","");a(this,"textPrompt");a(this,"x0");a(this,"loc");a(this,"locMax");a(this,"locNorm");a(this,"delta");a(this,"defH");a(this,"thumbW");a(this,"promptW");a(this,"treadPersist",!1);a(this,"treadPrompt",!1);a(this,"cancelDelay",75);a(this,"commitDelay",0);a(this,"timeout");a(this,"tread");a(this,"animThumb");a(this,"onBegin");a(this,"onReady");a(this,"onPrime");a(this,"onCommit");a(this,"onEnd");a(this,"onCancel");a(this,"onExpire");a(this,"onChange");this.link(i),this.div.insertAdjacentHTML("beforeend",Vs),this.div.classList.add("tna_SafeSlide","disable"),this.dRegion=this.getDiv("region"),this.dBg=this.getDiv("bg"),this.dStrip=this.getDiv("strip"),this.dFill=this.getDiv("fill"),this.dPrompt=this.getDiv("prompt"),this.dStatus=this.getDiv("status"),this.dValueW=this.getDiv("value_wrap"),this.dValue=this.getDiv("value"),this.dThumb=this.getDiv("thumb"),this.divChevron=this.getDiv("chevron"),this.divTread=this.getDiv("tread"),this.treadPrompt=this.div.dataset.safeTread!=null,this.treadPersist=this.div.dataset.safeTreadPersist!=null,this.treadIcon=this.treadPrompt||this.treadPersist,this.treadIcon&&(this.tread=new te(this.divTread.id)),this.dPrompt.innerText=this.textPrompt=this.getDataAttr("safePrompt","string",""),this.dStatus.innerText=this.textStatus=this.getDataAttr("safeStatus","string",""),this.defH=this.getPropVal("--safe-h"),this.defP=this.getPropVal("--safe-p"),this.getDataAttr("safeThumbW","percent"),this.bEnableEnd=this.enableEnd.bind(this),this.bStart=this.start.bind(this),this.bTrack=this.track.bind(this),this.bStop=this.stop.bind(this),this.bResetEnd=this.resetEnd.bind(this),this.bCommitEnd=this.commitEnd.bind(this),this.observer=new ResizeObserver(n=>{n[0].contentRect.width,this.resize()}),this.observer.observe(this.div),this.resize(),this.sticky=this.div.dataset.sticky!=null,this._enable=this.div.dataset.enable!=null,this._enable==1&&this.enable()}resize(){const t=this.thumbW;if(this.calcThumb(),this.thumbW==t)return;const i=this.locNorm*this.locMax;this.dThumb.style.left=this.defP+i+"px",this.dFill.style.left=this.defP+i-this.width+"px",this.calcPrompt();let n,o;const h=this.div.dataset.safeGradStart;if(h!=null){const c=parseFloat(h);isNaN(c)?n=50:(o=h.indexOf("px"),n=o>0?(this.thumbW+c)/this.width*100:((this.width-this.thumbW)*c/100+this.thumbW)/this.width*100),this.div.style.setProperty("--safe-grad-start",n+"%")}}enable(t=!0){if(t==this._enable)return;if(this._enable=t,this.loc=this.locNorm=0,this.primed&&!t)return this.committed=!0,this.commitPrime(),this;this.div.classList.toggle("disable",!t),this.divChevron.classList.toggle("show",t);let i=500;return t?this.animThumb=this.dThumb.animate([{opacity:0,width:this.defH+"px"},{opacity:1,width:this.thumbW/3+"px",offset:.33},{opacity:1,width:this.thumbW+"px"}],{duration:i,easing:"ease-out",fill:"backwards"}):(this.dThumb.onmousedown=this.dThumb.ontouchstart=null,this.dPrompt.classList.remove("show"),this.treadPersist&&this.tread.hide(),this.animThumb=this.dThumb.animate([{opacity:1,left:this.defP+"px"},{opacity:0,left:this.width-this.thumbW+"px"}],{duration:i,easing:"ease-in"})),this.animThumb.addEventListener("finish",this.bEnableEnd),this}enableEnd(){this.animThumb.removeEventListener("finish",this.bEnableEnd),this.div.classList.toggle("disable",!this._enable),this.dThumb.onmousedown=this.dThumb.ontouchstart=this._enable?this.bStart:null,this._enable&&(this.dPrompt.classList.add("show"),this.treadPersist&&(this.tread.prime(),this.tread.show()))}parse(t){const i=t.v;if(i<0)return console.warn(`${this.id} safeSlide parse FAIL no stage value`);switch(r.stageID[i]){case"ready":this.ready(t);break;case"run":this.update(t);break;case"commit":this.commit(t);break;case"expire":this.expire(t);break}}start(t){t.preventDefault(),t.stopImmediatePropagation(),this.primed=!0,this._ready=this.expired=this.committed=!1,clearTimeout(this.timeout),this.dThumb.style.cursor="grab",document.addEventListener("mousemove",this.bTrack),document.addEventListener("touchmove",this.bTrack),document.addEventListener("mouseup",this.bStop),document.addEventListener("touchend",this.bStop),this.x0=isNaN(t.pageX)?t.changedTouches[0].pageX:t.pageX,this.delta=0,this.calcThumb(),this.div.classList.add("active"),this.dPrompt.classList.add("active"),this.onTron!=null&&this.onTron(`${this.div.id} > start`),this.onBegin!=null&&this.onBegin(this),this.dPrompt.style.transition="none",this.treadIcon&&(this.tread.prime(!1),this.tread.show(!0),this.tread.div.style.transition="none")}track(t){if(!this.primed)return;const i=isNaN(t.pageX)?t.changedTouches[0].pageX:t.pageX;this.loc=Math.round(i-this.x0),this.loc=this.loc<this.locMax?this.loc:this.locMax,this.delta=this.loc=Math.max(this.loc,0),this.onTron!=null&&this.onTron(`${this.div.id} track ${Math.round(this.delta)}`),this.locNorm=this.loc/this.locMax,this.dThumb.style.left=this.defP+this.loc+"px",this.dFill.style.left=this.defP+this.loc-this.width+"px";const n=(this.loc-(this.locMax-(1-this.promptStart)*this.promptW))/((this.promptEnd-this.promptStart)*this.promptW);this.dPrompt.style.opacity=1-n,this.tread.div.style.opacity=1-n*2,this.loc>=this.locMax?(this.dPrompt.classList.remove("show"),!this.expired&&this._ready&&this.execute()):this.dPrompt.classList.add("show"),t.preventDefault()}execute(){document.removeEventListener("mousemove",this.bTrack),document.removeEventListener("touchmove",this.bTrack),this.treadIcon&&this.tread.hide(),this.div.classList.add("hold"),this.sticky?(this.onTron!=null&&this.onTron(`${this.div.id} > prime sticky`),document.removeEventListener("mouseup",this.bStop),document.removeEventListener("touchend",this.bStop),this.dThumb.style.pointerEvents="none",this.dThumb.onmousedown=this.dThumb.ontouchstart=null):this.onTron!=null&&this.onTron(`${this.div.id} > prime`),this.onPrime!=null?this.onPrime(this):this.dRegion.classList.add("confirm")}ready(){this._ready=!0,this.onReady!=null&&this.onReady()}async commit(t){!this.primed||(this.committed=!0,this.sticky||(document.removeEventListener("mouseup",this.bStop),document.removeEventListener("touchend",this.bStop),this.dThumb.style.pointerEvents="none",this.dValueW.classList.remove("show","blink"),this.dValue.innerText=""),this.onTron!=null&&this.onTron(`${this.div.id} > commit`),this.onCommit!=null&&this.onCommit(this,t),this.autoReset?this.commitDelay>0?this.timeout=setTimeout(this.resetPrime.bind(this),this.commitDelay):this.resetPrime():this.commitDelay>0?this.timeout=setTimeout(this.commitPrime.bind(this),this.commitDelay):this.commitPrime())}async commitPrime(){if(!this.committed)return;this.primed=!1;const t=500;this.dStrip.style.opacity=0,this.dStrip.style.transition=t+"ms",await this.delay(t/2),this.dPrompt.style="",this.dPrompt.classList.remove("show"),this.tread.div.style.opacity="",this.tread.div.style.transition="",this.dFill.style.opacity=0,this.dFill.style.transition=t+"ms",this.dThumb.style.left=this.width-this.defP-this.defH+"px",this.dThumb.style.width=this.defH+"px",this.dThumb.style.opacity=0,this.dThumb.style.transition=`${t}ms ease-in`,this.drawStatus(!1),this.dThumb.addEventListener("transitionend",this.bCommitEnd),this.dBg.classList.add("disable")}commitEnd(){this.dThumb.removeEventListener("transitionend",this.bCommitEnd),this.onEnd!=null&&this.onEnd(this),this.dThumb.style="",this.div.classList.remove("active","hold"),this.dThumb.onmousedown=this.dThumb.ontouchstart=null,this.dStrip.style="",this.dStrip.classList.remove("show"),this.dFill.style="",this.status="",this.value="",this.dRegion.classList.remove("confirm"),this.dBg.classList.remove("disable"),this.div.classList.add("disable"),this._enable=!1,this.loc=this.locNorm=0}expire(t){if(console.warn(`${this.id} safeSlide expire, primed:${this.primed}`),!this.primed)return;this.expired=!0;const i=this.onExpire!=null?this.onExpire(this,t):void 0;this.endMouse(i)}stop(t){this.endMouse(),t.preventDefault(),t.stopImmediatePropagation()}endMouse(t=!0){document.removeEventListener("mousemove",this.bTrack),document.removeEventListener("touchmove",this.bTrack),document.removeEventListener("mouseup",this.bStop),document.removeEventListener("touchend",this.bStop),t&&this.resetPrime()}async resetPrime(){if(!this.primed)return;this.primed=!1,this.onTron!==void 0&&this.onTron(`${this.div.id} > endPrime`),this.drawStatus(!1);let t=this.delta/this.locMax*200;t=t>50?t:50,this.committed&&await this.delay(t),this.delta!=0?(this.dThumb.addEventListener("transitionend",this.bResetEnd),this.loc=this.locNorm=0,this.dThumb.style.left=this.defP+"px",this.dThumb.style.transition=`${t}ms ease-in`,this.dFill.style.left=-this.width+"px",this.dFill.style.transition=`${t}ms ease-in`):this.resetEnd(),this.dStrip.classList.remove("show"),this.dPrompt.classList.remove("active"),this.dPrompt.style.opacity="",this.tread.div.style.opacity="",this.tread.div.style.transition="",this.treadPrompt&&!this.treadPersist&&(this.tread.prime(),this.tread.hide()),this.dRegion.classList.remove("confirm")}resetEnd(){this.dThumb.removeEventListener("transitionend",this.bResetEnd),this.onTron!=null&&this.onTron(`${this.div.id} > end`),!this.committed&&this.onCancel!=null&&(this.cancelDelay>0?this.timeout=setTimeout(this.onCancel,this.cancelDelay,this):this.onCancel(this)),this.committed=!1,this.div.classList.remove("confirm"),this.dThumb.style="",this.div.classList.remove("active","hold"),this.dThumb.onmousedown=this.dThumb.ontouchstart=this.bStart,this.dFill.style="",this.dPrompt.classList.add("show"),this.dPrompt.innerText=this.textPrompt,this.dPrompt.style="",this.dValue.innerText="",this.treadPersist&&this.tread.show()}reset(t=0){this.committed&&(t>0?this.timeout=setTimeout(this.expire.bind(this),t):this.expire())}update(t){!this.primed||(this.onChange!=null&&this.onChange(this,t),this.drawStrip())}drawStrip(t=!0){this.dStrip.classList.toggle("show",t)}drawStatus(t=!0){this.dStatus.classList.toggle("show",t),this.dValueW.classList.toggle("show",t),t||this.dValueW.classList.remove("blink")}drawValue(t=!0){this.dValueW.classList.toggle("show",t)}blink(t=.14){this.div.style.setProperty("--blink-rate",t+"s"),this.dValueW.classList.add("blink"),this.dValueW.onanimationend=this.blinkEnd.bind(this)}blinkEnd(t){this.dValueW.classList.remove("blink"),this.dValueW.onanimationend=void 0}calcThumb(){const t=this.div.offsetWidth;t!=this.width&&(this.width=t,this.thumbW=this.dThumb.offsetWidth,this.locMax=this.width-this.thumbW-this.defP*2)}calcPrompt(){let t,i;this.promptW=this.dPrompt.offsetWidth;let n=this.div.dataset.safePromptStart,o=this.div.dataset.safePromptEnd;n=n!=null?n:"0",o=o!=null?o:"50%";const h=parseFloat(n),c=parseFloat(o);isNaN(h)?t=0:(i=n.indexOf("px"),t=i>0?h/this.promptW:h/100),this.promptStart=t,isNaN(c)||(i=o.indexOf("px"),t=i>0?c/this.promptW:c/100),this.promptEnd=t}set value(t){this.dValue.innerText=this._val=t}get value(){return this._val}set prompt(t){this.textPrompt=this.dPrompt.innerText=t,this.calcPrompt()}set status(t){this.textStatus=this.dStatus.innerText=t,this.dStatus.classList.toggle("nil",t=="")}}class Us extends q{constructor(t,i,n=4){super(t);a(this,"_count");a(this,"_inMin",-83);a(this,"_inMax",-45);a(this,"_out");this.link(i),this._count=n,this.div.classList.add("tna_RSSI"),this.setProp("--rssi-n",n)}init(){this.bars=this.div;for(let t=1;t<=5;t++)this.bars=this.bars.firstElementChild;this.bars=this.bars.children,this.index=0}draw(){const t=this._out;for(let i=0;i<this._count;i++)this.bars[i].classList.toggle("lit",i<t&&t!=0)}set value(t){this._out=t!=0?Math.round(this.range(t,this._inMin,this._inMax,0,this._count)):0,super.value=t,this.draw()}get value(){return super.value}warn(t=!0){return this.div.classList.toggle("warn",t),this}map(t,i){return this._inMin=t,this._inMax=i,this}range(t,i,n,o,h){const c=o+(h-o)*(t-i)/(n-i),p=Math.min(c,h);return Math.max(1,p)}}class Ne extends Y{constructor(e,t){super(e),this.link(t),this.div.classList.add("tna_Twirl"),this.add='<polygon points="0,88 100,88 50,0"/>',this.def()}draw(){this.div.classList.toggle("open",this.value)}}class Xs extends Q{constructor(t){super(t,"object");a(this,"id");a(this,"linked");a(this,"onEnter");a(this,"onExit");this.id=t,this.linked=r.linkDialog(this)}begin(){this.onEnter!=null&&this.onEnter(this)}exit(){this.onExit!=null&&this.onExit(this)}}const Gs=`
  <g fill="none">
    <circle stroke-width="18" r="8"></circle>
    <circle stroke-width="10" r="32"></circle>
    <circle stroke-width="10" r="52"></circle>
  </g>
  <g id="caution" class="caution">
    <polyline stroke-width="15" points="20 20 46 46"></circle>
  </g>`;class Be extends Us{constructor(e,t){super(e,t,3),this.div.classList.add("tna_RSSI_Wave"),this.add=Gs,super.init(),this.dCaution=this.getDiv("caution")}draw(){super.draw()}}const xt={};let le,wt,B,st,Ut;function qs(){xt.insert=le=new bt("scan_insert"),xt.twirl=wt=new Ne("scan_twirl").show(),wt.onExecute=s=>{s.toggle(),le.toggle(s.value),B.view(s.value),s.value||(f.tna.insert.open(),f.tna.top.toggle(K.tna.button.value)),window.scan_item.classList.toggle("active",s.value),window.rssi_bg.classList.toggle("fall",s.value)},xt.button=B=new q("scan_button"),B.symbol("refresh").symbol("refresh_run"),B.value=!1,B.index=0,B.onExecute=s=>{s.cycle().choreo("spin").timing(5,1e3).act(),He()},B.onAnimEnd=s=>s.def(),st=new ke.control("scan_list").staticHigh(!1).hover(!1),st.onPrime=s=>{s.next!=null&&s.next.classList.add("alt")},st.onExecute=s=>{wt.onExecute(wt),s.next!=null&&s.next.classList.remove("alt");const e=s.last.div.querySelector(".label").innerText;e!=ssid.value&&(f.prop.ssid=e,f.prop.rssi=s.last.div._tna_rssi,f.tna.ssid.set(e),f.tna.ssid.edit=!0,f.tna.pass.preset("",0),window.rssi_value.innerText=-f.prop.rssi,window.rssi_bg.classList.add("show"),f.tna.insert.open())}}function Zs(){for(const[s,e]of Object.entries(xt))e.prime()}function Js(){const s=window.scan_list_head.offsetHeight,e=st.update(),t=s*2+e+"px";net_insert.style.setProperty("--scan_insert-h",t)}async function He(){if(Ut!=null)return console.warn("scan.update lockout");Ut=setTimeout(()=>Ut=void 0,5e3);const s={};await w.fill(s,"/net-scan",Ks);const e=Object.values(s);e.sort((c,p)=>c.r<p.r?1:-1),st.clear(),st.template=`
    <div class="item">
      <div class="hr_con"> 
        <div class="hr"></div>
      </div>
      <div class="label_flex _click">
        <div class="icon_flex">
          <div id="mark" class="mark"></div>
        </div>
        <div id="label" class="label"></div>
      </div>
      <div class="flex">
        <div id="lock" class="lock"></div>
        <div id="rssi" class="rssi _dmm"></div>
      </div>
    </div>`;let t,i,n=-1;const o=[];for(let c in e){const p=e[c].i,l=parseInt(e[c].r);if(o.filter(_=>p===_.i).length>0||parseInt(e[c].e)==7||l<-80&&p!=x.prop.ssid&&!x.prop.fresh)continue;o.push(e[c]);const d=st.add();d.view(!0);let m;if(d.label=p,p==x.prop.ssid){n=c,d.div.classList.add("highlight"),m=d.div.querySelector("#mark"),m.id="mark_"+d.index;const _=new Y(m.id).static().show();_.add=`<polyline stroke-linecap="round" stroke-linejoin="round" fill="none"
        points="10 53.85 37 90 90 10"/>`,_.translate(0,0),_.index=0,i=d,x.prop.rssi=l}if(p==f.prop.ssid&&(f.prop.rssi=l,window.rssi_value.innerText=-l,f.tna.rssi.value=l,wt.value||window.rssi_bg.classList.add("show")),m=d.div.querySelector("#lock"),m.id="lock_"+d.id,parseInt(e[c].e)==7){m.style.display="block",m.id="lock_"+d.index;const _=new Y(m.id).static().show();_.add=`
        <g transform=" translate(-35 -50)">
          <rect stroke="none" x="15" y="50" width="70" height="50" />
          <path transform="translate(10 50)" fill="none" d="M-20,0V-22c0-12.15,8.954-22,20-22H0c11.046,0,20,9.85,20,22V0"/>
        </g>`,_.add='<g transform=" translate(-65 -50)"><rect stroke="none" x="15" y="50" width="70" height="50"/><path fill="none" d="M-20,0V-22c0-12.15,8.954-22,20-22H0c11.046,0,20,9.85,20,22V0" transform="translate(90 50)"/></g>',_.translate(50,50),_.index=0}d.div._tna_rssi=l,m=d.div.querySelector("#rssi"),m.id="rssi_"+d.id;const k=new Be(m.id).static().show();k.value=l,(t==i&&t!=null||c==0)&&d.div.classList.add("alt"),t=d}window.scan_list_head.classList.toggle("highlight",n==0);const h=t==i&&t!=null;window.scan_list_foot.classList.toggle("highlight",h),Js()}function Ys(){B.onExecute(B)}var Et={tna:xt,init:qs,prime:Zs,execute:Ys,update:He};const Ks=[{r:-45,i:"test 1",c:1,e:4},{r:-49,i:"test 2",c:2,e:4},{r:-51,i:"test 3",c:2,e:2},{r:-55,i:"test 4",c:2,e:2},{r:-59,i:"test 5",c:2,e:2},{r:-64,i:"test 6",c:2,e:7},{r:-67,i:"test 7",c:2,e:4},{r:-71,i:"test 8",c:2,e:4},{r:-79,i:"test 9",c:2,e:4},{r:-84,i:"test 10",c:2,e:4},{r:-89,i:"test 11",c:2,e:4},{r:-94,i:"test 12",c:2,e:4},{r:-95,i:"test 13",c:2,e:4},{r:-96,i:"test 14",c:2,e:4},{r:-99,i:"test 15",c:2,e:4}],y={},It={};let ee,ze,We,G,rt,ht,dt;function Qs(){It.ssid=x.prop.ssid,It.rssi=x.prop.rssi,G.preset(x.prop.ssid),rt.preset("",x.prop.pass).censor(x.prop.pass>0),dt.preset(x.prop.device),y.deviceTwirl.show()}function tn(){y.overlay=ee=new Q("overlay").fuse(),y.overlay_tread_L=ze=new te("overlay_tread_L"),y.overlay_tread_R=We=new te("overlay_tread_R"),y.top=window.readme_top.tna,y.bottom=window.readme_bottom.tna,new Xs("net_setup"),y.rssi=ht=new Be("rssi_ind").tag("no_prime"),y.insert=new bt("input_insert").tag("no_prime"),y.ssid=G=new jt("ssid"),G.labelAbbr="Wifi Name",G.validSize(2,32).regexChar(/[\?"\$\[\]\/+]/),G.onFocus=()=>ht.view(0),G.onBlur=Ve,G.onReset=async s=>{It.ssid=It.rssi=void 0,x.prop.ssid.length==0&&await s.delay(500),rt.censor(),rt.preset("",x.prop.pass,"hold").reset(),window.rssi_bg.classList.remove("show"),await s.delay(500),x.prop.rssi<0&&(window.rssi_value.innerText=-x.prop.rssi,window.rssi_bg.classList.add("show")),await s.delay(250),rt.edit=!1,s.onValidate(s)},y.pass=rt=new jt("pass").validSize(8,32),rt.labelAbbr="Password",y.device=dt=new jt("device").validSize(2,32),dt.labelAbbr="Device",dt.regexFormat(/^[a-zA-Z ]+/).regexChar(/[^\w- ]/),y.deviceInsert=new bt("device_insert"),y.deviceTwirl=new Ne("device_twirl"),y.deviceTwirl.onExecute=async s=>{s.toggle(),y.deviceInsert.toggle(),K.update(),window.submit_wrap.classList.toggle("push",s.value),s.value?(await s.delay(500),dt.prime()):(dt.prime(!1),y.device.dEntry.blur())},window.rssi_bg.classList.add("prime")}async function Ve(){const s=!G.edit&&ht.value<0;ht.prime(!s),await ht.delay(100),ht.view(s)}async function en(){document.body.classList.add("freeze"),await ee.delay(1e3),ee.view(),ze.show(),We.show()}function sn(){x.prop.modeAP?(w.monitor(!1),y.deviceTwirl.onExecute(y.deviceTwirl),j.enable(!1),window.head_title.innerText="CubeCore Setup"):window.head_title.innerText="Network",x.prop.fresh?(console.log("net fresh!"),localStorage.setItem("help",1),K.tna.button.index=K.tna.button.value=!0,Et.tna.twirl.onExecute(Et.tna.twirl)):y.insert.open()}function nn(){for(const[s,e]of Object.entries(y))e.hasTag("no_prime")||e.prime()}var f={tna:y,prop:It,fill:Qs,init:tn,stage:sn,prime:nn,freeze:en,updateRSSI:Ve};const an={version:D.version,modeAP:"0",ssid:"test 13",pass:8,device:window.location.hostname.split(".")[0],rssi:"-74"};let E={};async function on(){return await w.fill(E,"/net-fill",an),window.diag_firmware.innerText=$.versionString(E.version),E.rssi<0&&(window.rssi_value.innerText=-E.rssi,f.tna.rssi.value=E.rssi,f.tna.rssi.div.classList.toggle("warn",E.rssi<-79),window.rssi_bg.classList.add("show"),f.tna.rssi.show()),E.modeAP=E.modeAP==1,E.fresh=E.ssid=="",E.fresh&&window.pass.classList.add("warn"),window.diag_firmware.innerHTML!=window.diag_client.innerHTML?window.diag_client.classList.add("show"):window.diag_firmware.dataset.prefix="",window.diag_firmware.classList.add("show"),window.device.setAttribute("data-value",E.device),E.modeAP}async function rn(){let s;const e=f.tna;e.submit;const t=new FormData;e.ssid.edit&&t.append("ssid",e.ssid.value),e.pass.edit&&t.append("pass",e.pass.value),e.device.edit&&t.append("device",e.device.value);try{const i=await fetch("/net",{method:"POST",body:t});if(i.status===200&&(s=await i.text()),s!=="OK")throw new Error("submit fetch FAIL no text");return!0}catch(i){return console.warn("net submit FAIL",i,s),!1}}var x={prop:E,fill:on,send:rn};const je={};let F;function dn(){const s=f.tna.ssid,e=f.tna.pass,t=f.tna.device,i="\xA0\xA0\xA0\xA0",n=`\u2022\xA0\u2022\xA0\u2022${i}Caution static discharge${i}\u2022\xA0\u2022\xA0\u2022`;lt.setHold(5).setDelay(2).writeDelay(n,2,2),je.submit=F=new js("net_setup"),F.autoReset=!1,F.commitDelay=500+7e3+4400,F.onBegin=l=>{x.prop.modeAP&&(l._ready=!0),w.sendUX("net_setup","begin")},F.onCancel=()=>w.sendUX("net_setup","cancel"),F.onPrime=async l=>{s.commit(),e.commit(),t.commit();let v=!1;try{v=await x.send()}catch{}v?(l.status="ok to go",l.drawStatus(),l.blink(),l.update()):(l.status="SEND",l.value="FAIL",l.drawStatus(),l.blink(.28),await l.delay(2500),l.committed=!0,l.reset())},F.onChange=(l,v)=>{if(v==null)return;const d=v.x;l.status="RESTART",l.value=`0:0${d}`,d==0&&l.blink()},F.onCommit=async(l,v)=>{switch(console.log("submit onCommit obj:",v),v.x){case 0:break;case 1:l.value="",await l.delay(250),l.status="restarting",D.close(),await $.delay(5e3),await f.freeze(),await $.delay(1e4),h();break}};function o(){const v=`http://<b>${f.tna.device.value.replace(/ /g,"-").toLowerCase()}</b>.local`;window.device_url.innerHTML=f.tna.device.valid?v:""}function h(){const v=`http://${f.tna.device.value.replace(/ /g,"-").toLowerCase()}.local/net`;console.warn("reload",v),window.location=v}let c;const p=l=>{l.valid&&lt.cancel();const v=l.valid&&l.edit?1e3:100;clearTimeout(c);const d=(s.value==x.prop.ssid||s.value==f.prop.ssid)&&(x.prop.rssi<0||f.prop.rssi<0);window.rssi_bg.classList.toggle("show",d),f.updateRSSI(),o(),c=setTimeout(()=>{let m=s.valid&&e.valid&&t.valid;m&&(m=s.edit||e.edit||t.edit),F.enable(m),m?lt.enable(!1):lt.enable()},v),fe(l)};f.tna.device.onValidate=f.tna.ssid.onValidate=f.tna.pass.onValidate=p,f.tna.device.onError=f.tna.ssid.onError=f.tna.pass.onError=fe}function ln(){}let he,ce;function fe(s){if(he==s&&ce==s.error)return;let e;switch(s.error){case"length":e=`requires ${s._min} to ${s._max} chars`;break;case"char":e="contains invalid chars";break;case"format":e="invalid format";break;case"reset":e="reset to original";break}e!=null&&lt.writeDelay(`${s.labelAbbr} `+e),he=s,ce=s.error}var hn={tna:je,init:dn,prime:ln};async function cn(){document.title=window.location.hostname.split(".")[0]+" \u2022 Network",K.init(),D.init(),J.init(),f.init(),hn.init(),Et.init(),D.tna.title.shy(!1);const s=await x.fill();f.fill(),f.stage(),K.stage(),Et.execute(),await $.delay(200),fn(),D.patch(),s||w.monitor(D.prop.preflight),window.badge.classList.add("connect"),window.diag_client.onclick=window.diag_firmware.onclick=()=>window.location="/update/",!D.prop.preflight&&Cs.init()}function fn(){f.prime(),Et.prime(),K.prime(),window.page.classList.add("show")}K.prop.onUpdate=s=>{f.tna.top.toggle(s),f.tna.bottom.toggle(s&&f.tna.deviceTwirl.value)};window.addEventListener("load",cn);
